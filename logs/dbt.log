[0m17:31:00.266643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B4E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B76A21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B76A1F30>]}


============================== 17:31:00.273879 | f5fc16fd-027b-4268-8b40-000850bbf8d2 ==============================
[0m17:31:00.273879 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:31:00.274874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:31:00.781216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B76A2170>]}
[0m17:31:00.822419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46D74F0>]}
[0m17:31:00.877512 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:31:00.898678 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:31:00.901219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46C9180>]}
[0m17:31:03.593215 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:31:03.699660 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'weather' in the 'models' section of file 'models\bronze\schema.yml'
[0m17:31:03.783173 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_coord_lon.111d5fc247' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.784683 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_coord_lat.73580ceedf' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.786698 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_weather_main.e550921c88' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.788697 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_weather_description.4881254a38' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.790206 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_main_temp.46cf30c876' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.792220 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_main_humidity.4df0aafc92' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.795746 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_wind_speed.9983f1ae3d' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.797744 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_wind_deg.d7b4c06687' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.905050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7AE9150>]}
[0m17:31:03.923680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46CA590>]}
[0m17:31:03.926681 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:31:03.929679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B469EE00>]}
[0m17:31:03.933206 [info ] [MainThread]: 
[0m17:31:03.936733 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:31:03.942262 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:31:03.998768 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:31:04.001128 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:31:04.003125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:04.186266 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:04.191800 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:31:04.203058 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:31:04.237794 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:31:04.239923 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:31:04.242843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:04.635780 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:04.640824 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:31:04.642824 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:31:04.651100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7BA4160>]}
[0m17:31:04.652633 [debug] [MainThread]: On master: COMMIT
[0m17:31:04.655163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:04.657702 [info ] [MainThread]: 
[0m17:31:04.679581 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:31:04.682544 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:31:04.687086 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:31:04.689606 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:31:04.703317 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:31:04.714564 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:31:04.691627 => 17:31:04.712497
[0m17:31:04.717492 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:31:04.870686 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:31:04.883220 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:04.886774 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:31:04.888768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:06.797466 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m17:31:06.830196 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:06.833210 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:31:07.076760 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:07.087867 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:07.090373 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:31:07.374921 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:07.401661 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:07.405033 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:31:07.755933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:07.810481 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:31:04.719494 => 17:31:07.809919
[0m17:31:07.812496 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:31:07.815547 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:31:07.819494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7C60100>]}
[0m17:31:07.824597 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 3.13s]
[0m17:31:07.830384 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:31:07.835438 [debug] [MainThread]: On master: COMMIT
[0m17:31:07.837405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:07.838466 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:31:07.842209 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:31:07.845778 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m17:31:07.847780 [info ] [MainThread]: 
[0m17:31:07.850298 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m17:31:07.859875 [debug] [MainThread]: Command end result
[0m17:31:07.882917 [info ] [MainThread]: 
[0m17:31:07.887007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:07.891563 [info ] [MainThread]: 
[0m17:31:07.895794 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:31:07.900311 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:07.899795 after 7.67 seconds
[0m17:31:07.902332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B4E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46D74F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7AE9FC0>]}
[0m17:31:07.906020 [debug] [MainThread]: Flushing usage events
[0m17:32:03.553655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D38C75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D6182170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D6181F60>]}


============================== 17:32:03.561417 | 74d28918-0352-4436-a90b-3d8c97b1ab5e ==============================
[0m17:32:03.561417 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:32:03.563431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:32:03.884090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D6182200>]}
[0m17:32:03.914054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D3166BC0>]}
[0m17:32:03.938091 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:32:04.073548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:04.075495 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\bronze\schema.yml
[0m17:32:04.204660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D66F54B0>]}
[0m17:32:04.219294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D66BB6A0>]}
[0m17:32:04.220845 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:32:04.222859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D669B820>]}
[0m17:32:04.226856 [info ] [MainThread]: 
[0m17:32:04.230401 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:32:04.233299 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:32:04.260469 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:32:04.261484 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:32:04.262682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:04.366604 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:04.369174 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:32:04.372904 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:32:04.389555 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:32:04.390564 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:32:04.392568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:04.627844 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:04.632386 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:32:04.634416 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:32:04.638957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D66B86D0>]}
[0m17:32:04.640518 [debug] [MainThread]: On master: COMMIT
[0m17:32:04.643513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:04.645519 [info ] [MainThread]: 
[0m17:32:04.659225 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:32:04.662363 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:32:04.666931 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:32:04.667925 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:32:04.680084 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:32:04.687800 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:32:04.670455 => 17:32:04.685762
[0m17:32:04.690351 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:32:04.837064 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:32:04.846592 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:04.848588 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:32:04.850723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:06.025640 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:32:06.047544 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:06.050059 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:32:06.231037 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.240090 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:06.241099 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:32:06.421004 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.440896 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:06.442847 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:32:06.694538 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.755325 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:32:04.691340 => 17:32:06.754328
[0m17:32:06.757326 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:32:06.759325 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:32:06.763851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D67C3E20>]}
[0m17:32:06.765854 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.10s]
[0m17:32:06.769450 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:32:06.774399 [debug] [MainThread]: On master: COMMIT
[0m17:32:06.776867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:06.777891 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:32:06.780430 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:32:06.781424 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m17:32:06.783427 [info ] [MainThread]: 
[0m17:32:06.785433 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m17:32:06.789428 [debug] [MainThread]: Command end result
[0m17:32:06.810900 [info ] [MainThread]: 
[0m17:32:06.812902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:06.817438 [info ] [MainThread]: 
[0m17:32:06.819441 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:32:06.822047 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:06.821529 after 3.48 seconds
[0m17:32:06.824179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D38C75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D3166BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D67C3E20>]}
[0m17:32:06.826175 [debug] [MainThread]: Flushing usage events
[0m17:53:22.129749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9762775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978B4E170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978B4DF60>]}


============================== 17:53:22.143647 | 953a0ad7-299f-4021-86f2-f41136ac4645 ==============================
[0m17:53:22.143647 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:53:22.147609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:53:22.535119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978B4E200>]}
[0m17:53:22.551520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D975B25870>]}
[0m17:53:22.579532 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:53:23.748324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:23.750845 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\bronze\schema.yml
[0m17:53:23.782204 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:53:23.853743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9790CBEB0>]}
[0m17:53:23.865743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978F85F30>]}
[0m17:53:23.866743 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:53:23.868741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978F85F90>]}
[0m17:53:23.870739 [info ] [MainThread]: 
[0m17:53:23.872740 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:53:23.874907 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:53:23.896995 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:53:23.899039 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:53:23.900088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:24.497989 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:53:24.504036 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:53:24.507061 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:53:24.515765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978F85F00>]}
[0m17:53:24.518759 [debug] [MainThread]: On master: COMMIT
[0m17:53:24.522308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:24.525852 [info ] [MainThread]: 
[0m17:53:24.557043 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m17:53:24.560586 [info ] [Thread-1 (]: 1 of 3 START test not_null_weatheronepoint__airbyte_ab_id ...................... [RUN]
[0m17:53:24.566132 [debug] [Thread-1 (]: Acquiring new trino connection 'test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492'
[0m17:53:24.569691 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m17:53:24.639233 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m17:53:24.646333 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492 (compile): 17:53:24.571690 => 17:53:24.645319
[0m17:53:24.648934 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m17:53:24.702558 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m17:53:24.717235 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m17:53:24.720314 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_ab_id
from lakehouse.bronze.weatheronepoint
where _airbyte_ab_id is null



      
    ) dbt_internal_test
[0m17:53:24.722310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:53:25.243741 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:53:25.258641 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492 (execute): 17:53:24.650973 => 17:53:25.256549
[0m17:53:25.262988 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: ROLLBACK
[0m17:53:25.269131 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: Close
[0m17:53:25.276234 [info ] [Thread-1 (]: 1 of 3 PASS not_null_weatheronepoint__airbyte_ab_id ............................ [[32mPASS[0m in 0.71s]
[0m17:53:25.284611 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m17:53:25.289129 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m17:53:25.294460 [info ] [Thread-1 (]: 2 of 3 START test not_null_weatheronepoint__airbyte_data ....................... [RUN]
[0m17:53:25.306959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492, now test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01)
[0m17:53:25.313676 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m17:53:25.340731 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m17:53:25.349767 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01 (compile): 17:53:25.319009 => 17:53:25.345805
[0m17:53:25.353809 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m17:53:25.367983 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m17:53:25.377468 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m17:53:25.383697 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_data
from lakehouse.bronze.weatheronepoint
where _airbyte_data is null



      
    ) dbt_internal_test
[0m17:53:25.386655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:25.752360 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:53:25.760446 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01 (execute): 17:53:25.356836 => 17:53:25.759425
[0m17:53:25.762467 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: ROLLBACK
[0m17:53:25.765543 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: Close
[0m17:53:25.770459 [info ] [Thread-1 (]: 2 of 3 PASS not_null_weatheronepoint__airbyte_data ............................. [[32mPASS[0m in 0.47s]
[0m17:53:25.775042 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m17:53:25.779031 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m17:53:25.781035 [info ] [Thread-1 (]: 3 of 3 START test not_null_weatheronepoint__airbyte_emitted_at ................. [RUN]
[0m17:53:25.787140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01, now test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31)
[0m17:53:25.789776 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m17:53:25.807978 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m17:53:25.816006 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31 (compile): 17:53:25.790807 => 17:53:25.815006
[0m17:53:25.818005 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m17:53:25.829674 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m17:53:25.841048 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m17:53:25.844594 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_emitted_at
from lakehouse.bronze.weatheronepoint
where _airbyte_emitted_at is null



      
    ) dbt_internal_test
[0m17:53:25.846790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:26.115038 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:53:26.121559 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31 (execute): 17:53:25.820395 => 17:53:26.120555
[0m17:53:26.124689 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: ROLLBACK
[0m17:53:26.127859 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: Close
[0m17:53:26.132905 [info ] [Thread-1 (]: 3 of 3 PASS not_null_weatheronepoint__airbyte_emitted_at ....................... [[32mPASS[0m in 0.35s]
[0m17:53:26.138654 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m17:53:26.145862 [debug] [MainThread]: On master: COMMIT
[0m17:53:26.148926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:26.151928 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:53:26.154666 [debug] [MainThread]: Connection 'test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31' was properly closed.
[0m17:53:26.159699 [info ] [MainThread]: 
[0m17:53:26.163545 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m17:53:26.173912 [debug] [MainThread]: Command end result
[0m17:53:26.211656 [info ] [MainThread]: 
[0m17:53:26.215690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:26.220030 [info ] [MainThread]: 
[0m17:53:26.223883 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:53:26.230906 [debug] [MainThread]: Command `dbt test` succeeded at 17:53:26.230906 after 4.39 seconds
[0m17:53:26.241357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9762775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9790C9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9764DECB0>]}
[0m17:53:26.252243 [debug] [MainThread]: Flushing usage events
[0m17:57:08.471596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1AE75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB433E1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB433DF00>]}


============================== 17:57:08.481663 | 21987e86-7eca-42a0-a13b-26a7c567ac56 ==============================
[0m17:57:08.481663 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:57:08.484744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:57:08.987111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21987e86-7eca-42a0-a13b-26a7c567ac56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB433E140>]}
[0m17:57:09.018034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21987e86-7eca-42a0-a13b-26a7c567ac56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB13968F0>]}
[0m17:57:09.056165 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:57:09.084870 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:57:09.090419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21987e86-7eca-42a0-a13b-26a7c567ac56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB135D270>]}
[0m17:57:13.616885 [error] [MainThread]: Encountered an error:

[0m17:57:13.975700 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 242, in wrapper
    manifest = ManifestLoader.get_full_manifest(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 227, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 386, in load
    self.parse_project(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 501, in parse_project
    parser: Parser = parser_cls(project, self.manifest, self.root_project)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\base.py", line 111, in __init__
    self._update_node_alias = RelationUpdate(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\base.py", line 81, in __init__
    root_context = generate_generate_name_macro_context(macro, config, manifest)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\context\providers.py", line 1426, in generate_generate_name_macro_context
    return ctx.to_dict()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\context\manifest.py", line 67, in to_dict
    dct.update(self.namespace)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\_collections_abc.py", line 886, in __iter__
    yield from self._mapping
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\context\macros.py", line 58, in __iter__
    yield key
KeyboardInterrupt

[0m17:57:13.985560 [debug] [MainThread]: Command `dbt test` failed at 17:57:13.983999 after 5.58 seconds
[0m17:57:13.989118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1AE75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB4725A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB4725C00>]}
[0m17:57:13.991104 [debug] [MainThread]: Flushing usage events
[0m17:57:25.652747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153316875E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015333F5E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015333F5DF30>]}


============================== 17:57:25.670823 | 7a0d6638-32e4-4160-b78c-b8b2c1ecedbc ==============================
[0m17:57:25.670823 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:57:25.674098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:57:26.048813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015333F5E170>]}
[0m17:57:26.082745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015330F35870>]}
[0m17:57:26.101124 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:57:26.118754 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:57:26.121252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015330F293C0>]}
[0m17:57:27.968933 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m17:57:28.218845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533438F700>]}
[0m17:57:28.229899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533438E320>]}
[0m17:57:28.231898 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:57:28.232897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533446BEB0>]}
[0m17:57:28.235939 [info ] [MainThread]: 
[0m17:57:28.237940 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:57:28.240940 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:57:28.266620 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:57:28.268623 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:57:28.269622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:28.392620 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:28.395144 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:57:28.400675 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:57:28.418263 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:57:28.420264 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:57:28.421266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:28.597520 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:28.602050 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:57:28.603601 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:57:28.609987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153343F0040>]}
[0m17:57:28.610990 [debug] [MainThread]: On master: COMMIT
[0m17:57:28.613524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:28.615514 [info ] [MainThread]: 
[0m17:57:28.632646 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m17:57:28.634186 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.toto ....................................... [RUN]
[0m17:57:28.638752 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m17:57:28.640749 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m17:57:28.648820 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m17:57:28.654033 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 17:57:28.641749 => 17:57:28.652821
[0m17:57:28.655033 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m17:57:28.767862 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m17:57:28.775445 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:57:28.777517 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:57:28.779558 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:31.295879 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m17:57:31.325848 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:57:31.328366 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m17:57:31.700774 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:31.735735 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:57:31.737738 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m17:57:31.818343 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:31.891642 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 17:57:28.657279 => 17:57:31.890636
[0m17:57:31.894192 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m17:57:31.896185 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m17:57:31.900733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015334452A70>]}
[0m17:57:31.903905 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 3.26s]
[0m17:57:31.908411 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m17:57:31.914970 [debug] [MainThread]: On master: COMMIT
[0m17:57:31.918311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:31.921092 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:57:31.922614 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:57:31.924682 [debug] [MainThread]: Connection 'model.projet_dbt.toto' was properly closed.
[0m17:57:31.928706 [info ] [MainThread]: 
[0m17:57:31.930704 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m17:57:31.935113 [debug] [MainThread]: Command end result
[0m17:57:31.967979 [info ] [MainThread]: 
[0m17:57:31.971008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:31.973545 [info ] [MainThread]: 
[0m17:57:31.977548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:57:31.981550 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:31.981550 after 6.38 seconds
[0m17:57:31.983653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153316875E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015330F35870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533438CA60>]}
[0m17:57:31.986915 [debug] [MainThread]: Flushing usage events
[0m17:57:40.728580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419A5275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419CE0E200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419CE0DF60>]}


============================== 17:57:40.734121 | 75e08a37-6638-47b8-a2f3-20d5c1d8b23d ==============================
[0m17:57:40.734121 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:57:40.737126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:57:40.951143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419CE0E1A0>]}
[0m17:57:40.969757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014199DD58D0>]}
[0m17:57:40.985821 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:57:41.064897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:41.065900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:41.074933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D31BF40>]}
[0m17:57:41.087577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D2DCF70>]}
[0m17:57:41.088480 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:57:41.089481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D2DD1B0>]}
[0m17:57:41.091507 [info ] [MainThread]: 
[0m17:57:41.093722 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:57:41.095720 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:57:41.114767 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:57:41.115766 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:57:41.116764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:41.325441 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:41.329068 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:57:41.330066 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:57:41.337602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D2C38B0>]}
[0m17:57:41.338617 [debug] [MainThread]: On master: COMMIT
[0m17:57:41.340617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:41.343128 [info ] [MainThread]: 
[0m17:57:41.355789 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3
[0m17:57:41.356795 [info ] [Thread-1 (]: 1 of 3 START test not_null_toto__airbyte_ab_id ................................. [RUN]
[0m17:57:41.361794 [debug] [Thread-1 (]: Acquiring new trino connection 'test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3'
[0m17:57:41.363915 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3
[0m17:57:41.396057 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3"
[0m17:57:41.398586 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3 (compile): 17:57:41.364914 => 17:57:41.398586
[0m17:57:41.399588 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3
[0m17:57:41.447977 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3"
[0m17:57:41.454021 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3"
[0m17:57:41.460541 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_ab_id
from lakehouse.bronze.toto
where _airbyte_ab_id is null



      
    ) dbt_internal_test
[0m17:57:41.465617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:41.728585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:41.733637 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3 (execute): 17:57:41.401590 => 17:57:41.732623
[0m17:57:41.734639 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3: ROLLBACK
[0m17:57:41.735639 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3: Close
[0m17:57:41.739638 [info ] [Thread-1 (]: 1 of 3 PASS not_null_toto__airbyte_ab_id ....................................... [[32mPASS[0m in 0.38s]
[0m17:57:41.741638 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3
[0m17:57:41.744751 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_toto__airbyte_data.37b110b011
[0m17:57:41.746755 [info ] [Thread-1 (]: 2 of 3 START test not_null_toto__airbyte_data .................................. [RUN]
[0m17:57:41.749773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3, now test.projet_dbt.not_null_toto__airbyte_data.37b110b011)
[0m17:57:41.750772 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_toto__airbyte_data.37b110b011
[0m17:57:41.760295 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_toto__airbyte_data.37b110b011"
[0m17:57:41.764821 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_data.37b110b011 (compile): 17:57:41.751770 => 17:57:41.763821
[0m17:57:41.765820 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_toto__airbyte_data.37b110b011
[0m17:57:41.773771 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_toto__airbyte_data.37b110b011"
[0m17:57:41.788041 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_toto__airbyte_data.37b110b011"
[0m17:57:41.790894 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_data.37b110b011: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_data
from lakehouse.bronze.toto
where _airbyte_data is null



      
    ) dbt_internal_test
[0m17:57:41.795415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:42.015026 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:42.018570 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_data.37b110b011 (execute): 17:57:41.767821 => 17:57:42.018570
[0m17:57:42.020568 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_data.37b110b011: ROLLBACK
[0m17:57:42.021571 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_data.37b110b011: Close
[0m17:57:42.025805 [info ] [Thread-1 (]: 2 of 3 PASS not_null_toto__airbyte_data ........................................ [[32mPASS[0m in 0.28s]
[0m17:57:42.028979 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_toto__airbyte_data.37b110b011
[0m17:57:42.030976 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e
[0m17:57:42.032490 [info ] [Thread-1 (]: 3 of 3 START test not_null_toto__airbyte_emitted_at ............................ [RUN]
[0m17:57:42.035513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_toto__airbyte_data.37b110b011, now test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e)
[0m17:57:42.039034 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e
[0m17:57:42.056195 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e"
[0m17:57:42.061724 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e (compile): 17:57:42.041041 => 17:57:42.060726
[0m17:57:42.066090 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e
[0m17:57:42.075223 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e"
[0m17:57:42.085334 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e"
[0m17:57:42.088863 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_emitted_at
from lakehouse.bronze.toto
where _airbyte_emitted_at is null



      
    ) dbt_internal_test
[0m17:57:42.091868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:42.403711 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:42.407713 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e (execute): 17:57:42.067604 => 17:57:42.406710
[0m17:57:42.409238 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e: ROLLBACK
[0m17:57:42.411241 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e: Close
[0m17:57:42.416795 [info ] [Thread-1 (]: 3 of 3 PASS not_null_toto__airbyte_emitted_at .................................. [[32mPASS[0m in 0.38s]
[0m17:57:42.421548 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e
[0m17:57:42.429267 [debug] [MainThread]: On master: COMMIT
[0m17:57:42.431258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:42.433796 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:57:42.438310 [debug] [MainThread]: Connection 'test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e' was properly closed.
[0m17:57:42.440842 [info ] [MainThread]: 
[0m17:57:42.448434 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m17:57:42.455874 [debug] [MainThread]: Command end result
[0m17:57:42.485801 [info ] [MainThread]: 
[0m17:57:42.489413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:42.493537 [info ] [MainThread]: 
[0m17:57:42.498560 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:57:42.503107 [debug] [MainThread]: Command `dbt test` succeeded at 17:57:42.502583 after 1.80 seconds
[0m17:57:42.509705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419A5275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014199DD58D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D33E260>]}
[0m17:57:42.512703 [debug] [MainThread]: Flushing usage events
[0m17:59:37.718996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C48DB5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C70EE170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C70EDF60>]}


============================== 17:59:37.731231 | 02974df5-ed36-4167-ba7b-4114ff3bb53f ==============================
[0m17:59:37.731231 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:59:37.733762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:59:38.058350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C70EE200>]}
[0m17:59:38.084852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C41858D0>]}
[0m17:59:38.104456 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:59:38.198755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:38.199758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:38.211148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75FBF40>]}
[0m17:59:38.224754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75BCF70>]}
[0m17:59:38.225764 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:59:38.228295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75BD1B0>]}
[0m17:59:38.230301 [info ] [MainThread]: 
[0m17:59:38.232297 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:59:38.234821 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:59:38.260922 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:59:38.262432 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:59:38.262432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:38.377156 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:38.381170 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:59:38.385701 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:59:38.407377 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:59:38.409930 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:59:38.410951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:38.600678 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:38.604222 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:59:38.605213 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:59:38.611129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75A7F40>]}
[0m17:59:38.612132 [debug] [MainThread]: On master: COMMIT
[0m17:59:38.614256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:38.616254 [info ] [MainThread]: 
[0m17:59:38.630926 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m17:59:38.631926 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.toto ....................................... [RUN]
[0m17:59:38.635059 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m17:59:38.636060 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m17:59:38.643278 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m17:59:38.647341 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 17:59:38.637064 => 17:59:38.645799
[0m17:59:38.649359 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m17:59:38.765776 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m17:59:38.773925 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:59:38.777460 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:59:38.780481 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:40.739168 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m17:59:40.768346 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:59:40.772067 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m17:59:41.051966 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:41.063875 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:59:41.065843 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m17:59:41.265887 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:41.284869 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:59:41.286888 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m17:59:41.565093 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:41.623025 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 17:59:38.650365 => 17:59:41.623025
[0m17:59:41.626024 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m17:59:41.628025 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m17:59:41.632026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C76B3C10>]}
[0m17:59:41.634149 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 3.00s]
[0m17:59:41.638165 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m17:59:41.642167 [debug] [MainThread]: On master: COMMIT
[0m17:59:41.644566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:41.646563 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:59:41.648580 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:59:41.650583 [debug] [MainThread]: Connection 'model.projet_dbt.toto' was properly closed.
[0m17:59:41.652189 [info ] [MainThread]: 
[0m17:59:41.654134 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m17:59:41.657153 [debug] [MainThread]: Command end result
[0m17:59:41.679264 [info ] [MainThread]: 
[0m17:59:41.680352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:41.683882 [info ] [MainThread]: 
[0m17:59:41.685887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:59:41.688884 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:41.687884 after 4.01 seconds
[0m17:59:41.689883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C48DB5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C41858D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75BD120>]}
[0m17:59:41.691883 [debug] [MainThread]: Flushing usage events
[0m18:17:56.837990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6129675E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6151F2230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6151F1F60>]}


============================== 18:17:56.880321 | 6e521176-1bed-464a-ac75-c6fa0e1d2229 ==============================
[0m18:17:56.880321 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:17:56.901039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:18:00.003158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6151F21D0>]}
[0m18:18:00.525985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D612214FA0>]}
[0m18:18:00.833617 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:18:01.031466 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:18:01.051640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D61220BD90>]}
[0m18:18:15.284616 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m18:18:15.362515 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:18:16.035858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D615658400>]}
[0m18:18:16.072518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6156583A0>]}
[0m18:18:16.077107 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:18:16.081080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D615658400>]}
[0m18:18:16.091371 [info ] [MainThread]: 
[0m18:18:16.097529 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:18:16.112071 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:18:16.192202 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:18:16.196238 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:18:16.199317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:18.490500 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m18:18:18.499518 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:18:18.514332 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:18:18.583549 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:18:18.587626 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:18:18.590652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:19.793316 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:19.804274 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:18:19.809154 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:18:19.835796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6156A5690>]}
[0m18:18:19.841421 [debug] [MainThread]: On master: COMMIT
[0m18:18:19.853024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:19.860382 [info ] [MainThread]: 
[0m18:18:19.936418 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m18:18:19.943609 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.toto ....................................... [RUN]
[0m18:18:19.956413 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m18:18:19.962566 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m18:18:19.991105 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m18:18:20.021390 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 18:18:19.965633 => 18:18:20.018393
[0m18:18:20.027597 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m18:18:20.422538 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m18:18:20.457378 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:18:20.462166 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:18:20.466401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:18:29.214272 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m18:18:29.258438 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:18:29.262997 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m18:18:29.945250 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:29.963464 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:18:29.967072 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m18:18:30.448991 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:18:30.490774 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:18:30.495327 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m18:18:31.478208 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:31.686123 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 18:18:20.037449 => 18:18:31.684571
[0m18:18:31.699909 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m18:18:31.718180 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m18:18:31.731497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D615851870>]}
[0m18:18:31.745044 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 11.78s]
[0m18:18:31.762220 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m18:18:31.769581 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:18:31.789029 [info ] [Thread-1 (]: 2 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:18:31.806106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m18:18:31.813320 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:18:31.863768 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:18:31.883640 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:18:31.815175 => 18:18:31.882053
[0m18:18:31.892952 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:18:31.937414 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:18:31.960288 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:18:31.965767 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:18:31.972384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:37.044510 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m18:18:37.066140 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:18:37.070258 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:18:38.102971 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:38.129112 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:18:38.133699 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:18:38.994572 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:39.014618 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:18:39.019077 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:18:41.175163 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:18:41.193498 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:18:31.895688 => 18:18:41.192236
[0m18:18:41.196480 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:18:41.198785 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:18:41.218305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6156849D0>]}
[0m18:18:41.230708 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 9.41s]
[0m18:18:41.237067 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:18:41.263858 [debug] [MainThread]: On master: COMMIT
[0m18:18:41.273628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:41.282282 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:18:41.286300 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m18:18:41.296331 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m18:18:41.300083 [info ] [MainThread]: 
[0m18:18:41.313629 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 25.20 seconds (25.20s).
[0m18:18:41.341278 [debug] [MainThread]: Command end result
[0m18:18:41.430540 [info ] [MainThread]: 
[0m18:18:41.454913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:41.472470 [info ] [MainThread]: 
[0m18:18:41.482894 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:18:41.498113 [debug] [MainThread]: Command `dbt run` succeeded at 18:18:41.495884 after 45.99 seconds
[0m18:18:41.503291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6129675E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D612214FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6155A4520>]}
[0m18:18:41.528113 [debug] [MainThread]: Flushing usage events
[0m18:20:21.437791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021280A2B5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128324E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128324DF30>]}


============================== 18:20:21.454291 | 8030127d-c029-4ef1-97ae-12f6ae3a0ce2 ==============================
[0m18:20:21.454291 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:20:21.458853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:20:22.064830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128324E200>]}
[0m18:20:22.108054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212802F4E80>]}
[0m18:20:22.137771 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:20:22.189973 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:20:22.192986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212802EBEB0>]}
[0m18:20:24.650394 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m18:20:24.700042 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:20:25.026466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128365CA90>]}
[0m18:20:25.048715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128365CA90>]}
[0m18:20:25.050872 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:20:25.054014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021283785270>]}
[0m18:20:25.059529 [info ] [MainThread]: 
[0m18:20:25.063526 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:20:25.068510 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:20:25.117948 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:20:25.119949 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:20:25.122950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:25.312715 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:25.318774 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:20:25.327859 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:20:25.372543 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:20:25.375091 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:20:25.378640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:25.639783 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:25.648627 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:20:25.651632 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:20:25.662919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212802F30A0>]}
[0m18:20:25.666542 [debug] [MainThread]: On master: COMMIT
[0m18:20:25.669499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:25.673158 [info ] [MainThread]: 
[0m18:20:25.699227 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m18:20:25.702757 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.toto ....................................... [RUN]
[0m18:20:25.709432 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m18:20:25.712446 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m18:20:25.727986 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m18:20:25.734529 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 18:20:25.714431 => 18:20:25.733531
[0m18:20:25.737724 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m18:20:25.922402 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m18:20:25.935113 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:20:25.938956 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:20:25.942546 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:20:28.917709 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m18:20:28.970178 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:20:28.975657 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m18:20:29.403830 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:29.424553 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:20:29.428294 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m18:20:29.719511 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:29.755815 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:20:29.758358 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m18:20:30.247072 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:30.398279 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 18:20:25.740726 => 18:20:30.396690
[0m18:20:30.403633 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m18:20:30.408881 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m18:20:30.417351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128370AF50>]}
[0m18:20:30.422898 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 4.71s]
[0m18:20:30.433727 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m18:20:30.438413 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:20:30.444295 [info ] [Thread-1 (]: 2 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:20:30.450934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m18:20:30.456680 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:20:30.497875 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:20:30.507385 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:20:30.469882 => 18:20:30.505162
[0m18:20:30.511992 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:20:30.544186 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:20:30.560997 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:20:30.563546 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:20:30.565321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:34.315197 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m18:20:34.333593 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:20:34.337124 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:20:34.696596 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:34.718187 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:20:34.721706 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:20:35.109820 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:35.134400 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:20:35.138965 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:20:35.618432 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:35.631834 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:20:30.513595 => 18:20:35.630824
[0m18:20:35.636741 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:20:35.641394 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:20:35.646392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212838BD9C0>]}
[0m18:20:35.651644 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 5.20s]
[0m18:20:35.659231 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:20:35.669443 [debug] [MainThread]: On master: COMMIT
[0m18:20:35.673552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:35.677579 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:20:35.680583 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m18:20:35.683581 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m18:20:35.686699 [info ] [MainThread]: 
[0m18:20:35.690078 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.62 seconds (10.62s).
[0m18:20:35.697839 [debug] [MainThread]: Command end result
[0m18:20:35.738415 [info ] [MainThread]: 
[0m18:20:35.742414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:35.746429 [info ] [MainThread]: 
[0m18:20:35.749741 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:20:35.754949 [debug] [MainThread]: Command `dbt run` succeeded at 18:20:35.753927 after 14.42 seconds
[0m18:20:35.758479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021280A2B5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212802F4E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212836F0A60>]}
[0m18:20:35.760472 [debug] [MainThread]: Flushing usage events
[0m11:17:34.114074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F61A75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A12260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A11F90>]}


============================== 11:17:34.118803 | 92d7c5c4-479a-44cb-9232-e21299f98d8b ==============================
[0m11:17:34.118803 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:17:34.120663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:17:34.296618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A12200>]}
[0m11:17:34.307751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F5A494E0>]}
[0m11:17:34.330476 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:17:34.349243 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:17:34.349964 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:17:34.350986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8D1E110>]}
[0m11:17:35.741741 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m11:17:35.752793 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m11:17:35.757819 [debug] [MainThread]: 1699: static parser successfully parsed silver\weather.sql
[0m11:17:35.859944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A11FF0>]}
[0m11:17:35.873295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A10EB0>]}
[0m11:17:35.873295 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:17:35.877296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F5A21990>]}
[0m11:17:35.879297 [info ] [MainThread]: 
[0m11:17:35.881297 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:17:35.886476 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:17:35.903995 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:17:35.904995 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:17:35.908999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:36.614126 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:17:36.615127 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:17:36.619124 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m11:17:36.630377 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m11:17:36.631156 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m11:17:36.632155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:36.954128 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:36.956153 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m11:17:36.957129 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m11:17:36.959128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8EFBF70>]}
[0m11:17:36.960127 [debug] [MainThread]: On master: COMMIT
[0m11:17:36.961126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:17:36.962128 [info ] [MainThread]: 
[0m11:17:36.972162 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m11:17:36.973130 [info ] [Thread-1 (]: 1 of 3 START sql table model bronze.toto ....................................... [RUN]
[0m11:17:36.974128 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m11:17:36.976128 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m11:17:36.979129 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m11:17:36.980127 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 11:17:36.976128 => 11:17:36.980127
[0m11:17:36.981129 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m11:17:37.019289 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m11:17:37.023778 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:17:37.025789 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:17:37.027787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:17:39.232269 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m11:17:39.239269 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:17:39.240270 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m11:17:39.342544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:39.346541 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:17:39.346541 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m11:17:39.434335 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:39.443280 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:17:39.444279 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m11:17:39.622862 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:39.639379 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 11:17:36.981129 => 11:17:39.638397
[0m11:17:39.640380 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m11:17:39.640380 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m11:17:39.641380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8E80D60>]}
[0m11:17:39.643378 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 2.67s]
[0m11:17:39.645379 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m11:17:39.645379 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m11:17:39.646378 [info ] [Thread-1 (]: 2 of 3 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m11:17:39.648379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m11:17:39.648379 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m11:17:39.651381 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m11:17:39.652380 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 11:17:39.648379 => 11:17:39.652380
[0m11:17:39.652380 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m11:17:39.657380 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m11:17:39.659379 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:17:39.659379 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:17:39.660380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:40.574073 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:17:40.577899 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:17:40.577899 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:17:40.681332 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:40.684238 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:17:40.684238 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m11:17:40.795453 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:40.798542 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:17:40.798542 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:17:40.951215 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:40.954216 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 11:17:39.653379 => 11:17:40.953216
[0m11:17:40.954629 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m11:17:40.955215 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m11:17:40.957213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F5A45750>]}
[0m11:17:40.958214 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 1.31s]
[0m11:17:40.962216 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m11:17:40.963214 [debug] [Thread-1 (]: Began running node model.projet_dbt.weather
[0m11:17:40.963214 [info ] [Thread-1 (]: 3 of 3 START sql table model bronze.weather .................................... [RUN]
[0m11:17:40.965212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weather)
[0m11:17:40.966214 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weather
[0m11:17:40.969730 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weather"
[0m11:17:40.972732 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weather (compile): 11:17:40.966214 => 11:17:40.971732
[0m11:17:40.973734 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weather
[0m11:17:40.980640 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weather"
[0m11:17:40.980640 [debug] [Thread-1 (]: On model.projet_dbt.weather: drop table if exists "lakehouse"."bronze"."weather__dbt_tmp"
[0m11:17:40.981638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:41.099053 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:41.100053 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weather"
[0m11:17:41.106478 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weather"
[0m11:17:41.107480 [debug] [Thread-1 (]: On model.projet_dbt.weather: create table lakehouse.bronze.weather__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:17:41.545470 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:41.548889 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weather"
[0m11:17:41.548889 [debug] [Thread-1 (]: On model.projet_dbt.weather: alter table "lakehouse"."bronze"."weather" rename to lakehouse.bronze.weather__dbt_backup
[0m11:17:41.576373 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230601_181643_00178_4r63g
[0m11:17:41.577576 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weather", query_id=20230601_181643_00178_4r63g)
[0m11:17:41.578487 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weather (execute): 11:17:40.974630 => 11:17:41.578487
[0m11:17:41.578487 [debug] [Thread-1 (]: On model.projet_dbt.weather: ROLLBACK
[0m11:17:41.579490 [debug] [Thread-1 (]: On model.projet_dbt.weather: Close
[0m11:17:41.677219 [debug] [Thread-1 (]: Database Error in model weather (models\silver\weather.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weather", query_id=20230601_181643_00178_4r63g)
  compiled Code at target\run\projet_dbt\models\silver\weather.sql
[0m11:17:41.678244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F9141390>]}
[0m11:17:41.679225 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model bronze.weather ........................... [[31mERROR[0m in 0.71s]
[0m11:17:41.680224 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weather
[0m11:17:41.682225 [debug] [MainThread]: On master: COMMIT
[0m11:17:41.682225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:41.682225 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m11:17:41.683225 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m11:17:41.683225 [debug] [MainThread]: Connection 'model.projet_dbt.weather' was properly closed.
[0m11:17:41.684224 [info ] [MainThread]: 
[0m11:17:41.687222 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m11:17:41.689224 [debug] [MainThread]: Command end result
[0m11:17:41.697224 [info ] [MainThread]: 
[0m11:17:41.698225 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:17:41.701222 [info ] [MainThread]: 
[0m11:17:41.702224 [error] [MainThread]: [33mDatabase Error in model weather (models\silver\weather.sql)[0m
[0m11:17:41.704223 [error] [MainThread]:   TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weather", query_id=20230601_181643_00178_4r63g)
[0m11:17:41.706224 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\silver\weather.sql
[0m11:17:41.708224 [info ] [MainThread]: 
[0m11:17:41.709224 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:17:41.709224 [debug] [MainThread]: Command `dbt run` failed at 11:17:41.709224 after 7.76 seconds
[0m11:17:41.710224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F61A75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8EC2F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8DECC70>]}
[0m11:17:41.710224 [debug] [MainThread]: Flushing usage events
[0m11:19:17.016554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C7B75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06E200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06DF30>]}


============================== 11:19:17.020562 | 2cef82d8-414a-425b-96cb-02d511671936 ==============================
[0m11:19:17.020562 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:19:17.020562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:19:17.146713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06E1A0>]}
[0m11:19:17.157713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C065660>]}
[0m11:19:17.168229 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:19:17.193228 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:19:17.194229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06E170>]}
[0m11:19:17.718612 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m11:19:17.727901 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m11:19:17.730909 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m11:19:17.830071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06DF90>]}
[0m11:19:17.835071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06D7E0>]}
[0m11:19:17.835071 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:19:17.836077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06D840>]}
[0m11:19:17.837011 [info ] [MainThread]: 
[0m11:19:17.838071 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:19:17.839975 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:19:17.849076 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:19:17.851079 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:19:17.851079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:17.967361 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:17.968367 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:19:17.971369 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m11:19:17.973074 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m11:19:17.973074 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m11:19:17.973074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:18.077288 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:18.078286 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m11:19:18.079787 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m11:19:18.082300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F4913F0>]}
[0m11:19:18.082300 [debug] [MainThread]: On master: COMMIT
[0m11:19:18.082300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:19:18.084818 [info ] [MainThread]: 
[0m11:19:18.089865 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m11:19:18.090892 [info ] [Thread-1 (]: 1 of 3 START sql table model bronze.toto ....................................... [RUN]
[0m11:19:18.091707 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m11:19:18.091707 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m11:19:18.094747 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m11:19:18.096728 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 11:19:18.092756 => 11:19:18.096728
[0m11:19:18.096728 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m11:19:18.127258 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m11:19:18.130238 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:19:18.130238 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:19:18.131239 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:19:18.934017 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:19:18.941024 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:19:18.941024 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m11:19:18.996281 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:19.000284 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:19:19.000284 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m11:19:19.113525 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:19.120525 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:19:19.120525 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m11:19:19.246981 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:19.262580 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 11:19:18.097729 => 11:19:19.262580
[0m11:19:19.262580 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m11:19:19.263546 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m11:19:19.264547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F4ECD30>]}
[0m11:19:19.265546 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 1.17s]
[0m11:19:19.266546 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m11:19:19.267548 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m11:19:19.267548 [info ] [Thread-1 (]: 2 of 3 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m11:19:19.268547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m11:19:19.269547 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m11:19:19.271571 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m11:19:19.273581 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 11:19:19.269547 => 11:19:19.273581
[0m11:19:19.273581 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m11:19:19.277547 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m11:19:19.279547 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:19:19.279547 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:19:19.280547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:19.904247 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:19:19.908246 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:19:19.909247 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:19:19.966300 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:19.970306 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:19:19.970306 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m11:19:20.027938 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.031192 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:19:20.032174 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:19:20.128962 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.131963 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 11:19:19.274552 => 11:19:20.131963
[0m11:19:20.131963 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m11:19:20.132961 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m11:19:20.133962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F7069B0>]}
[0m11:19:20.133962 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 0.87s]
[0m11:19:20.136476 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m11:19:20.137477 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m11:19:20.137477 [info ] [Thread-1 (]: 3 of 3 START sql table model bronze.weathersil ................................. [RUN]
[0m11:19:20.138476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m11:19:20.139482 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m11:19:20.142479 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m11:19:20.143479 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 11:19:20.139482 => 11:19:20.143479
[0m11:19:20.144476 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m11:19:20.147479 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m11:19:20.151475 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:19:20.151475 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.bronze.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:19:20.152478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:20.573613 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.576638 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:19:20.576638 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.bronze.weathersil__dbt_tmp rename to lakehouse.bronze.weathersil
[0m11:19:20.647493 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.650515 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:19:20.651493 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.bronze.weathersil__dbt_backup
[0m11:19:20.667036 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.670088 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 11:19:20.144476 => 11:19:20.670088
[0m11:19:20.670088 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m11:19:20.671040 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m11:19:20.672040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F4ECA00>]}
[0m11:19:20.672611 [info ] [Thread-1 (]: 3 of 3 OK created sql table model bronze.weathersil ............................ [[32mSUCCESS[0m in 0.53s]
[0m11:19:20.673820 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m11:19:20.675828 [debug] [MainThread]: On master: COMMIT
[0m11:19:20.676829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:20.676829 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m11:19:20.676829 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m11:19:20.677829 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m11:19:20.677829 [info ] [MainThread]: 
[0m11:19:20.678838 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m11:19:20.679829 [debug] [MainThread]: Command end result
[0m11:19:20.686658 [info ] [MainThread]: 
[0m11:19:20.687165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:19:20.688173 [info ] [MainThread]: 
[0m11:19:20.688173 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:19:20.689184 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:20.689184 after 3.74 seconds
[0m11:19:20.690174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C7B75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CA1D1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F4FD180>]}
[0m11:19:20.691173 [debug] [MainThread]: Flushing usage events
[0m11:21:41.793252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2BD075E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56E170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56DF60>]}


============================== 11:21:41.796160 | 092108e8-a90e-4739-9046-cc918204b573 ==============================
[0m11:21:41.796160 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:21:41.797176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:21:41.919228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56E230>]}
[0m11:21:41.930246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B5BB250>]}
[0m11:21:41.942681 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:21:41.967536 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:21:41.968516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56E1A0>]}
[0m11:21:42.525354 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m11:21:42.534356 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m11:21:42.538355 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m11:21:42.642026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56DEA0>]}
[0m11:21:42.652116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56D5D0>]}
[0m11:21:42.653122 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:21:42.655128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B583730>]}
[0m11:21:42.657134 [info ] [MainThread]: 
[0m11:21:42.658123 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:21:42.659633 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:21:42.671843 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:21:42.672843 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:21:42.673843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:42.763914 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:42.764924 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:21:42.769333 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:21:42.770062 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:21:42.770062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:42.822196 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:42.823821 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:21:42.826266 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m11:21:42.836163 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m11:21:42.837190 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m11:21:42.837190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:42.926259 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:42.928300 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m11:21:42.928300 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m11:21:42.930338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m11:21:42.934146 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m11:21:42.935240 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m11:21:42.935240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:43.015663 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:43.017268 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m11:21:43.018228 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m11:21:43.020747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2EA6BF40>]}
[0m11:21:43.021774 [debug] [MainThread]: On master: COMMIT
[0m11:21:43.022895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:43.024333 [info ] [MainThread]: 
[0m11:21:43.030753 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m11:21:43.030753 [info ] [Thread-1 (]: 1 of 3 START sql table model bronze.toto ....................................... [RUN]
[0m11:21:43.032763 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m11:21:43.032763 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m11:21:43.037761 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m11:21:43.040275 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 11:21:43.034202 => 11:21:43.040275
[0m11:21:43.041276 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m11:21:43.074413 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m11:21:43.076850 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:21:43.077860 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:21:43.077860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:21:43.778828 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:21:43.786055 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:21:43.787036 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m11:21:43.838666 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:43.841836 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:21:43.842905 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m11:21:43.952320 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:43.958833 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:21:43.958833 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m11:21:44.077808 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:44.100378 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 11:21:43.042275 => 11:21:44.099377
[0m11:21:44.100378 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m11:21:44.100378 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m11:21:44.102376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2EC45D20>]}
[0m11:21:44.103195 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 1.07s]
[0m11:21:44.104304 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m11:21:44.104573 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m11:21:44.105589 [info ] [Thread-1 (]: 2 of 3 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m11:21:44.106594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m11:21:44.107325 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m11:21:44.110247 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m11:21:44.111760 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 11:21:44.107831 => 11:21:44.110753
[0m11:21:44.111760 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m11:21:44.115760 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m11:21:44.117760 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:21:44.118760 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:21:44.118760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:44.707496 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:21:44.710512 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:21:44.710512 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:21:44.822803 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:44.825837 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:21:44.826897 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m11:21:44.875188 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:44.878644 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:21:44.878644 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:21:44.990210 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:44.992209 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 11:21:44.112760 => 11:21:44.992209
[0m11:21:44.993208 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m11:21:44.993208 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m11:21:44.994208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E95AA70>]}
[0m11:21:44.995209 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 0.89s]
[0m11:21:44.996207 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m11:21:44.997209 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m11:21:44.998206 [info ] [Thread-1 (]: 3 of 3 START sql table model silver.weathersil ................................. [RUN]
[0m11:21:44.999207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m11:21:45.000715 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m11:21:45.003740 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m11:21:45.006723 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 11:21:45.000715 => 11:21:45.005721
[0m11:21:45.006723 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m11:21:45.009721 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m11:21:45.012738 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:21:45.012738 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:21:45.013760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:45.403355 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:45.407397 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:21:45.407397 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m11:21:45.466189 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:45.469739 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:21:45.469739 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m11:21:45.487442 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:45.489561 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 11:21:45.006723 => 11:21:45.489561
[0m11:21:45.490299 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m11:21:45.490299 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m11:21:45.491377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E958100>]}
[0m11:21:45.493053 [info ] [Thread-1 (]: 3 of 3 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 0.49s]
[0m11:21:45.494419 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m11:21:45.494419 [debug] [MainThread]: On master: COMMIT
[0m11:21:45.496767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:45.497931 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m11:21:45.497931 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m11:21:45.497931 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m11:21:45.499169 [info ] [MainThread]: 
[0m11:21:45.499169 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m11:21:45.499169 [debug] [MainThread]: Command end result
[0m11:21:45.510473 [info ] [MainThread]: 
[0m11:21:45.510473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:21:45.511479 [info ] [MainThread]: 
[0m11:21:45.512472 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:21:45.512472 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:45.512472 after 3.79 seconds
[0m11:21:45.514473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2BD075E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2BF6E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2EA6BF40>]}
[0m11:21:45.514473 [debug] [MainThread]: Flushing usage events
[0m17:58:53.743662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF65475E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF8D82110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF8D81F00>]}


============================== 17:58:53.752886 | 7291daa2-9844-4196-a8b4-6c8896657a12 ==============================
[0m17:58:53.752886 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:58:53.754009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:58:53.756503 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'projet_dbt' does not have a target named 'dev'. The valid target names for this profile are:
   - bronze
   - silver
[0m17:58:53.764521 [debug] [MainThread]: Command `dbt run` failed at 17:58:53.764521 after 0.25 seconds
[0m17:58:53.766214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF65475E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF8D83F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF8D83F70>]}
[0m17:58:53.766214 [debug] [MainThread]: Flushing usage events
[0m18:00:25.106998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0B775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E33FE1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E33FDF00>]}


============================== 18:00:25.109903 | 94d1e87e-4cdc-472b-b0d5-69bb1f7c146b ==============================
[0m18:00:25.109903 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:00:25.115417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:00:25.360463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E33FE170>]}
[0m18:00:25.376659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0429EA0>]}
[0m18:00:25.408902 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:00:25.436166 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:00:25.439198 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:00:25.440088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E33FE140>]}
[0m18:00:27.112563 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:00:27.129349 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:00:27.268036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projet_dbt.dev
[0m18:00:27.275828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E38A5630>]}
[0m18:00:27.356820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E38A4F70>]}
[0m18:00:27.356820 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:00:27.361649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E03F1810>]}
[0m18:00:27.366432 [info ] [MainThread]: 
[0m18:00:27.369070 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:00:27.376384 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:00:27.389577 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:00:27.389577 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:00:27.389577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:28.016798 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:00:28.018007 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:00:28.026236 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:00:28.026236 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:00:28.026236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:28.124353 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:28.124353 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:00:28.129523 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:00:28.150201 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:00:28.152224 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:00:28.152224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:28.497660 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:28.497660 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:00:28.497660 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:00:28.497660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m18:00:28.508098 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:00:28.508098 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:00:28.514226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:28.668559 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:28.668559 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:00:28.668559 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:00:28.674604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E37FE560>]}
[0m18:00:28.675615 [debug] [MainThread]: On master: COMMIT
[0m18:00:28.675615 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:28.675615 [info ] [MainThread]: 
[0m18:00:28.688312 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:00:28.691838 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:00:28.691838 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:00:28.691838 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:00:28.691838 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:00:28.700114 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:00:28.691838 => 18:00:28.700114
[0m18:00:28.700114 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:00:28.741804 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:00:28.749044 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:00:28.749044 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:00:28.749044 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:30.848874 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:00:30.856883 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:00:30.856883 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:00:30.979887 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:30.989411 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:00:30.994920 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:00:31.085003 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:31.093065 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:00:31.093065 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:00:31.378006 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:31.410778 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:00:28.700114 => 18:00:31.410778
[0m18:00:31.410778 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:00:31.410778 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:00:31.410778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E3A87EB0>]}
[0m18:00:31.410778 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.72s]
[0m18:00:31.418589 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:00:31.418589 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:00:31.418589 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:00:31.418589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:00:31.418589 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:00:31.426973 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:00:31.426973 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:00:31.418589 => 18:00:31.426973
[0m18:00:31.426973 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:00:31.434996 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:00:31.443178 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:00:31.444530 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:00:31.444530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:32.216512 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:00:32.222078 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:00:32.222078 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:00:32.341259 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:32.344777 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:00:32.344777 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:00:32.455766 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:32.460779 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:00:32.465335 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:00:32.625424 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:32.631961 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:00:31.426973 => 18:00:32.631961
[0m18:00:32.631961 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:00:32.631961 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:00:32.636815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0411F30>]}
[0m18:00:32.637627 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.22s]
[0m18:00:32.640388 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:00:32.642852 [debug] [MainThread]: On master: COMMIT
[0m18:00:32.642852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:32.642852 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:00:32.642852 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m18:00:32.642852 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:00:32.642852 [info ] [MainThread]: 
[0m18:00:32.648260 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m18:00:32.648260 [debug] [MainThread]: Command end result
[0m18:00:32.661564 [info ] [MainThread]: 
[0m18:00:32.661564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:32.661564 [info ] [MainThread]: 
[0m18:00:32.665075 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:00:32.665607 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:32.665607 after 7.62 seconds
[0m18:00:32.665607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0B775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E3A87EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0DDC310>]}
[0m18:00:32.668176 [debug] [MainThread]: Flushing usage events
[0m18:01:09.220590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD89E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C69E260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C69DF90>]}


============================== 18:01:09.222328 | 8b7e3f59-da65-4278-bb62-a02ff6c78838 ==============================
[0m18:01:09.222328 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:01:09.222328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:01:09.490350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C69E200>]}
[0m18:01:09.517642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD896D54E0>]}
[0m18:01:09.535046 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:01:09.562392 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:01:09.562392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C9A60B0>]}
[0m18:01:10.488515 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:01:10.504395 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:01:10.683573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C9A53C0>]}
[0m18:01:10.692985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C9A4F40>]}
[0m18:01:10.695936 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:01:10.695936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8969FBB0>]}
[0m18:01:10.702727 [info ] [MainThread]: 
[0m18:01:10.719036 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:01:10.726571 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:01:10.742553 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:01:10.749564 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:01:10.750163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:10.881693 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:10.883232 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:01:10.891169 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:01:10.891169 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:01:10.891169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:10.975186 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:10.978198 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:01:10.980133 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:01:10.987628 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:01:10.987628 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:01:10.994651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:11.098909 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:11.101472 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:01:11.101472 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:01:11.101472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m18:01:11.111925 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:01:11.111925 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:01:11.116943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:11.252147 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:11.257425 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:01:11.257425 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:01:11.261535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CC7F670>]}
[0m18:01:11.261535 [debug] [MainThread]: On master: COMMIT
[0m18:01:11.264956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:11.264956 [info ] [MainThread]: 
[0m18:01:11.276224 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:01:11.277468 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:01:11.280109 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:01:11.281130 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:01:11.285051 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:01:11.289620 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:01:11.281130 => 18:01:11.289620
[0m18:01:11.289620 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:01:11.342877 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:01:11.345891 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:11.345891 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:01:11.352567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:12.479563 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:01:12.490531 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:12.490531 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:01:12.668444 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:12.673657 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:12.673657 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:01:12.771162 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:12.778804 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:12.778804 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:01:12.919083 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:12.943909 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:01:11.289620 => 18:01:12.943909
[0m18:01:12.943909 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:01:12.943909 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:01:12.951920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CD1FE20>]}
[0m18:01:12.951920 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 1.67s]
[0m18:01:12.951920 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:01:12.951920 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:01:12.951920 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:01:12.951920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:01:12.951920 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:01:12.959918 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:01:12.959918 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:01:12.951920 => 18:01:12.959918
[0m18:01:12.959918 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:01:12.967920 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:01:12.967920 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:12.967920 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:01:12.967920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:13.455262 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:13.462101 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:13.462101 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:01:13.532154 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:13.534262 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:13.539271 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:01:13.644761 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:13.651751 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:13.651751 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:01:13.814190 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:13.820208 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:01:12.959918 => 18:01:13.820208
[0m18:01:13.820208 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:01:13.820208 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:01:13.825728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CD48160>]}
[0m18:01:13.826842 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 0.87s]
[0m18:01:13.829880 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:01:13.833868 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.835204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:13.835204 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:01:13.836219 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m18:01:13.836219 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:01:13.839730 [info ] [MainThread]: 
[0m18:01:13.840918 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m18:01:13.847645 [debug] [MainThread]: Command end result
[0m18:01:13.860942 [info ] [MainThread]: 
[0m18:01:13.860942 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:13.860942 [info ] [MainThread]: 
[0m18:01:13.860942 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:01:13.860942 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:13.860942 after 4.68 seconds
[0m18:01:13.860942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD89E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CD1FE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CA5B9D0>]}
[0m18:01:13.868954 [debug] [MainThread]: Flushing usage events
[0m18:06:11.914970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234D5375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FDD2200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FDD1F30>]}


============================== 18:06:11.921439 | fc33b8ce-b1a4-4373-81ec-df38a9e9a11c ==============================
[0m18:06:11.921439 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:06:11.921439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:06:12.110224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FDD21A0>]}
[0m18:06:12.134263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234CDE79A0>]}
[0m18:06:12.151222 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:06:12.256594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:12.256594 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:12.264704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223502DCDC0>]}
[0m18:06:12.273002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223502A1510>]}
[0m18:06:12.273002 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:06:12.273002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223502A15A0>]}
[0m18:06:12.273002 [info ] [MainThread]: 
[0m18:06:12.273002 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:06:12.281013 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m18:06:12.297855 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:06:12.301141 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:06:12.301141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:12.446086 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:12.446086 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:06:12.451098 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:06:12.453643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m18:06:12.453643 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:06:12.460971 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:06:12.460971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:12.562952 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:12.565011 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:06:12.565011 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:06:12.568317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234CDE0BE0>]}
[0m18:06:12.571064 [debug] [MainThread]: On master: COMMIT
[0m18:06:12.571064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:12.571064 [info ] [MainThread]: 
[0m18:06:12.578707 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m18:06:12.582548 [info ] [Thread-1 (]: 1 of 3 START test not_null_weatheronepoint__airbyte_ab_id ...................... [RUN]
[0m18:06:12.584558 [debug] [Thread-1 (]: Acquiring new trino connection 'test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492'
[0m18:06:12.588071 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m18:06:12.605070 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m18:06:12.609691 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492 (compile): 18:06:12.588071 => 18:06:12.609691
[0m18:06:12.609691 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m18:06:12.633715 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m18:06:12.641736 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m18:06:12.642456 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_ab_id
from lakehouse.bronze.weatheronepoint
where _airbyte_ab_id is null



      
    ) dbt_internal_test
[0m18:06:12.642456 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:12.763552 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:12.765595 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492 (execute): 18:06:12.612514 => 18:06:12.765595
[0m18:06:12.767614 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: ROLLBACK
[0m18:06:12.767614 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: Close
[0m18:06:12.770604 [info ] [Thread-1 (]: 1 of 3 PASS not_null_weatheronepoint__airbyte_ab_id ............................ [[32mPASS[0m in 0.19s]
[0m18:06:12.771611 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m18:06:12.771611 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m18:06:12.771611 [info ] [Thread-1 (]: 2 of 3 START test not_null_weatheronepoint__airbyte_data ....................... [RUN]
[0m18:06:12.775618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492, now test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01)
[0m18:06:12.775618 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m18:06:12.781124 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m18:06:12.781124 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01 (compile): 18:06:12.775618 => 18:06:12.781124
[0m18:06:12.788008 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m18:06:12.788008 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m18:06:12.797561 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m18:06:12.802030 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_data
from lakehouse.bronze.weatheronepoint
where _airbyte_data is null



      
    ) dbt_internal_test
[0m18:06:12.802030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:12.931027 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:12.934987 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01 (execute): 18:06:12.788008 => 18:06:12.934284
[0m18:06:12.934987 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: ROLLBACK
[0m18:06:12.936497 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: Close
[0m18:06:12.938993 [info ] [Thread-1 (]: 2 of 3 PASS not_null_weatheronepoint__airbyte_data ............................. [[32mPASS[0m in 0.17s]
[0m18:06:12.941168 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m18:06:12.943428 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m18:06:12.945111 [info ] [Thread-1 (]: 3 of 3 START test not_null_weatheronepoint__airbyte_emitted_at ................. [RUN]
[0m18:06:12.945111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01, now test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31)
[0m18:06:12.948356 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m18:06:12.955049 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m18:06:12.959502 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31 (compile): 18:06:12.948356 => 18:06:12.955049
[0m18:06:12.960762 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m18:06:12.960762 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m18:06:12.971102 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m18:06:12.972253 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_emitted_at
from lakehouse.bronze.weatheronepoint
where _airbyte_emitted_at is null



      
    ) dbt_internal_test
[0m18:06:12.973368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:13.078820 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:13.082855 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31 (execute): 18:06:12.960762 => 18:06:13.082855
[0m18:06:13.082855 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: ROLLBACK
[0m18:06:13.085366 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: Close
[0m18:06:13.085366 [info ] [Thread-1 (]: 3 of 3 PASS not_null_weatheronepoint__airbyte_emitted_at ....................... [[32mPASS[0m in 0.14s]
[0m18:06:13.088290 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m18:06:13.091363 [debug] [MainThread]: On master: COMMIT
[0m18:06:13.091363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:13.091363 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m18:06:13.091363 [debug] [MainThread]: Connection 'test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31' was properly closed.
[0m18:06:13.091363 [info ] [MainThread]: 
[0m18:06:13.091363 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m18:06:13.097558 [debug] [MainThread]: Command end result
[0m18:06:13.107880 [info ] [MainThread]: 
[0m18:06:13.107880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:13.107880 [info ] [MainThread]: 
[0m18:06:13.107880 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:06:13.107880 [debug] [MainThread]: Command `dbt test` succeeded at 18:06:13.107880 after 1.24 seconds
[0m18:06:13.107880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234D5375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234D79D1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FDD21A0>]}
[0m18:06:13.116214 [debug] [MainThread]: Flushing usage events
