[0m17:31:00.266643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B4E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B76A21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B76A1F30>]}


============================== 17:31:00.273879 | f5fc16fd-027b-4268-8b40-000850bbf8d2 ==============================
[0m17:31:00.273879 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:31:00.274874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:31:00.781216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B76A2170>]}
[0m17:31:00.822419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46D74F0>]}
[0m17:31:00.877512 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:31:00.898678 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:31:00.901219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46C9180>]}
[0m17:31:03.593215 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:31:03.699660 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'weather' in the 'models' section of file 'models\bronze\schema.yml'
[0m17:31:03.783173 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_coord_lon.111d5fc247' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.784683 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_coord_lat.73580ceedf' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.786698 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_weather_main.e550921c88' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.788697 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_weather_description.4881254a38' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.790206 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_main_temp.46cf30c876' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.792220 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_main_humidity.4df0aafc92' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.795746 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_wind_speed.9983f1ae3d' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.797744 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_wind_deg.d7b4c06687' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.905050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7AE9150>]}
[0m17:31:03.923680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46CA590>]}
[0m17:31:03.926681 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:31:03.929679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B469EE00>]}
[0m17:31:03.933206 [info ] [MainThread]: 
[0m17:31:03.936733 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:31:03.942262 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:31:03.998768 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:31:04.001128 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:31:04.003125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:04.186266 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:04.191800 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:31:04.203058 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:31:04.237794 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:31:04.239923 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:31:04.242843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:04.635780 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:04.640824 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:31:04.642824 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:31:04.651100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7BA4160>]}
[0m17:31:04.652633 [debug] [MainThread]: On master: COMMIT
[0m17:31:04.655163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:04.657702 [info ] [MainThread]: 
[0m17:31:04.679581 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:31:04.682544 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:31:04.687086 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:31:04.689606 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:31:04.703317 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:31:04.714564 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:31:04.691627 => 17:31:04.712497
[0m17:31:04.717492 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:31:04.870686 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:31:04.883220 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:04.886774 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:31:04.888768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:06.797466 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m17:31:06.830196 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:06.833210 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:31:07.076760 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:07.087867 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:07.090373 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:31:07.374921 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:07.401661 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:07.405033 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:31:07.755933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:07.810481 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:31:04.719494 => 17:31:07.809919
[0m17:31:07.812496 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:31:07.815547 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:31:07.819494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7C60100>]}
[0m17:31:07.824597 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 3.13s]
[0m17:31:07.830384 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:31:07.835438 [debug] [MainThread]: On master: COMMIT
[0m17:31:07.837405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:07.838466 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:31:07.842209 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:31:07.845778 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m17:31:07.847780 [info ] [MainThread]: 
[0m17:31:07.850298 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m17:31:07.859875 [debug] [MainThread]: Command end result
[0m17:31:07.882917 [info ] [MainThread]: 
[0m17:31:07.887007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:07.891563 [info ] [MainThread]: 
[0m17:31:07.895794 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:31:07.900311 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:07.899795 after 7.67 seconds
[0m17:31:07.902332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B4E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46D74F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7AE9FC0>]}
[0m17:31:07.906020 [debug] [MainThread]: Flushing usage events
[0m17:32:03.553655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D38C75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D6182170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D6181F60>]}


============================== 17:32:03.561417 | 74d28918-0352-4436-a90b-3d8c97b1ab5e ==============================
[0m17:32:03.561417 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:32:03.563431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:32:03.884090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D6182200>]}
[0m17:32:03.914054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D3166BC0>]}
[0m17:32:03.938091 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:32:04.073548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:04.075495 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\bronze\schema.yml
[0m17:32:04.204660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D66F54B0>]}
[0m17:32:04.219294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D66BB6A0>]}
[0m17:32:04.220845 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:32:04.222859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D669B820>]}
[0m17:32:04.226856 [info ] [MainThread]: 
[0m17:32:04.230401 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:32:04.233299 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:32:04.260469 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:32:04.261484 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:32:04.262682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:04.366604 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:04.369174 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:32:04.372904 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:32:04.389555 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:32:04.390564 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:32:04.392568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:04.627844 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:04.632386 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:32:04.634416 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:32:04.638957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D66B86D0>]}
[0m17:32:04.640518 [debug] [MainThread]: On master: COMMIT
[0m17:32:04.643513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:04.645519 [info ] [MainThread]: 
[0m17:32:04.659225 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:32:04.662363 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:32:04.666931 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:32:04.667925 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:32:04.680084 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:32:04.687800 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:32:04.670455 => 17:32:04.685762
[0m17:32:04.690351 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:32:04.837064 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:32:04.846592 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:04.848588 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:32:04.850723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:06.025640 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:32:06.047544 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:06.050059 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:32:06.231037 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.240090 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:06.241099 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:32:06.421004 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.440896 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:06.442847 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:32:06.694538 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.755325 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:32:04.691340 => 17:32:06.754328
[0m17:32:06.757326 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:32:06.759325 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:32:06.763851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D67C3E20>]}
[0m17:32:06.765854 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.10s]
[0m17:32:06.769450 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:32:06.774399 [debug] [MainThread]: On master: COMMIT
[0m17:32:06.776867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:06.777891 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:32:06.780430 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:32:06.781424 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m17:32:06.783427 [info ] [MainThread]: 
[0m17:32:06.785433 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m17:32:06.789428 [debug] [MainThread]: Command end result
[0m17:32:06.810900 [info ] [MainThread]: 
[0m17:32:06.812902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:06.817438 [info ] [MainThread]: 
[0m17:32:06.819441 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:32:06.822047 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:06.821529 after 3.48 seconds
[0m17:32:06.824179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D38C75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D3166BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D67C3E20>]}
[0m17:32:06.826175 [debug] [MainThread]: Flushing usage events
[0m17:53:22.129749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9762775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978B4E170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978B4DF60>]}


============================== 17:53:22.143647 | 953a0ad7-299f-4021-86f2-f41136ac4645 ==============================
[0m17:53:22.143647 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:53:22.147609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:53:22.535119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978B4E200>]}
[0m17:53:22.551520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D975B25870>]}
[0m17:53:22.579532 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:53:23.748324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:23.750845 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\bronze\schema.yml
[0m17:53:23.782204 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:53:23.853743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9790CBEB0>]}
[0m17:53:23.865743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978F85F30>]}
[0m17:53:23.866743 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:53:23.868741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978F85F90>]}
[0m17:53:23.870739 [info ] [MainThread]: 
[0m17:53:23.872740 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:53:23.874907 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:53:23.896995 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:53:23.899039 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:53:23.900088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:24.497989 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:53:24.504036 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:53:24.507061 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:53:24.515765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '953a0ad7-299f-4021-86f2-f41136ac4645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D978F85F00>]}
[0m17:53:24.518759 [debug] [MainThread]: On master: COMMIT
[0m17:53:24.522308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:24.525852 [info ] [MainThread]: 
[0m17:53:24.557043 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m17:53:24.560586 [info ] [Thread-1 (]: 1 of 3 START test not_null_weatheronepoint__airbyte_ab_id ...................... [RUN]
[0m17:53:24.566132 [debug] [Thread-1 (]: Acquiring new trino connection 'test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492'
[0m17:53:24.569691 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m17:53:24.639233 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m17:53:24.646333 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492 (compile): 17:53:24.571690 => 17:53:24.645319
[0m17:53:24.648934 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m17:53:24.702558 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m17:53:24.717235 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m17:53:24.720314 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_ab_id
from lakehouse.bronze.weatheronepoint
where _airbyte_ab_id is null



      
    ) dbt_internal_test
[0m17:53:24.722310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:53:25.243741 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:53:25.258641 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492 (execute): 17:53:24.650973 => 17:53:25.256549
[0m17:53:25.262988 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: ROLLBACK
[0m17:53:25.269131 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: Close
[0m17:53:25.276234 [info ] [Thread-1 (]: 1 of 3 PASS not_null_weatheronepoint__airbyte_ab_id ............................ [[32mPASS[0m in 0.71s]
[0m17:53:25.284611 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m17:53:25.289129 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m17:53:25.294460 [info ] [Thread-1 (]: 2 of 3 START test not_null_weatheronepoint__airbyte_data ....................... [RUN]
[0m17:53:25.306959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492, now test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01)
[0m17:53:25.313676 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m17:53:25.340731 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m17:53:25.349767 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01 (compile): 17:53:25.319009 => 17:53:25.345805
[0m17:53:25.353809 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m17:53:25.367983 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m17:53:25.377468 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m17:53:25.383697 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_data
from lakehouse.bronze.weatheronepoint
where _airbyte_data is null



      
    ) dbt_internal_test
[0m17:53:25.386655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:25.752360 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:53:25.760446 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01 (execute): 17:53:25.356836 => 17:53:25.759425
[0m17:53:25.762467 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: ROLLBACK
[0m17:53:25.765543 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: Close
[0m17:53:25.770459 [info ] [Thread-1 (]: 2 of 3 PASS not_null_weatheronepoint__airbyte_data ............................. [[32mPASS[0m in 0.47s]
[0m17:53:25.775042 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m17:53:25.779031 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m17:53:25.781035 [info ] [Thread-1 (]: 3 of 3 START test not_null_weatheronepoint__airbyte_emitted_at ................. [RUN]
[0m17:53:25.787140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01, now test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31)
[0m17:53:25.789776 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m17:53:25.807978 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m17:53:25.816006 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31 (compile): 17:53:25.790807 => 17:53:25.815006
[0m17:53:25.818005 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m17:53:25.829674 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m17:53:25.841048 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m17:53:25.844594 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_emitted_at
from lakehouse.bronze.weatheronepoint
where _airbyte_emitted_at is null



      
    ) dbt_internal_test
[0m17:53:25.846790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:26.115038 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:53:26.121559 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31 (execute): 17:53:25.820395 => 17:53:26.120555
[0m17:53:26.124689 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: ROLLBACK
[0m17:53:26.127859 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: Close
[0m17:53:26.132905 [info ] [Thread-1 (]: 3 of 3 PASS not_null_weatheronepoint__airbyte_emitted_at ....................... [[32mPASS[0m in 0.35s]
[0m17:53:26.138654 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m17:53:26.145862 [debug] [MainThread]: On master: COMMIT
[0m17:53:26.148926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:26.151928 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:53:26.154666 [debug] [MainThread]: Connection 'test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31' was properly closed.
[0m17:53:26.159699 [info ] [MainThread]: 
[0m17:53:26.163545 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m17:53:26.173912 [debug] [MainThread]: Command end result
[0m17:53:26.211656 [info ] [MainThread]: 
[0m17:53:26.215690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:26.220030 [info ] [MainThread]: 
[0m17:53:26.223883 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:53:26.230906 [debug] [MainThread]: Command `dbt test` succeeded at 17:53:26.230906 after 4.39 seconds
[0m17:53:26.241357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9762775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9790C9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9764DECB0>]}
[0m17:53:26.252243 [debug] [MainThread]: Flushing usage events
[0m17:57:08.471596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1AE75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB433E1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB433DF00>]}


============================== 17:57:08.481663 | 21987e86-7eca-42a0-a13b-26a7c567ac56 ==============================
[0m17:57:08.481663 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:57:08.484744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:57:08.987111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21987e86-7eca-42a0-a13b-26a7c567ac56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB433E140>]}
[0m17:57:09.018034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21987e86-7eca-42a0-a13b-26a7c567ac56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB13968F0>]}
[0m17:57:09.056165 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:57:09.084870 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:57:09.090419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21987e86-7eca-42a0-a13b-26a7c567ac56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB135D270>]}
[0m17:57:13.616885 [error] [MainThread]: Encountered an error:

[0m17:57:13.975700 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\cli\requires.py", line 242, in wrapper
    manifest = ManifestLoader.get_full_manifest(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 227, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 386, in load
    self.parse_project(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 501, in parse_project
    parser: Parser = parser_cls(project, self.manifest, self.root_project)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\base.py", line 111, in __init__
    self._update_node_alias = RelationUpdate(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\parser\base.py", line 81, in __init__
    root_context = generate_generate_name_macro_context(macro, config, manifest)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\context\providers.py", line 1426, in generate_generate_name_macro_context
    return ctx.to_dict()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\context\manifest.py", line 67, in to_dict
    dct.update(self.namespace)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\_collections_abc.py", line 886, in __iter__
    yield from self._mapping
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\context\macros.py", line 58, in __iter__
    yield key
KeyboardInterrupt

[0m17:57:13.985560 [debug] [MainThread]: Command `dbt test` failed at 17:57:13.983999 after 5.58 seconds
[0m17:57:13.989118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB1AE75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB4725A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB4725C00>]}
[0m17:57:13.991104 [debug] [MainThread]: Flushing usage events
[0m17:57:25.652747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153316875E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015333F5E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015333F5DF30>]}


============================== 17:57:25.670823 | 7a0d6638-32e4-4160-b78c-b8b2c1ecedbc ==============================
[0m17:57:25.670823 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:57:25.674098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:57:26.048813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015333F5E170>]}
[0m17:57:26.082745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015330F35870>]}
[0m17:57:26.101124 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:57:26.118754 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:57:26.121252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015330F293C0>]}
[0m17:57:27.968933 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m17:57:28.218845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533438F700>]}
[0m17:57:28.229899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533438E320>]}
[0m17:57:28.231898 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:57:28.232897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533446BEB0>]}
[0m17:57:28.235939 [info ] [MainThread]: 
[0m17:57:28.237940 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:57:28.240940 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:57:28.266620 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:57:28.268623 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:57:28.269622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:28.392620 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:28.395144 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:57:28.400675 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:57:28.418263 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:57:28.420264 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:57:28.421266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:28.597520 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:28.602050 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:57:28.603601 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:57:28.609987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153343F0040>]}
[0m17:57:28.610990 [debug] [MainThread]: On master: COMMIT
[0m17:57:28.613524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:28.615514 [info ] [MainThread]: 
[0m17:57:28.632646 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m17:57:28.634186 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.toto ....................................... [RUN]
[0m17:57:28.638752 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m17:57:28.640749 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m17:57:28.648820 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m17:57:28.654033 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 17:57:28.641749 => 17:57:28.652821
[0m17:57:28.655033 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m17:57:28.767862 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m17:57:28.775445 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:57:28.777517 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:57:28.779558 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:31.295879 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m17:57:31.325848 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:57:31.328366 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m17:57:31.700774 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:31.735735 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:57:31.737738 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m17:57:31.818343 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:31.891642 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 17:57:28.657279 => 17:57:31.890636
[0m17:57:31.894192 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m17:57:31.896185 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m17:57:31.900733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a0d6638-32e4-4160-b78c-b8b2c1ecedbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015334452A70>]}
[0m17:57:31.903905 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 3.26s]
[0m17:57:31.908411 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m17:57:31.914970 [debug] [MainThread]: On master: COMMIT
[0m17:57:31.918311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:31.921092 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:57:31.922614 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:57:31.924682 [debug] [MainThread]: Connection 'model.projet_dbt.toto' was properly closed.
[0m17:57:31.928706 [info ] [MainThread]: 
[0m17:57:31.930704 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m17:57:31.935113 [debug] [MainThread]: Command end result
[0m17:57:31.967979 [info ] [MainThread]: 
[0m17:57:31.971008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:31.973545 [info ] [MainThread]: 
[0m17:57:31.977548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:57:31.981550 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:31.981550 after 6.38 seconds
[0m17:57:31.983653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153316875E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015330F35870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533438CA60>]}
[0m17:57:31.986915 [debug] [MainThread]: Flushing usage events
[0m17:57:40.728580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419A5275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419CE0E200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419CE0DF60>]}


============================== 17:57:40.734121 | 75e08a37-6638-47b8-a2f3-20d5c1d8b23d ==============================
[0m17:57:40.734121 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:57:40.737126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:57:40.951143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419CE0E1A0>]}
[0m17:57:40.969757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014199DD58D0>]}
[0m17:57:40.985821 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:57:41.064897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:41.065900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:41.074933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D31BF40>]}
[0m17:57:41.087577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D2DCF70>]}
[0m17:57:41.088480 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:57:41.089481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D2DD1B0>]}
[0m17:57:41.091507 [info ] [MainThread]: 
[0m17:57:41.093722 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:57:41.095720 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:57:41.114767 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:57:41.115766 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:57:41.116764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:41.325441 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:41.329068 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:57:41.330066 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:57:41.337602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75e08a37-6638-47b8-a2f3-20d5c1d8b23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D2C38B0>]}
[0m17:57:41.338617 [debug] [MainThread]: On master: COMMIT
[0m17:57:41.340617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:41.343128 [info ] [MainThread]: 
[0m17:57:41.355789 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3
[0m17:57:41.356795 [info ] [Thread-1 (]: 1 of 3 START test not_null_toto__airbyte_ab_id ................................. [RUN]
[0m17:57:41.361794 [debug] [Thread-1 (]: Acquiring new trino connection 'test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3'
[0m17:57:41.363915 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3
[0m17:57:41.396057 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3"
[0m17:57:41.398586 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3 (compile): 17:57:41.364914 => 17:57:41.398586
[0m17:57:41.399588 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3
[0m17:57:41.447977 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3"
[0m17:57:41.454021 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3"
[0m17:57:41.460541 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_ab_id
from lakehouse.bronze.toto
where _airbyte_ab_id is null



      
    ) dbt_internal_test
[0m17:57:41.465617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:41.728585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:41.733637 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3 (execute): 17:57:41.401590 => 17:57:41.732623
[0m17:57:41.734639 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3: ROLLBACK
[0m17:57:41.735639 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3: Close
[0m17:57:41.739638 [info ] [Thread-1 (]: 1 of 3 PASS not_null_toto__airbyte_ab_id ....................................... [[32mPASS[0m in 0.38s]
[0m17:57:41.741638 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3
[0m17:57:41.744751 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_toto__airbyte_data.37b110b011
[0m17:57:41.746755 [info ] [Thread-1 (]: 2 of 3 START test not_null_toto__airbyte_data .................................. [RUN]
[0m17:57:41.749773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_toto__airbyte_ab_id.e78e8fdad3, now test.projet_dbt.not_null_toto__airbyte_data.37b110b011)
[0m17:57:41.750772 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_toto__airbyte_data.37b110b011
[0m17:57:41.760295 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_toto__airbyte_data.37b110b011"
[0m17:57:41.764821 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_data.37b110b011 (compile): 17:57:41.751770 => 17:57:41.763821
[0m17:57:41.765820 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_toto__airbyte_data.37b110b011
[0m17:57:41.773771 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_toto__airbyte_data.37b110b011"
[0m17:57:41.788041 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_toto__airbyte_data.37b110b011"
[0m17:57:41.790894 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_data.37b110b011: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_data
from lakehouse.bronze.toto
where _airbyte_data is null



      
    ) dbt_internal_test
[0m17:57:41.795415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:42.015026 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:42.018570 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_data.37b110b011 (execute): 17:57:41.767821 => 17:57:42.018570
[0m17:57:42.020568 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_data.37b110b011: ROLLBACK
[0m17:57:42.021571 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_data.37b110b011: Close
[0m17:57:42.025805 [info ] [Thread-1 (]: 2 of 3 PASS not_null_toto__airbyte_data ........................................ [[32mPASS[0m in 0.28s]
[0m17:57:42.028979 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_toto__airbyte_data.37b110b011
[0m17:57:42.030976 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e
[0m17:57:42.032490 [info ] [Thread-1 (]: 3 of 3 START test not_null_toto__airbyte_emitted_at ............................ [RUN]
[0m17:57:42.035513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_toto__airbyte_data.37b110b011, now test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e)
[0m17:57:42.039034 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e
[0m17:57:42.056195 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e"
[0m17:57:42.061724 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e (compile): 17:57:42.041041 => 17:57:42.060726
[0m17:57:42.066090 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e
[0m17:57:42.075223 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e"
[0m17:57:42.085334 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e"
[0m17:57:42.088863 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_emitted_at
from lakehouse.bronze.toto
where _airbyte_emitted_at is null



      
    ) dbt_internal_test
[0m17:57:42.091868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:42.403711 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:57:42.407713 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e (execute): 17:57:42.067604 => 17:57:42.406710
[0m17:57:42.409238 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e: ROLLBACK
[0m17:57:42.411241 [debug] [Thread-1 (]: On test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e: Close
[0m17:57:42.416795 [info ] [Thread-1 (]: 3 of 3 PASS not_null_toto__airbyte_emitted_at .................................. [[32mPASS[0m in 0.38s]
[0m17:57:42.421548 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e
[0m17:57:42.429267 [debug] [MainThread]: On master: COMMIT
[0m17:57:42.431258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:42.433796 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:57:42.438310 [debug] [MainThread]: Connection 'test.projet_dbt.not_null_toto__airbyte_emitted_at.1e7851ba2e' was properly closed.
[0m17:57:42.440842 [info ] [MainThread]: 
[0m17:57:42.448434 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m17:57:42.455874 [debug] [MainThread]: Command end result
[0m17:57:42.485801 [info ] [MainThread]: 
[0m17:57:42.489413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:42.493537 [info ] [MainThread]: 
[0m17:57:42.498560 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:57:42.503107 [debug] [MainThread]: Command `dbt test` succeeded at 17:57:42.502583 after 1.80 seconds
[0m17:57:42.509705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419A5275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014199DD58D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419D33E260>]}
[0m17:57:42.512703 [debug] [MainThread]: Flushing usage events
[0m17:59:37.718996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C48DB5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C70EE170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C70EDF60>]}


============================== 17:59:37.731231 | 02974df5-ed36-4167-ba7b-4114ff3bb53f ==============================
[0m17:59:37.731231 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:59:37.733762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:59:38.058350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C70EE200>]}
[0m17:59:38.084852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C41858D0>]}
[0m17:59:38.104456 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:59:38.198755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:38.199758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:38.211148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75FBF40>]}
[0m17:59:38.224754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75BCF70>]}
[0m17:59:38.225764 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:59:38.228295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75BD1B0>]}
[0m17:59:38.230301 [info ] [MainThread]: 
[0m17:59:38.232297 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:59:38.234821 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:59:38.260922 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:59:38.262432 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:59:38.262432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:38.377156 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:38.381170 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:59:38.385701 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:59:38.407377 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:59:38.409930 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:59:38.410951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:38.600678 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:38.604222 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:59:38.605213 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:59:38.611129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75A7F40>]}
[0m17:59:38.612132 [debug] [MainThread]: On master: COMMIT
[0m17:59:38.614256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:38.616254 [info ] [MainThread]: 
[0m17:59:38.630926 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m17:59:38.631926 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.toto ....................................... [RUN]
[0m17:59:38.635059 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m17:59:38.636060 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m17:59:38.643278 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m17:59:38.647341 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 17:59:38.637064 => 17:59:38.645799
[0m17:59:38.649359 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m17:59:38.765776 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m17:59:38.773925 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:59:38.777460 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:59:38.780481 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:40.739168 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m17:59:40.768346 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:59:40.772067 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m17:59:41.051966 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:41.063875 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:59:41.065843 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m17:59:41.265887 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:41.284869 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m17:59:41.286888 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m17:59:41.565093 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:41.623025 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 17:59:38.650365 => 17:59:41.623025
[0m17:59:41.626024 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m17:59:41.628025 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m17:59:41.632026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02974df5-ed36-4167-ba7b-4114ff3bb53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C76B3C10>]}
[0m17:59:41.634149 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 3.00s]
[0m17:59:41.638165 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m17:59:41.642167 [debug] [MainThread]: On master: COMMIT
[0m17:59:41.644566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:41.646563 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:59:41.648580 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:59:41.650583 [debug] [MainThread]: Connection 'model.projet_dbt.toto' was properly closed.
[0m17:59:41.652189 [info ] [MainThread]: 
[0m17:59:41.654134 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m17:59:41.657153 [debug] [MainThread]: Command end result
[0m17:59:41.679264 [info ] [MainThread]: 
[0m17:59:41.680352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:41.683882 [info ] [MainThread]: 
[0m17:59:41.685887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:59:41.688884 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:41.687884 after 4.01 seconds
[0m17:59:41.689883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C48DB5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C41858D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C75BD120>]}
[0m17:59:41.691883 [debug] [MainThread]: Flushing usage events
[0m18:17:56.837990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6129675E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6151F2230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6151F1F60>]}


============================== 18:17:56.880321 | 6e521176-1bed-464a-ac75-c6fa0e1d2229 ==============================
[0m18:17:56.880321 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:17:56.901039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:18:00.003158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6151F21D0>]}
[0m18:18:00.525985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D612214FA0>]}
[0m18:18:00.833617 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:18:01.031466 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:18:01.051640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D61220BD90>]}
[0m18:18:15.284616 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m18:18:15.362515 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:18:16.035858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D615658400>]}
[0m18:18:16.072518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6156583A0>]}
[0m18:18:16.077107 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:18:16.081080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D615658400>]}
[0m18:18:16.091371 [info ] [MainThread]: 
[0m18:18:16.097529 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:18:16.112071 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:18:16.192202 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:18:16.196238 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:18:16.199317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:18.490500 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m18:18:18.499518 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:18:18.514332 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:18:18.583549 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:18:18.587626 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:18:18.590652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:19.793316 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:19.804274 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:18:19.809154 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:18:19.835796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6156A5690>]}
[0m18:18:19.841421 [debug] [MainThread]: On master: COMMIT
[0m18:18:19.853024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:19.860382 [info ] [MainThread]: 
[0m18:18:19.936418 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m18:18:19.943609 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.toto ....................................... [RUN]
[0m18:18:19.956413 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m18:18:19.962566 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m18:18:19.991105 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m18:18:20.021390 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 18:18:19.965633 => 18:18:20.018393
[0m18:18:20.027597 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m18:18:20.422538 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m18:18:20.457378 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:18:20.462166 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:18:20.466401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:18:29.214272 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m18:18:29.258438 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:18:29.262997 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m18:18:29.945250 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:29.963464 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:18:29.967072 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m18:18:30.448991 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:18:30.490774 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:18:30.495327 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m18:18:31.478208 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:31.686123 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 18:18:20.037449 => 18:18:31.684571
[0m18:18:31.699909 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m18:18:31.718180 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m18:18:31.731497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D615851870>]}
[0m18:18:31.745044 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 11.78s]
[0m18:18:31.762220 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m18:18:31.769581 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:18:31.789029 [info ] [Thread-1 (]: 2 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:18:31.806106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m18:18:31.813320 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:18:31.863768 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:18:31.883640 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:18:31.815175 => 18:18:31.882053
[0m18:18:31.892952 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:18:31.937414 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:18:31.960288 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:18:31.965767 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:18:31.972384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:37.044510 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m18:18:37.066140 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:18:37.070258 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:18:38.102971 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:38.129112 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:18:38.133699 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:18:38.994572 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:18:39.014618 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:18:39.019077 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:18:41.175163 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:18:41.193498 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:18:31.895688 => 18:18:41.192236
[0m18:18:41.196480 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:18:41.198785 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:18:41.218305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e521176-1bed-464a-ac75-c6fa0e1d2229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6156849D0>]}
[0m18:18:41.230708 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 9.41s]
[0m18:18:41.237067 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:18:41.263858 [debug] [MainThread]: On master: COMMIT
[0m18:18:41.273628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:41.282282 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:18:41.286300 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m18:18:41.296331 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m18:18:41.300083 [info ] [MainThread]: 
[0m18:18:41.313629 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 25.20 seconds (25.20s).
[0m18:18:41.341278 [debug] [MainThread]: Command end result
[0m18:18:41.430540 [info ] [MainThread]: 
[0m18:18:41.454913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:41.472470 [info ] [MainThread]: 
[0m18:18:41.482894 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:18:41.498113 [debug] [MainThread]: Command `dbt run` succeeded at 18:18:41.495884 after 45.99 seconds
[0m18:18:41.503291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6129675E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D612214FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6155A4520>]}
[0m18:18:41.528113 [debug] [MainThread]: Flushing usage events
[0m18:20:21.437791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021280A2B5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128324E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128324DF30>]}


============================== 18:20:21.454291 | 8030127d-c029-4ef1-97ae-12f6ae3a0ce2 ==============================
[0m18:20:21.454291 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:20:21.458853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:20:22.064830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128324E200>]}
[0m18:20:22.108054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212802F4E80>]}
[0m18:20:22.137771 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:20:22.189973 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:20:22.192986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212802EBEB0>]}
[0m18:20:24.650394 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m18:20:24.700042 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:20:25.026466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128365CA90>]}
[0m18:20:25.048715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128365CA90>]}
[0m18:20:25.050872 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:20:25.054014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021283785270>]}
[0m18:20:25.059529 [info ] [MainThread]: 
[0m18:20:25.063526 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:20:25.068510 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:20:25.117948 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:20:25.119949 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:20:25.122950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:25.312715 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:25.318774 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:20:25.327859 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:20:25.372543 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:20:25.375091 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:20:25.378640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:25.639783 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:25.648627 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:20:25.651632 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:20:25.662919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212802F30A0>]}
[0m18:20:25.666542 [debug] [MainThread]: On master: COMMIT
[0m18:20:25.669499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:25.673158 [info ] [MainThread]: 
[0m18:20:25.699227 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m18:20:25.702757 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.toto ....................................... [RUN]
[0m18:20:25.709432 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m18:20:25.712446 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m18:20:25.727986 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m18:20:25.734529 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 18:20:25.714431 => 18:20:25.733531
[0m18:20:25.737724 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m18:20:25.922402 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m18:20:25.935113 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:20:25.938956 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:20:25.942546 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:20:28.917709 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m18:20:28.970178 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:20:28.975657 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m18:20:29.403830 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:29.424553 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:20:29.428294 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m18:20:29.719511 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:29.755815 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m18:20:29.758358 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m18:20:30.247072 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:30.398279 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 18:20:25.740726 => 18:20:30.396690
[0m18:20:30.403633 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m18:20:30.408881 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m18:20:30.417351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128370AF50>]}
[0m18:20:30.422898 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 4.71s]
[0m18:20:30.433727 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m18:20:30.438413 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:20:30.444295 [info ] [Thread-1 (]: 2 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:20:30.450934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m18:20:30.456680 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:20:30.497875 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:20:30.507385 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:20:30.469882 => 18:20:30.505162
[0m18:20:30.511992 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:20:30.544186 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:20:30.560997 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:20:30.563546 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:20:30.565321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:34.315197 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m18:20:34.333593 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:20:34.337124 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:20:34.696596 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:34.718187 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:20:34.721706 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:20:35.109820 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:35.134400 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:20:35.138965 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:20:35.618432 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:20:35.631834 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:20:30.513595 => 18:20:35.630824
[0m18:20:35.636741 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:20:35.641394 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:20:35.646392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8030127d-c029-4ef1-97ae-12f6ae3a0ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212838BD9C0>]}
[0m18:20:35.651644 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 5.20s]
[0m18:20:35.659231 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:20:35.669443 [debug] [MainThread]: On master: COMMIT
[0m18:20:35.673552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:35.677579 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:20:35.680583 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m18:20:35.683581 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m18:20:35.686699 [info ] [MainThread]: 
[0m18:20:35.690078 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.62 seconds (10.62s).
[0m18:20:35.697839 [debug] [MainThread]: Command end result
[0m18:20:35.738415 [info ] [MainThread]: 
[0m18:20:35.742414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:35.746429 [info ] [MainThread]: 
[0m18:20:35.749741 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:20:35.754949 [debug] [MainThread]: Command `dbt run` succeeded at 18:20:35.753927 after 14.42 seconds
[0m18:20:35.758479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021280A2B5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212802F4E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212836F0A60>]}
[0m18:20:35.760472 [debug] [MainThread]: Flushing usage events
[0m11:17:34.114074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F61A75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A12260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A11F90>]}


============================== 11:17:34.118803 | 92d7c5c4-479a-44cb-9232-e21299f98d8b ==============================
[0m11:17:34.118803 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:17:34.120663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:17:34.296618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A12200>]}
[0m11:17:34.307751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F5A494E0>]}
[0m11:17:34.330476 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:17:34.349243 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:17:34.349964 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:17:34.350986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8D1E110>]}
[0m11:17:35.741741 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m11:17:35.752793 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m11:17:35.757819 [debug] [MainThread]: 1699: static parser successfully parsed silver\weather.sql
[0m11:17:35.859944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A11FF0>]}
[0m11:17:35.873295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8A10EB0>]}
[0m11:17:35.873295 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:17:35.877296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F5A21990>]}
[0m11:17:35.879297 [info ] [MainThread]: 
[0m11:17:35.881297 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:17:35.886476 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:17:35.903995 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:17:35.904995 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:17:35.908999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:36.614126 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:17:36.615127 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:17:36.619124 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m11:17:36.630377 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m11:17:36.631156 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m11:17:36.632155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:36.954128 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:36.956153 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m11:17:36.957129 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m11:17:36.959128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8EFBF70>]}
[0m11:17:36.960127 [debug] [MainThread]: On master: COMMIT
[0m11:17:36.961126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:17:36.962128 [info ] [MainThread]: 
[0m11:17:36.972162 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m11:17:36.973130 [info ] [Thread-1 (]: 1 of 3 START sql table model bronze.toto ....................................... [RUN]
[0m11:17:36.974128 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m11:17:36.976128 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m11:17:36.979129 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m11:17:36.980127 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 11:17:36.976128 => 11:17:36.980127
[0m11:17:36.981129 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m11:17:37.019289 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m11:17:37.023778 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:17:37.025789 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:17:37.027787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:17:39.232269 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m11:17:39.239269 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:17:39.240270 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m11:17:39.342544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:39.346541 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:17:39.346541 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m11:17:39.434335 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:39.443280 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:17:39.444279 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m11:17:39.622862 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:39.639379 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 11:17:36.981129 => 11:17:39.638397
[0m11:17:39.640380 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m11:17:39.640380 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m11:17:39.641380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8E80D60>]}
[0m11:17:39.643378 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 2.67s]
[0m11:17:39.645379 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m11:17:39.645379 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m11:17:39.646378 [info ] [Thread-1 (]: 2 of 3 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m11:17:39.648379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m11:17:39.648379 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m11:17:39.651381 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m11:17:39.652380 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 11:17:39.648379 => 11:17:39.652380
[0m11:17:39.652380 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m11:17:39.657380 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m11:17:39.659379 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:17:39.659379 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:17:39.660380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:40.574073 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:17:40.577899 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:17:40.577899 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:17:40.681332 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:40.684238 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:17:40.684238 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m11:17:40.795453 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:40.798542 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:17:40.798542 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:17:40.951215 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:40.954216 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 11:17:39.653379 => 11:17:40.953216
[0m11:17:40.954629 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m11:17:40.955215 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m11:17:40.957213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F5A45750>]}
[0m11:17:40.958214 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 1.31s]
[0m11:17:40.962216 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m11:17:40.963214 [debug] [Thread-1 (]: Began running node model.projet_dbt.weather
[0m11:17:40.963214 [info ] [Thread-1 (]: 3 of 3 START sql table model bronze.weather .................................... [RUN]
[0m11:17:40.965212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weather)
[0m11:17:40.966214 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weather
[0m11:17:40.969730 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weather"
[0m11:17:40.972732 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weather (compile): 11:17:40.966214 => 11:17:40.971732
[0m11:17:40.973734 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weather
[0m11:17:40.980640 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weather"
[0m11:17:40.980640 [debug] [Thread-1 (]: On model.projet_dbt.weather: drop table if exists "lakehouse"."bronze"."weather__dbt_tmp"
[0m11:17:40.981638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:41.099053 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:41.100053 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weather"
[0m11:17:41.106478 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weather"
[0m11:17:41.107480 [debug] [Thread-1 (]: On model.projet_dbt.weather: create table lakehouse.bronze.weather__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:17:41.545470 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:17:41.548889 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weather"
[0m11:17:41.548889 [debug] [Thread-1 (]: On model.projet_dbt.weather: alter table "lakehouse"."bronze"."weather" rename to lakehouse.bronze.weather__dbt_backup
[0m11:17:41.576373 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230601_181643_00178_4r63g
[0m11:17:41.577576 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weather", query_id=20230601_181643_00178_4r63g)
[0m11:17:41.578487 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weather (execute): 11:17:40.974630 => 11:17:41.578487
[0m11:17:41.578487 [debug] [Thread-1 (]: On model.projet_dbt.weather: ROLLBACK
[0m11:17:41.579490 [debug] [Thread-1 (]: On model.projet_dbt.weather: Close
[0m11:17:41.677219 [debug] [Thread-1 (]: Database Error in model weather (models\silver\weather.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weather", query_id=20230601_181643_00178_4r63g)
  compiled Code at target\run\projet_dbt\models\silver\weather.sql
[0m11:17:41.678244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d7c5c4-479a-44cb-9232-e21299f98d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F9141390>]}
[0m11:17:41.679225 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model bronze.weather ........................... [[31mERROR[0m in 0.71s]
[0m11:17:41.680224 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weather
[0m11:17:41.682225 [debug] [MainThread]: On master: COMMIT
[0m11:17:41.682225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:41.682225 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m11:17:41.683225 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m11:17:41.683225 [debug] [MainThread]: Connection 'model.projet_dbt.weather' was properly closed.
[0m11:17:41.684224 [info ] [MainThread]: 
[0m11:17:41.687222 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m11:17:41.689224 [debug] [MainThread]: Command end result
[0m11:17:41.697224 [info ] [MainThread]: 
[0m11:17:41.698225 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:17:41.701222 [info ] [MainThread]: 
[0m11:17:41.702224 [error] [MainThread]: [33mDatabase Error in model weather (models\silver\weather.sql)[0m
[0m11:17:41.704223 [error] [MainThread]:   TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weather", query_id=20230601_181643_00178_4r63g)
[0m11:17:41.706224 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\silver\weather.sql
[0m11:17:41.708224 [info ] [MainThread]: 
[0m11:17:41.709224 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:17:41.709224 [debug] [MainThread]: Command `dbt run` failed at 11:17:41.709224 after 7.76 seconds
[0m11:17:41.710224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F61A75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8EC2F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216F8DECC70>]}
[0m11:17:41.710224 [debug] [MainThread]: Flushing usage events
[0m11:19:17.016554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C7B75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06E200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06DF30>]}


============================== 11:19:17.020562 | 2cef82d8-414a-425b-96cb-02d511671936 ==============================
[0m11:19:17.020562 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:19:17.020562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:19:17.146713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06E1A0>]}
[0m11:19:17.157713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C065660>]}
[0m11:19:17.168229 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:19:17.193228 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:19:17.194229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06E170>]}
[0m11:19:17.718612 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m11:19:17.727901 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m11:19:17.730909 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m11:19:17.830071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06DF90>]}
[0m11:19:17.835071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06D7E0>]}
[0m11:19:17.835071 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:19:17.836077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F06D840>]}
[0m11:19:17.837011 [info ] [MainThread]: 
[0m11:19:17.838071 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:19:17.839975 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:19:17.849076 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:19:17.851079 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:19:17.851079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:17.967361 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:17.968367 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:19:17.971369 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m11:19:17.973074 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m11:19:17.973074 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m11:19:17.973074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:18.077288 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:18.078286 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m11:19:18.079787 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m11:19:18.082300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F4913F0>]}
[0m11:19:18.082300 [debug] [MainThread]: On master: COMMIT
[0m11:19:18.082300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:19:18.084818 [info ] [MainThread]: 
[0m11:19:18.089865 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m11:19:18.090892 [info ] [Thread-1 (]: 1 of 3 START sql table model bronze.toto ....................................... [RUN]
[0m11:19:18.091707 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m11:19:18.091707 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m11:19:18.094747 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m11:19:18.096728 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 11:19:18.092756 => 11:19:18.096728
[0m11:19:18.096728 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m11:19:18.127258 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m11:19:18.130238 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:19:18.130238 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:19:18.131239 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:19:18.934017 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:19:18.941024 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:19:18.941024 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m11:19:18.996281 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:19.000284 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:19:19.000284 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m11:19:19.113525 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:19.120525 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:19:19.120525 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m11:19:19.246981 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:19.262580 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 11:19:18.097729 => 11:19:19.262580
[0m11:19:19.262580 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m11:19:19.263546 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m11:19:19.264547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F4ECD30>]}
[0m11:19:19.265546 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 1.17s]
[0m11:19:19.266546 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m11:19:19.267548 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m11:19:19.267548 [info ] [Thread-1 (]: 2 of 3 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m11:19:19.268547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m11:19:19.269547 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m11:19:19.271571 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m11:19:19.273581 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 11:19:19.269547 => 11:19:19.273581
[0m11:19:19.273581 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m11:19:19.277547 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m11:19:19.279547 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:19:19.279547 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:19:19.280547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:19.904247 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:19:19.908246 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:19:19.909247 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:19:19.966300 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:19.970306 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:19:19.970306 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m11:19:20.027938 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.031192 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:19:20.032174 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:19:20.128962 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.131963 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 11:19:19.274552 => 11:19:20.131963
[0m11:19:20.131963 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m11:19:20.132961 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m11:19:20.133962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F7069B0>]}
[0m11:19:20.133962 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 0.87s]
[0m11:19:20.136476 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m11:19:20.137477 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m11:19:20.137477 [info ] [Thread-1 (]: 3 of 3 START sql table model bronze.weathersil ................................. [RUN]
[0m11:19:20.138476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m11:19:20.139482 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m11:19:20.142479 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m11:19:20.143479 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 11:19:20.139482 => 11:19:20.143479
[0m11:19:20.144476 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m11:19:20.147479 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m11:19:20.151475 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:19:20.151475 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.bronze.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:19:20.152478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:20.573613 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.576638 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:19:20.576638 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.bronze.weathersil__dbt_tmp rename to lakehouse.bronze.weathersil
[0m11:19:20.647493 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.650515 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:19:20.651493 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.bronze.weathersil__dbt_backup
[0m11:19:20.667036 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:19:20.670088 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 11:19:20.144476 => 11:19:20.670088
[0m11:19:20.670088 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m11:19:20.671040 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m11:19:20.672040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cef82d8-414a-425b-96cb-02d511671936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F4ECA00>]}
[0m11:19:20.672611 [info ] [Thread-1 (]: 3 of 3 OK created sql table model bronze.weathersil ............................ [[32mSUCCESS[0m in 0.53s]
[0m11:19:20.673820 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m11:19:20.675828 [debug] [MainThread]: On master: COMMIT
[0m11:19:20.676829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:20.676829 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m11:19:20.676829 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m11:19:20.677829 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m11:19:20.677829 [info ] [MainThread]: 
[0m11:19:20.678838 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m11:19:20.679829 [debug] [MainThread]: Command end result
[0m11:19:20.686658 [info ] [MainThread]: 
[0m11:19:20.687165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:19:20.688173 [info ] [MainThread]: 
[0m11:19:20.688173 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:19:20.689184 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:20.689184 after 3.74 seconds
[0m11:19:20.690174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C7B75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CA1D1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8F4FD180>]}
[0m11:19:20.691173 [debug] [MainThread]: Flushing usage events
[0m11:21:41.793252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2BD075E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56E170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56DF60>]}


============================== 11:21:41.796160 | 092108e8-a90e-4739-9046-cc918204b573 ==============================
[0m11:21:41.796160 [info ] [MainThread]: Running with dbt=1.5.0
[0m11:21:41.797176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:21:41.919228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56E230>]}
[0m11:21:41.930246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B5BB250>]}
[0m11:21:41.942681 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m11:21:41.967536 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:21:41.968516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56E1A0>]}
[0m11:21:42.525354 [debug] [MainThread]: 1699: static parser successfully parsed bronze\toto.sql
[0m11:21:42.534356 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m11:21:42.538355 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m11:21:42.642026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56DEA0>]}
[0m11:21:42.652116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E56D5D0>]}
[0m11:21:42.653122 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:21:42.655128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2B583730>]}
[0m11:21:42.657134 [info ] [MainThread]: 
[0m11:21:42.658123 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:21:42.659633 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:21:42.671843 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:21:42.672843 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:21:42.673843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:42.763914 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:42.764924 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:21:42.769333 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:21:42.770062 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:21:42.770062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:42.822196 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:42.823821 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:21:42.826266 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m11:21:42.836163 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m11:21:42.837190 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m11:21:42.837190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:42.926259 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:42.928300 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m11:21:42.928300 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m11:21:42.930338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m11:21:42.934146 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m11:21:42.935240 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m11:21:42.935240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:43.015663 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:43.017268 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m11:21:43.018228 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m11:21:43.020747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2EA6BF40>]}
[0m11:21:43.021774 [debug] [MainThread]: On master: COMMIT
[0m11:21:43.022895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:43.024333 [info ] [MainThread]: 
[0m11:21:43.030753 [debug] [Thread-1 (]: Began running node model.projet_dbt.toto
[0m11:21:43.030753 [info ] [Thread-1 (]: 1 of 3 START sql table model bronze.toto ....................................... [RUN]
[0m11:21:43.032763 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.toto'
[0m11:21:43.032763 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.toto
[0m11:21:43.037761 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.toto"
[0m11:21:43.040275 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (compile): 11:21:43.034202 => 11:21:43.040275
[0m11:21:43.041276 [debug] [Thread-1 (]: Began executing node model.projet_dbt.toto
[0m11:21:43.074413 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.toto"
[0m11:21:43.076850 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:21:43.077860 [debug] [Thread-1 (]: On model.projet_dbt.toto: create table lakehouse.bronze.toto__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:21:43.077860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:21:43.778828 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:21:43.786055 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:21:43.787036 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table "lakehouse"."bronze"."toto" rename to lakehouse.bronze.toto__dbt_backup
[0m11:21:43.838666 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:43.841836 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:21:43.842905 [debug] [Thread-1 (]: On model.projet_dbt.toto: alter table lakehouse.bronze.toto__dbt_tmp rename to lakehouse.bronze.toto
[0m11:21:43.952320 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:43.958833 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.toto"
[0m11:21:43.958833 [debug] [Thread-1 (]: On model.projet_dbt.toto: drop table if exists lakehouse.bronze.toto__dbt_backup
[0m11:21:44.077808 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:44.100378 [debug] [Thread-1 (]: Timing info for model.projet_dbt.toto (execute): 11:21:43.042275 => 11:21:44.099377
[0m11:21:44.100378 [debug] [Thread-1 (]: On model.projet_dbt.toto: ROLLBACK
[0m11:21:44.100378 [debug] [Thread-1 (]: On model.projet_dbt.toto: Close
[0m11:21:44.102376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2EC45D20>]}
[0m11:21:44.103195 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bronze.toto .................................. [[32mSUCCESS[0m in 1.07s]
[0m11:21:44.104304 [debug] [Thread-1 (]: Finished running node model.projet_dbt.toto
[0m11:21:44.104573 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m11:21:44.105589 [info ] [Thread-1 (]: 2 of 3 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m11:21:44.106594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.toto, now model.projet_dbt.weatheronepoint)
[0m11:21:44.107325 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m11:21:44.110247 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m11:21:44.111760 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 11:21:44.107831 => 11:21:44.110753
[0m11:21:44.111760 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m11:21:44.115760 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m11:21:44.117760 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:21:44.118760 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:21:44.118760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:44.707496 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:21:44.710512 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:21:44.710512 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:21:44.822803 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:44.825837 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:21:44.826897 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m11:21:44.875188 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:44.878644 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:21:44.878644 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:21:44.990210 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:44.992209 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 11:21:44.112760 => 11:21:44.992209
[0m11:21:44.993208 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m11:21:44.993208 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m11:21:44.994208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E95AA70>]}
[0m11:21:44.995209 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 0.89s]
[0m11:21:44.996207 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m11:21:44.997209 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m11:21:44.998206 [info ] [Thread-1 (]: 3 of 3 START sql table model silver.weathersil ................................. [RUN]
[0m11:21:44.999207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m11:21:45.000715 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m11:21:45.003740 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m11:21:45.006723 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 11:21:45.000715 => 11:21:45.005721
[0m11:21:45.006723 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m11:21:45.009721 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m11:21:45.012738 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:21:45.012738 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:21:45.013760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:45.403355 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:45.407397 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:21:45.407397 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m11:21:45.466189 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:45.469739 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:21:45.469739 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m11:21:45.487442 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:21:45.489561 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 11:21:45.006723 => 11:21:45.489561
[0m11:21:45.490299 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m11:21:45.490299 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m11:21:45.491377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '092108e8-a90e-4739-9046-cc918204b573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2E958100>]}
[0m11:21:45.493053 [info ] [Thread-1 (]: 3 of 3 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 0.49s]
[0m11:21:45.494419 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m11:21:45.494419 [debug] [MainThread]: On master: COMMIT
[0m11:21:45.496767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:45.497931 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m11:21:45.497931 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m11:21:45.497931 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m11:21:45.499169 [info ] [MainThread]: 
[0m11:21:45.499169 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m11:21:45.499169 [debug] [MainThread]: Command end result
[0m11:21:45.510473 [info ] [MainThread]: 
[0m11:21:45.510473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:21:45.511479 [info ] [MainThread]: 
[0m11:21:45.512472 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:21:45.512472 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:45.512472 after 3.79 seconds
[0m11:21:45.514473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2BD075E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2BF6E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2EA6BF40>]}
[0m11:21:45.514473 [debug] [MainThread]: Flushing usage events
[0m17:58:53.743662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF65475E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF8D82110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF8D81F00>]}


============================== 17:58:53.752886 | 7291daa2-9844-4196-a8b4-6c8896657a12 ==============================
[0m17:58:53.752886 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:58:53.754009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:58:53.756503 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'projet_dbt' does not have a target named 'dev'. The valid target names for this profile are:
   - bronze
   - silver
[0m17:58:53.764521 [debug] [MainThread]: Command `dbt run` failed at 17:58:53.764521 after 0.25 seconds
[0m17:58:53.766214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF65475E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF8D83F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029BF8D83F70>]}
[0m17:58:53.766214 [debug] [MainThread]: Flushing usage events
[0m18:00:25.106998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0B775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E33FE1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E33FDF00>]}


============================== 18:00:25.109903 | 94d1e87e-4cdc-472b-b0d5-69bb1f7c146b ==============================
[0m18:00:25.109903 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:00:25.115417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:00:25.360463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E33FE170>]}
[0m18:00:25.376659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0429EA0>]}
[0m18:00:25.408902 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:00:25.436166 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:00:25.439198 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:00:25.440088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E33FE140>]}
[0m18:00:27.112563 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:00:27.129349 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:00:27.268036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projet_dbt.dev
[0m18:00:27.275828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E38A5630>]}
[0m18:00:27.356820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E38A4F70>]}
[0m18:00:27.356820 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:00:27.361649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E03F1810>]}
[0m18:00:27.366432 [info ] [MainThread]: 
[0m18:00:27.369070 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:00:27.376384 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:00:27.389577 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:00:27.389577 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:00:27.389577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:28.016798 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:00:28.018007 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:00:28.026236 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:00:28.026236 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:00:28.026236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:28.124353 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:28.124353 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:00:28.129523 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:00:28.150201 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:00:28.152224 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:00:28.152224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:28.497660 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:28.497660 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:00:28.497660 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:00:28.497660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m18:00:28.508098 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:00:28.508098 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:00:28.514226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:28.668559 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:28.668559 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:00:28.668559 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:00:28.674604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E37FE560>]}
[0m18:00:28.675615 [debug] [MainThread]: On master: COMMIT
[0m18:00:28.675615 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:28.675615 [info ] [MainThread]: 
[0m18:00:28.688312 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:00:28.691838 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:00:28.691838 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:00:28.691838 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:00:28.691838 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:00:28.700114 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:00:28.691838 => 18:00:28.700114
[0m18:00:28.700114 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:00:28.741804 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:00:28.749044 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:00:28.749044 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:00:28.749044 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:30.848874 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:00:30.856883 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:00:30.856883 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:00:30.979887 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:30.989411 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:00:30.994920 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:00:31.085003 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:31.093065 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:00:31.093065 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:00:31.378006 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:31.410778 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:00:28.700114 => 18:00:31.410778
[0m18:00:31.410778 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:00:31.410778 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:00:31.410778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E3A87EB0>]}
[0m18:00:31.410778 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.72s]
[0m18:00:31.418589 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:00:31.418589 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:00:31.418589 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:00:31.418589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:00:31.418589 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:00:31.426973 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:00:31.426973 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:00:31.418589 => 18:00:31.426973
[0m18:00:31.426973 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:00:31.434996 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:00:31.443178 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:00:31.444530 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:00:31.444530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:32.216512 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:00:32.222078 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:00:32.222078 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:00:32.341259 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:32.344777 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:00:32.344777 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:00:32.455766 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:32.460779 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:00:32.465335 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:00:32.625424 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:00:32.631961 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:00:31.426973 => 18:00:32.631961
[0m18:00:32.631961 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:00:32.631961 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:00:32.636815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d1e87e-4cdc-472b-b0d5-69bb1f7c146b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0411F30>]}
[0m18:00:32.637627 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.22s]
[0m18:00:32.640388 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:00:32.642852 [debug] [MainThread]: On master: COMMIT
[0m18:00:32.642852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:32.642852 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:00:32.642852 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m18:00:32.642852 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:00:32.642852 [info ] [MainThread]: 
[0m18:00:32.648260 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m18:00:32.648260 [debug] [MainThread]: Command end result
[0m18:00:32.661564 [info ] [MainThread]: 
[0m18:00:32.661564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:32.661564 [info ] [MainThread]: 
[0m18:00:32.665075 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:00:32.665607 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:32.665607 after 7.62 seconds
[0m18:00:32.665607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0B775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E3A87EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E0DDC310>]}
[0m18:00:32.668176 [debug] [MainThread]: Flushing usage events
[0m18:01:09.220590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD89E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C69E260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C69DF90>]}


============================== 18:01:09.222328 | 8b7e3f59-da65-4278-bb62-a02ff6c78838 ==============================
[0m18:01:09.222328 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:01:09.222328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:01:09.490350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C69E200>]}
[0m18:01:09.517642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD896D54E0>]}
[0m18:01:09.535046 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:01:09.562392 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:01:09.562392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C9A60B0>]}
[0m18:01:10.488515 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:01:10.504395 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:01:10.683573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C9A53C0>]}
[0m18:01:10.692985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8C9A4F40>]}
[0m18:01:10.695936 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:01:10.695936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8969FBB0>]}
[0m18:01:10.702727 [info ] [MainThread]: 
[0m18:01:10.719036 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:01:10.726571 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:01:10.742553 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:01:10.749564 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:01:10.750163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:10.881693 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:10.883232 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:01:10.891169 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:01:10.891169 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:01:10.891169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:10.975186 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:10.978198 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:01:10.980133 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:01:10.987628 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:01:10.987628 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:01:10.994651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:11.098909 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:11.101472 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:01:11.101472 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:01:11.101472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m18:01:11.111925 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:01:11.111925 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:01:11.116943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:11.252147 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:11.257425 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:01:11.257425 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:01:11.261535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CC7F670>]}
[0m18:01:11.261535 [debug] [MainThread]: On master: COMMIT
[0m18:01:11.264956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:11.264956 [info ] [MainThread]: 
[0m18:01:11.276224 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:01:11.277468 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:01:11.280109 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:01:11.281130 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:01:11.285051 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:01:11.289620 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:01:11.281130 => 18:01:11.289620
[0m18:01:11.289620 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:01:11.342877 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:01:11.345891 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:11.345891 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:01:11.352567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:12.479563 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:01:12.490531 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:12.490531 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:01:12.668444 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:12.673657 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:12.673657 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:01:12.771162 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:12.778804 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:12.778804 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:01:12.919083 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:12.943909 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:01:11.289620 => 18:01:12.943909
[0m18:01:12.943909 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:01:12.943909 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:01:12.951920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CD1FE20>]}
[0m18:01:12.951920 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 1.67s]
[0m18:01:12.951920 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:01:12.951920 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:01:12.951920 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:01:12.951920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:01:12.951920 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:01:12.959918 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:01:12.959918 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:01:12.951920 => 18:01:12.959918
[0m18:01:12.959918 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:01:12.967920 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:01:12.967920 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:12.967920 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:01:12.967920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:13.455262 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:13.462101 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:13.462101 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:01:13.532154 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:13.534262 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:13.539271 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:01:13.644761 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:13.651751 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:13.651751 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:01:13.814190 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:13.820208 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:01:12.959918 => 18:01:13.820208
[0m18:01:13.820208 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:01:13.820208 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:01:13.825728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7e3f59-da65-4278-bb62-a02ff6c78838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CD48160>]}
[0m18:01:13.826842 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 0.87s]
[0m18:01:13.829880 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:01:13.833868 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.835204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:13.835204 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:01:13.836219 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m18:01:13.836219 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:01:13.839730 [info ] [MainThread]: 
[0m18:01:13.840918 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m18:01:13.847645 [debug] [MainThread]: Command end result
[0m18:01:13.860942 [info ] [MainThread]: 
[0m18:01:13.860942 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:13.860942 [info ] [MainThread]: 
[0m18:01:13.860942 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:01:13.860942 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:13.860942 after 4.68 seconds
[0m18:01:13.860942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD89E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CD1FE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8CA5B9D0>]}
[0m18:01:13.868954 [debug] [MainThread]: Flushing usage events
[0m18:06:11.914970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234D5375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FDD2200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FDD1F30>]}


============================== 18:06:11.921439 | fc33b8ce-b1a4-4373-81ec-df38a9e9a11c ==============================
[0m18:06:11.921439 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:06:11.921439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:06:12.110224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FDD21A0>]}
[0m18:06:12.134263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234CDE79A0>]}
[0m18:06:12.151222 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m18:06:12.256594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:12.256594 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:12.264704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223502DCDC0>]}
[0m18:06:12.273002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223502A1510>]}
[0m18:06:12.273002 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:06:12.273002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223502A15A0>]}
[0m18:06:12.273002 [info ] [MainThread]: 
[0m18:06:12.273002 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:06:12.281013 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m18:06:12.297855 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:06:12.301141 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:06:12.301141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:12.446086 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:12.446086 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:06:12.451098 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:06:12.453643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m18:06:12.453643 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:06:12.460971 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:06:12.460971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:12.562952 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:12.565011 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:06:12.565011 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:06:12.568317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc33b8ce-b1a4-4373-81ec-df38a9e9a11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234CDE0BE0>]}
[0m18:06:12.571064 [debug] [MainThread]: On master: COMMIT
[0m18:06:12.571064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:12.571064 [info ] [MainThread]: 
[0m18:06:12.578707 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m18:06:12.582548 [info ] [Thread-1 (]: 1 of 3 START test not_null_weatheronepoint__airbyte_ab_id ...................... [RUN]
[0m18:06:12.584558 [debug] [Thread-1 (]: Acquiring new trino connection 'test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492'
[0m18:06:12.588071 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m18:06:12.605070 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m18:06:12.609691 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492 (compile): 18:06:12.588071 => 18:06:12.609691
[0m18:06:12.609691 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m18:06:12.633715 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m18:06:12.641736 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492"
[0m18:06:12.642456 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_ab_id
from lakehouse.bronze.weatheronepoint
where _airbyte_ab_id is null



      
    ) dbt_internal_test
[0m18:06:12.642456 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:12.763552 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:12.765595 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492 (execute): 18:06:12.612514 => 18:06:12.765595
[0m18:06:12.767614 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: ROLLBACK
[0m18:06:12.767614 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492: Close
[0m18:06:12.770604 [info ] [Thread-1 (]: 1 of 3 PASS not_null_weatheronepoint__airbyte_ab_id ............................ [[32mPASS[0m in 0.19s]
[0m18:06:12.771611 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492
[0m18:06:12.771611 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m18:06:12.771611 [info ] [Thread-1 (]: 2 of 3 START test not_null_weatheronepoint__airbyte_data ....................... [RUN]
[0m18:06:12.775618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492, now test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01)
[0m18:06:12.775618 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m18:06:12.781124 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m18:06:12.781124 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01 (compile): 18:06:12.775618 => 18:06:12.781124
[0m18:06:12.788008 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m18:06:12.788008 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m18:06:12.797561 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01"
[0m18:06:12.802030 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_data
from lakehouse.bronze.weatheronepoint
where _airbyte_data is null



      
    ) dbt_internal_test
[0m18:06:12.802030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:12.931027 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:12.934987 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01 (execute): 18:06:12.788008 => 18:06:12.934284
[0m18:06:12.934987 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: ROLLBACK
[0m18:06:12.936497 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01: Close
[0m18:06:12.938993 [info ] [Thread-1 (]: 2 of 3 PASS not_null_weatheronepoint__airbyte_data ............................. [[32mPASS[0m in 0.17s]
[0m18:06:12.941168 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01
[0m18:06:12.943428 [debug] [Thread-1 (]: Began running node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m18:06:12.945111 [info ] [Thread-1 (]: 3 of 3 START test not_null_weatheronepoint__airbyte_emitted_at ................. [RUN]
[0m18:06:12.945111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01, now test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31)
[0m18:06:12.948356 [debug] [Thread-1 (]: Began compiling node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m18:06:12.955049 [debug] [Thread-1 (]: Writing injected SQL for node "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m18:06:12.959502 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31 (compile): 18:06:12.948356 => 18:06:12.955049
[0m18:06:12.960762 [debug] [Thread-1 (]: Began executing node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m18:06:12.960762 [debug] [Thread-1 (]: Writing runtime sql for node "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m18:06:12.971102 [debug] [Thread-1 (]: Using trino connection "test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31"
[0m18:06:12.972253 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select _airbyte_emitted_at
from lakehouse.bronze.weatheronepoint
where _airbyte_emitted_at is null



      
    ) dbt_internal_test
[0m18:06:12.973368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:13.078820 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:13.082855 [debug] [Thread-1 (]: Timing info for test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31 (execute): 18:06:12.960762 => 18:06:13.082855
[0m18:06:13.082855 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: ROLLBACK
[0m18:06:13.085366 [debug] [Thread-1 (]: On test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31: Close
[0m18:06:13.085366 [info ] [Thread-1 (]: 3 of 3 PASS not_null_weatheronepoint__airbyte_emitted_at ....................... [[32mPASS[0m in 0.14s]
[0m18:06:13.088290 [debug] [Thread-1 (]: Finished running node test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31
[0m18:06:13.091363 [debug] [MainThread]: On master: COMMIT
[0m18:06:13.091363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:13.091363 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m18:06:13.091363 [debug] [MainThread]: Connection 'test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31' was properly closed.
[0m18:06:13.091363 [info ] [MainThread]: 
[0m18:06:13.091363 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m18:06:13.097558 [debug] [MainThread]: Command end result
[0m18:06:13.107880 [info ] [MainThread]: 
[0m18:06:13.107880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:13.107880 [info ] [MainThread]: 
[0m18:06:13.107880 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:06:13.107880 [debug] [MainThread]: Command `dbt test` succeeded at 18:06:13.107880 after 1.24 seconds
[0m18:06:13.107880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234D5375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234D79D1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FDD21A0>]}
[0m18:06:13.116214 [debug] [MainThread]: Flushing usage events


============================== 2023-06-05 08:09:12.606917 | fb977816-a54e-4f3e-be97-a3ad856feaed ==============================
[0m08:09:12.606917 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:09:12.612494 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m08:09:12.613591 [debug] [MainThread]: Tracking: tracking
[0m08:09:12.663403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F407CE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F407CF940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F407CE260>]}
[0m08:09:13.019441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F407CE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F407CF0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F4080F850>]}
[0m08:09:13.021447 [debug] [MainThread]: Flushing usage events
[0m08:09:13.529731 [error] [MainThread]: Encountered an error:
cannot import name 'ConstraintSupport' from 'dbt.adapters.base.impl' (C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\base\impl.py)
[0m08:09:13.705450 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\main.py", line 136, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\main.py", line 206, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\main.py", line 253, in run_from_args
    results = task.run()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\task\debug.py", line 109, in run
    self.test_configuration()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\task\debug.py", line 281, in test_configuration
    profile_status = self._load_profile()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\task\debug.py", line 252, in _load_profile
    profile: Profile = Profile.render_from_args(self.args, renderer, profile_name)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\config\profile.py", line 428, in render_from_args
    return cls.from_raw_profiles(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\config\profile.py", line 394, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\config\profile.py", line 348, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\config\profile.py", line 181, in _credentials_from_profile
    cls = load_plugin(typename)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\factory.py", line 202, in load_plugin
    return FACTORY.load_plugin(name)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\factory.py", line 57, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\trino\__init__.py", line 8, in <module>
    from dbt.adapters.trino.impl import TrinoAdapter  # isort: split
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\trino\impl.py", line 5, in <module>
    from dbt.adapters.base.impl import AdapterConfig, ConstraintSupport
ImportError: cannot import name 'ConstraintSupport' from 'dbt.adapters.base.impl' (C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\base\impl.py)



============================== 2023-06-05 08:09:58.503342 | 24b12317-3709-4aa4-b8be-4daf9e4e2828 ==============================
[0m08:09:58.503342 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:09:58.505843 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m08:09:58.506819 [debug] [MainThread]: Tracking: tracking
[0m08:09:58.518330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4447EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4447FB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4447F3A0>]}
[0m08:09:58.616238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4447EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4447E530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE4196D990>]}
[0m08:09:58.617243 [debug] [MainThread]: Flushing usage events
[0m08:09:58.994832 [error] [MainThread]: Encountered an error:
cannot import name 'ConstraintSupport' from 'dbt.adapters.base.impl' (C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\base\impl.py)
[0m08:09:58.997829 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\main.py", line 136, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\main.py", line 206, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\main.py", line 253, in run_from_args
    results = task.run()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\task\debug.py", line 109, in run
    self.test_configuration()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\task\debug.py", line 281, in test_configuration
    profile_status = self._load_profile()
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\task\debug.py", line 252, in _load_profile
    profile: Profile = Profile.render_from_args(self.args, renderer, profile_name)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\config\profile.py", line 428, in render_from_args
    return cls.from_raw_profiles(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\config\profile.py", line 394, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\config\profile.py", line 348, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\config\profile.py", line 181, in _credentials_from_profile
    cls = load_plugin(typename)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\factory.py", line 202, in load_plugin
    return FACTORY.load_plugin(name)
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\factory.py", line 57, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\trino\__init__.py", line 8, in <module>
    from dbt.adapters.trino.impl import TrinoAdapter  # isort: split
  File "C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\trino\impl.py", line 5, in <module>
    from dbt.adapters.base.impl import AdapterConfig, ConstraintSupport
ImportError: cannot import name 'ConstraintSupport' from 'dbt.adapters.base.impl' (C:\Users\eho.mbengue\AppData\Local\anaconda3\lib\site-packages\dbt\adapters\base\impl.py)



============================== 2023-06-05 08:52:21.573771 | 6f757b3c-5ad3-480d-b5e1-45c70ca6777d ==============================
[0m08:52:21.573771 [info ] [MainThread]: Running with dbt=1.4.6
[0m08:52:21.573771 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:52:21.573771 [debug] [MainThread]: Tracking: tracking
[0m08:52:21.596917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB53446620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB52796A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB52797910>]}
[0m08:52:21.613940 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m08:52:21.629937 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m08:52:21.630937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f757b3c-5ad3-480d-b5e1-45c70ca6777d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB527949A0>]}
[0m08:52:22.598018 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m08:52:22.613970 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m08:52:22.671233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f757b3c-5ad3-480d-b5e1-45c70ca6777d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB55DF8070>]}
[0m08:52:22.671233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f757b3c-5ad3-480d-b5e1-45c70ca6777d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB52794BB0>]}
[0m08:52:22.671233 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:52:22.671233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f757b3c-5ad3-480d-b5e1-45c70ca6777d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB53446620>]}
[0m08:52:22.671233 [info ] [MainThread]: 
[0m08:52:22.671233 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m08:52:22.671233 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m08:52:22.686240 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m08:52:22.686240 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m08:52:22.686240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:24.406006 [debug] [ThreadPool]: SQL status: SUCCESS in 2 seconds
[0m08:52:24.406006 [debug] [ThreadPool]: On list_lakehouse: Close
[0m08:52:24.406006 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m08:52:24.412025 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m08:52:24.412025 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m08:52:24.412025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:24.555916 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m08:52:24.557434 [debug] [ThreadPool]: On list_lakehouse: Close
[0m08:52:24.557434 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m08:52:24.569492 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m08:52:24.569492 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m08:52:24.569492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:25.421163 [debug] [ThreadPool]: SQL status: SUCCESS in 1 seconds
[0m08:52:25.421163 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m08:52:25.421163 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m08:52:25.421163 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m08:52:25.429169 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m08:52:25.429169 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m08:52:25.429169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:25.676146 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m08:52:25.677144 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m08:52:25.678144 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m08:52:25.679149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f757b3c-5ad3-480d-b5e1-45c70ca6777d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB55C30B20>]}
[0m08:52:25.680147 [debug] [MainThread]: On master: COMMIT
[0m08:52:25.680147 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:52:25.681147 [info ] [MainThread]: 
[0m08:52:25.692173 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m08:52:25.692173 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m08:52:25.693173 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m08:52:25.694171 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m08:52:25.696080 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m08:52:25.698080 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 2023-06-05 08:52:25.694171 => 2023-06-05 08:52:25.698080
[0m08:52:25.698080 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m08:52:25.737306 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m08:52:25.740818 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m08:52:25.740818 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  )
[0m08:52:25.740818 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:52:34.486960 [debug] [Thread-1 (]: SQL status: SUCCESS in 9 seconds
[0m08:52:34.496675 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m08:52:34.496675 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m08:52:34.749456 [debug] [Thread-1 (]: SQL status: SUCCESS in 0 seconds
[0m08:52:34.756978 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m08:52:34.760492 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m08:52:34.997907 [debug] [Thread-1 (]: SQL status: SUCCESS in 0 seconds
[0m08:52:35.010448 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m08:52:35.013968 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m08:52:35.612312 [debug] [Thread-1 (]: SQL status: SUCCESS in 1 seconds
[0m08:52:35.638471 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 2023-06-05 08:52:25.699085 => 2023-06-05 08:52:35.638471
[0m08:52:35.638471 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m08:52:35.638471 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m08:52:35.638471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f757b3c-5ad3-480d-b5e1-45c70ca6777d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB55EABD30>]}
[0m08:52:35.638471 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 9.95s]
[0m08:52:35.644155 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m08:52:35.644155 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m08:52:35.644155 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m08:52:35.644155 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathersil'
[0m08:52:35.644155 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m08:52:35.644155 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m08:52:35.644155 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 2023-06-05 08:52:35.644155 => 2023-06-05 08:52:35.644155
[0m08:52:35.644155 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m08:52:35.657714 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m08:52:35.662821 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m08:52:35.663821 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  )
[0m08:52:35.664822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:37.090013 [debug] [Thread-1 (]: SQL status: SUCCESS in 1 seconds
[0m08:52:37.096545 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m08:52:37.096545 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m08:52:37.360130 [debug] [Thread-1 (]: SQL status: SUCCESS in 0 seconds
[0m08:52:37.372748 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m08:52:37.373277 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m08:52:37.561953 [debug] [Thread-1 (]: SQL status: SUCCESS in 0 seconds
[0m08:52:37.570995 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m08:52:37.570995 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m08:52:37.853190 [debug] [Thread-1 (]: SQL status: SUCCESS in 0 seconds
[0m08:52:37.853190 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 2023-06-05 08:52:35.644155 => 2023-06-05 08:52:37.853190
[0m08:52:37.853190 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m08:52:37.853190 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m08:52:37.853190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f757b3c-5ad3-480d-b5e1-45c70ca6777d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB55F63E80>]}
[0m08:52:37.853190 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.21s]
[0m08:52:37.853190 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m08:52:37.853190 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m08:52:37.853190 [debug] [MainThread]: On master: COMMIT
[0m08:52:37.853190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:37.853190 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m08:52:37.853190 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m08:52:37.853190 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m08:52:37.853190 [info ] [MainThread]: 
[0m08:52:37.868836 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 15.18 seconds (15.18s).
[0m08:52:37.869350 [debug] [MainThread]: Command end result
[0m08:52:37.871373 [info ] [MainThread]: 
[0m08:52:37.871373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:37.871373 [info ] [MainThread]: 
[0m08:52:37.871373 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:52:37.883757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB55EF3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB55EFB8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB55C30A60>]}
[0m08:52:37.883757 [debug] [MainThread]: Flushing usage events


============================== 2023-06-05 09:14:36.290059 | 355c2990-fb80-4c13-bc59-3164b39f1d8f ==============================
[0m09:14:36.290059 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:14:36.290059 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m09:14:36.290059 [debug] [MainThread]: Tracking: tracking
[0m09:14:36.310101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D047E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D047FF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D047E3B0>]}
[0m09:14:36.450282 [debug] [MainThread]: Executing "git --help"
[0m09:14:36.483613 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:14:36.483613 [debug] [MainThread]: STDERR: "b''"
[0m09:14:36.483613 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m09:14:36.483613 [debug] [MainThread]: Using trino connection "debug"
[0m09:14:36.483613 [debug] [MainThread]: On debug: select 1 as id
[0m09:14:36.483613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:14:36.583631 [debug] [MainThread]: SQL status: SUCCESS in 0 seconds
[0m09:14:36.585631 [debug] [MainThread]: On debug: Close
[0m09:14:36.586629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D0792200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1CC374940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1CD8AF220>]}
[0m09:14:36.588066 [debug] [MainThread]: Flushing usage events
[0m09:14:36.974253 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-06-05 09:34:50.251180 | a72dcbce-7cba-49b0-9a70-cfd711d3f3b3 ==============================
[0m09:34:50.251180 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:34:50.251180 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:34:50.251180 [debug] [MainThread]: Tracking: tracking
[0m09:34:50.266893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903ECCCA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903BE34BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903B957430>]}
[0m09:34:50.286164 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:34:50.301263 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:34:50.305973 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:34:50.305973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a72dcbce-7cba-49b0-9a70-cfd711d3f3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903ED21DB0>]}
[0m09:34:52.308911 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m09:34:52.319453 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m09:34:52.326042 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m09:34:52.435953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a72dcbce-7cba-49b0-9a70-cfd711d3f3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903EE51840>]}
[0m09:34:52.447085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a72dcbce-7cba-49b0-9a70-cfd711d3f3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903ED21ED0>]}
[0m09:34:52.447085 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:34:52.448090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a72dcbce-7cba-49b0-9a70-cfd711d3f3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903EEAEFE0>]}
[0m09:34:52.450087 [info ] [MainThread]: 
[0m09:34:52.452706 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:34:52.455722 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:34:52.475930 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:34:52.476943 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m09:34:52.477961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:53.136000 [debug] [ThreadPool]: SQL status: SUCCESS in 1 seconds
[0m09:34:53.136000 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:34:53.136000 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:34:53.145868 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:34:53.145868 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m09:34:53.149918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:53.350833 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m09:34:53.353832 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:34:53.356344 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m09:34:53.362890 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m09:34:53.364406 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m09:34:53.364406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:53.422068 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_093453_00015_d4a3p
[0m09:34:53.426174 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_093453_00015_d4a3p)
[0m09:34:53.426174 [debug] [ThreadPool]: On list_gold: Close
[0m09:34:53.426174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:53.426174 [debug] [MainThread]: Connection 'list_gold' was properly closed.
[0m09:34:53.426174 [info ] [MainThread]: 
[0m09:34:53.426174 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m09:34:53.436069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903BE377F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903EE505E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903EF7C0D0>]}
[0m09:34:53.437173 [debug] [MainThread]: Flushing usage events
[0m09:34:53.911243 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_093453_00015_d4a3p)


============================== 2023-06-05 09:44:28.883842 | 8934b769-0348-4e76-8405-286d6762f693 ==============================
[0m09:44:28.883842 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:44:28.883842 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:44:28.888357 [debug] [MainThread]: Tracking: tracking
[0m09:44:28.898918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB8ED0E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB8ED1900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB8ED20B0>]}
[0m09:44:28.917008 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:44:28.936646 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:44:28.937641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8934b769-0348-4e76-8405-286d6762f693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB5F21E40>]}
[0m09:44:30.603821 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m09:44:30.615233 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m09:44:30.624346 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m09:44:30.717576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8934b769-0348-4e76-8405-286d6762f693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB8F69870>]}
[0m09:44:30.724140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8934b769-0348-4e76-8405-286d6762f693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB8ED2380>]}
[0m09:44:30.724140 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:44:30.724140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8934b769-0348-4e76-8405-286d6762f693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB905F040>]}
[0m09:44:30.724140 [info ] [MainThread]: 
[0m09:44:30.724140 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:44:30.724140 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:44:30.751348 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:44:30.752350 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m09:44:30.754945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:31.577511 [debug] [ThreadPool]: SQL status: SUCCESS in 1 seconds
[0m09:44:31.577511 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:44:31.577511 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m09:44:31.584045 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m09:44:31.584045 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m09:44:31.584045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:31.636606 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_094431_00002_icjsa
[0m09:44:31.636606 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_094431_00002_icjsa)
[0m09:44:31.636606 [debug] [ThreadPool]: On list_gold: Close
[0m09:44:31.636606 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:44:31.646296 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:44:31.651000 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m09:44:31.651000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:31.877870 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m09:44:31.878918 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:44:31.878918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:31.883941 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m09:44:31.883941 [info ] [MainThread]: 
[0m09:44:31.887554 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m09:44:31.890347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB8F68430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB9134790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB9134220>]}
[0m09:44:31.891867 [debug] [MainThread]: Flushing usage events
[0m09:44:32.343989 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_094431_00002_icjsa)


============================== 2023-06-05 09:47:11.963524 | df9a0b5e-ab20-4eb7-bab0-2c9c5fab6f05 ==============================
[0m09:47:11.963524 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:47:11.963524 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:47:11.972618 [debug] [MainThread]: Tracking: tracking
[0m09:47:11.983504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF4A7CA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF1B74BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF1695AB0>]}
[0m09:47:12.004293 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:47:12.026440 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:47:12.027424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df9a0b5e-ab20-4eb7-bab0-2c9c5fab6f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF4AD1DB0>]}
[0m09:47:12.778441 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m09:47:12.787384 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m09:47:12.793425 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m09:47:12.873356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df9a0b5e-ab20-4eb7-bab0-2c9c5fab6f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF4B75840>]}
[0m09:47:12.873356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df9a0b5e-ab20-4eb7-bab0-2c9c5fab6f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF4AD1ED0>]}
[0m09:47:12.881840 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:47:12.881840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9a0b5e-ab20-4eb7-bab0-2c9c5fab6f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF4C5EFE0>]}
[0m09:47:12.883359 [info ] [MainThread]: 
[0m09:47:12.883359 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:47:12.883359 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:47:12.901998 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:47:12.901998 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m09:47:12.903507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:13.057356 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m09:47:13.064917 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:47:13.064917 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:47:13.067928 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:47:13.070960 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m09:47:13.070960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:13.248117 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m09:47:13.250156 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:47:13.250156 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m09:47:13.253670 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m09:47:13.257721 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m09:47:13.257721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:13.294330 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_094713_00006_icjsa
[0m09:47:13.295301 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_094713_00006_icjsa)
[0m09:47:13.296307 [debug] [ThreadPool]: On list_gold: Close
[0m09:47:13.298303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:13.299307 [debug] [MainThread]: Connection 'list_gold' was properly closed.
[0m09:47:13.300300 [info ] [MainThread]: 
[0m09:47:13.301300 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m09:47:13.302300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF4B745E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF4D2C1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF4D2C070>]}
[0m09:47:13.303310 [debug] [MainThread]: Flushing usage events
[0m09:47:13.708365 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_094713_00006_icjsa)


============================== 2023-06-05 09:50:19.466376 | df4edc85-7f43-4018-90ec-720435c4b20a ==============================
[0m09:50:19.466376 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:50:19.466376 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:50:19.466376 [debug] [MainThread]: Tracking: tracking
[0m09:50:19.482992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1FDB03880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1FDB015D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1FDB01F00>]}
[0m09:50:19.512925 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:50:20.608169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:50:20.608169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:50:20.612679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df4edc85-7f43-4018-90ec-720435c4b20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1FDCBC0D0>]}
[0m09:50:20.627734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df4edc85-7f43-4018-90ec-720435c4b20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1FDC814E0>]}
[0m09:50:20.627734 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:50:20.632743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df4edc85-7f43-4018-90ec-720435c4b20a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1FDC83B80>]}
[0m09:50:20.632743 [info ] [MainThread]: 
[0m09:50:20.632743 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:50:20.640261 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:50:20.659845 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:50:20.660845 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m09:50:20.661851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:20.772723 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m09:50:20.780764 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:50:20.782830 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m09:50:20.783891 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m09:50:20.783891 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m09:50:20.786905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:20.803663 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095020_00008_icjsa
[0m09:50:20.803663 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_095020_00008_icjsa)
[0m09:50:20.803663 [debug] [ThreadPool]: On list_gold: Close
[0m09:50:20.803663 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m09:50:20.813029 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m09:50:20.813029 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m09:50:20.814587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:20.904056 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m09:50:20.906026 [debug] [ThreadPool]: On list_lakehouse: Close
[0m09:50:20.908534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:20.908534 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m09:50:20.908534 [info ] [MainThread]: 
[0m09:50:20.909543 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m09:50:20.910542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1FDC83E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1FDD3E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1FDD3E1A0>]}
[0m09:50:20.911543 [debug] [MainThread]: Flushing usage events
[0m09:50:21.320068 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_095020_00008_icjsa)


============================== 2023-06-05 09:52:13.377636 | 04d4c1ff-5cab-4f9e-a021-c022b7e62551 ==============================
[0m09:52:13.377636 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:52:13.381152 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:52:13.381152 [debug] [MainThread]: Tracking: tracking
[0m09:52:13.392222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80D36260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80D35B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80D34D60>]}
[0m09:52:13.405001 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:52:13.412508 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:52:13.412508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04d4c1ff-5cab-4f9e-a021-c022b7e62551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFDDE73A0>]}
[0m09:52:13.913204 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m09:52:13.922688 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m09:52:13.928292 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m09:52:13.975855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04d4c1ff-5cab-4f9e-a021-c022b7e62551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80DDD810>]}
[0m09:52:13.985894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04d4c1ff-5cab-4f9e-a021-c022b7e62551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80D36C20>]}
[0m09:52:13.985894 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:52:13.985894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04d4c1ff-5cab-4f9e-a021-c022b7e62551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80EBEFE0>]}
[0m09:52:13.985894 [info ] [MainThread]: 
[0m09:52:13.985894 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:52:13.991918 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m09:52:14.002285 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m09:52:14.002285 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m09:52:14.002285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:14.031267 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095214_00010_icjsa
[0m09:52:14.031267 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_095214_00010_icjsa)
[0m09:52:14.032297 [debug] [ThreadPool]: On list_gold: Close
[0m09:52:14.033345 [debug] [ThreadPool]: Acquiring new trino connection 'list_dev'
[0m09:52:14.035345 [debug] [ThreadPool]: Using trino connection "list_dev"
[0m09:52:14.036346 [debug] [ThreadPool]: On list_dev: select distinct schema_name
    from dev.INFORMATION_SCHEMA.schemata
[0m09:52:14.036346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:14.066946 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095214_00011_icjsa
[0m09:52:14.066946 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095214_00011_icjsa)
[0m09:52:14.068013 [debug] [ThreadPool]: On list_dev: Close
[0m09:52:14.069072 [debug] [ThreadPool]: Acquiring new trino connection 'list_dev'
[0m09:52:14.069072 [debug] [ThreadPool]: Using trino connection "list_dev"
[0m09:52:14.069072 [debug] [ThreadPool]: On list_dev: select distinct schema_name
    from dev.INFORMATION_SCHEMA.schemata
[0m09:52:14.072582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:14.086223 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095214_00012_icjsa
[0m09:52:14.086223 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095214_00012_icjsa)
[0m09:52:14.086223 [debug] [ThreadPool]: On list_dev: Close
[0m09:52:14.086223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:14.086223 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m09:52:14.086223 [info ] [MainThread]: 
[0m09:52:14.086223 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m09:52:14.092263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80DDC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80F961A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA80F962F0>]}
[0m09:52:14.092263 [debug] [MainThread]: Flushing usage events
[0m09:52:14.486598 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_095214_00010_icjsa)


============================== 2023-06-05 09:58:45.051798 | cd96cdb6-00df-49af-a747-3f8ef36e12d1 ==============================
[0m09:58:45.051798 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:58:45.051798 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:58:45.051798 [debug] [MainThread]: Tracking: tracking
[0m09:58:45.060836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594AB46FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594AB45AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594AB44850>]}
[0m09:58:45.074996 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:58:45.096533 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:58:45.097533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd96cdb6-00df-49af-a747-3f8ef36e12d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594AB458D0>]}
[0m09:58:45.611819 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m09:58:45.620921 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m09:58:45.624254 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m09:58:45.681189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd96cdb6-00df-49af-a747-3f8ef36e12d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594ABE97E0>]}
[0m09:58:45.687082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd96cdb6-00df-49af-a747-3f8ef36e12d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594AB46710>]}
[0m09:58:45.688082 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:58:45.688082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd96cdb6-00df-49af-a747-3f8ef36e12d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594ACCEFB0>]}
[0m09:58:45.689082 [info ] [MainThread]: 
[0m09:58:45.691082 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:58:45.692520 [debug] [ThreadPool]: Acquiring new trino connection 'list_dev'
[0m09:58:45.703232 [debug] [ThreadPool]: Using trino connection "list_dev"
[0m09:58:45.703232 [debug] [ThreadPool]: On list_dev: select distinct schema_name
    from dev.INFORMATION_SCHEMA.schemata
[0m09:58:45.704229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:45.737588 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095845_00013_icjsa
[0m09:58:45.737588 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095845_00013_icjsa)
[0m09:58:45.739578 [debug] [ThreadPool]: On list_dev: Close
[0m09:58:45.742107 [debug] [ThreadPool]: Acquiring new trino connection 'list_dev'
[0m09:58:45.745105 [debug] [ThreadPool]: Using trino connection "list_dev"
[0m09:58:45.745105 [debug] [ThreadPool]: On list_dev: select distinct schema_name
    from dev.INFORMATION_SCHEMA.schemata
[0m09:58:45.745105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:45.761222 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095845_00014_icjsa
[0m09:58:45.762542 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095845_00014_icjsa)
[0m09:58:45.763552 [debug] [ThreadPool]: On list_dev: Close
[0m09:58:45.764552 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m09:58:45.767551 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m09:58:45.768552 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m09:58:45.768552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:45.804084 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095845_00015_icjsa
[0m09:58:45.804084 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_095845_00015_icjsa)
[0m09:58:45.805189 [debug] [ThreadPool]: On list_gold: Close
[0m09:58:45.806104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:45.807101 [debug] [MainThread]: Connection 'list_gold' was properly closed.
[0m09:58:45.807101 [info ] [MainThread]: 
[0m09:58:45.809097 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m09:58:45.810102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594ABE83A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594ADA6170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594ADA62C0>]}
[0m09:58:45.811099 [debug] [MainThread]: Flushing usage events
[0m09:58:46.200638 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095845_00013_icjsa)


============================== 2023-06-05 09:58:57.556308 | 0699c002-3eb8-486b-ab52-7c2f9e70b7c9 ==============================
[0m09:58:57.556308 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:58:57.556308 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:58:57.556308 [debug] [MainThread]: Tracking: tracking
[0m09:58:57.578233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01A7C0A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0178E4BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F017407430>]}
[0m09:58:57.593311 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:58:57.615437 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:58:57.617437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0699c002-3eb8-486b-ab52-7c2f9e70b7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01A810EB0>]}
[0m09:58:58.377908 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m09:58:58.386247 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m09:58:58.394493 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m09:58:58.475183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0699c002-3eb8-486b-ab52-7c2f9e70b7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01A8B9840>]}
[0m09:58:58.481223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0699c002-3eb8-486b-ab52-7c2f9e70b7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01A812020>]}
[0m09:58:58.481223 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:58:58.481223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0699c002-3eb8-486b-ab52-7c2f9e70b7c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01A99EFE0>]}
[0m09:58:58.487221 [info ] [MainThread]: 
[0m09:58:58.490227 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:58:58.493266 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m09:58:58.509978 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m09:58:58.511511 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m09:58:58.512529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:58.536617 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095858_00016_icjsa
[0m09:58:58.536617 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_095858_00016_icjsa)
[0m09:58:58.537621 [debug] [ThreadPool]: On list_gold: Close
[0m09:58:58.541158 [debug] [ThreadPool]: Acquiring new trino connection 'list_dev'
[0m09:58:58.545174 [debug] [ThreadPool]: Using trino connection "list_dev"
[0m09:58:58.546174 [debug] [ThreadPool]: On list_dev: select distinct schema_name
    from dev.INFORMATION_SCHEMA.schemata
[0m09:58:58.546174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:58.575916 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095858_00017_icjsa
[0m09:58:58.575916 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095858_00017_icjsa)
[0m09:58:58.576926 [debug] [ThreadPool]: On list_dev: Close
[0m09:58:58.578926 [debug] [ThreadPool]: Acquiring new trino connection 'list_dev'
[0m09:58:58.582963 [debug] [ThreadPool]: Using trino connection "list_dev"
[0m09:58:58.583965 [debug] [ThreadPool]: On list_dev: select distinct schema_name
    from dev.INFORMATION_SCHEMA.schemata
[0m09:58:58.585048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:58.606204 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095858_00018_icjsa
[0m09:58:58.606204 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095858_00018_icjsa)
[0m09:58:58.606204 [debug] [ThreadPool]: On list_dev: Close
[0m09:58:58.606204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:58.606204 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m09:58:58.611212 [info ] [MainThread]: 
[0m09:58:58.611212 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m09:58:58.614464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01A8B85E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01AA721D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01AA72320>]}
[0m09:58:58.615460 [debug] [MainThread]: Flushing usage events
[0m09:58:59.011042 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_095858_00016_icjsa)


============================== 2023-06-05 09:59:26.868010 | e901f1a3-2e30-42a5-a25a-a112dae74be8 ==============================
[0m09:59:26.868010 [info ] [MainThread]: Running with dbt=1.4.6
[0m09:59:26.870028 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:59:26.870978 [debug] [MainThread]: Tracking: tracking
[0m09:59:26.889147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002377AD86290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002377AD85C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002377AD84E80>]}
[0m09:59:26.906551 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m09:59:26.927414 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:59:26.928395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e901f1a3-2e30-42a5-a25a-a112dae74be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023777D6E2F0>]}
[0m09:59:27.746147 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m09:59:27.753951 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m09:59:27.761011 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m09:59:27.841415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e901f1a3-2e30-42a5-a25a-a112dae74be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002377AE258A0>]}
[0m09:59:27.854734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e901f1a3-2e30-42a5-a25a-a112dae74be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002377AD85E70>]}
[0m09:59:27.855735 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:59:27.856739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e901f1a3-2e30-42a5-a25a-a112dae74be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023777E42620>]}
[0m09:59:27.858737 [info ] [MainThread]: 
[0m09:59:27.862902 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m09:59:27.864901 [debug] [ThreadPool]: Acquiring new trino connection 'list_dev'
[0m09:59:27.884565 [debug] [ThreadPool]: Using trino connection "list_dev"
[0m09:59:27.885524 [debug] [ThreadPool]: On list_dev: select distinct schema_name
    from dev.INFORMATION_SCHEMA.schemata
[0m09:59:27.885524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:27.919699 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095927_00019_icjsa
[0m09:59:27.919699 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095927_00019_icjsa)
[0m09:59:27.919699 [debug] [ThreadPool]: On list_dev: Close
[0m09:59:27.922482 [debug] [ThreadPool]: Acquiring new trino connection 'list_dev'
[0m09:59:27.925514 [debug] [ThreadPool]: Using trino connection "list_dev"
[0m09:59:27.926474 [debug] [ThreadPool]: On list_dev: select distinct schema_name
    from dev.INFORMATION_SCHEMA.schemata
[0m09:59:27.926474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:27.955350 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095927_00020_icjsa
[0m09:59:27.955350 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095927_00020_icjsa)
[0m09:59:27.955350 [debug] [ThreadPool]: On list_dev: Close
[0m09:59:27.955350 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m09:59:27.960861 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m09:59:27.960861 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m09:59:27.960861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:27.980813 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_095927_00021_icjsa
[0m09:59:27.986893 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_095927_00021_icjsa)
[0m09:59:27.986893 [debug] [ThreadPool]: On list_gold: Close
[0m09:59:27.986893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:27.986893 [debug] [MainThread]: Connection 'list_gold' was properly closed.
[0m09:59:27.990905 [info ] [MainThread]: 
[0m09:59:27.990905 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m09:59:27.992820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002377AE24460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002377AFE6230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002377AFE6380>]}
[0m09:59:27.993832 [debug] [MainThread]: Flushing usage events
[0m09:59:28.390980 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'dev' does not exist", query_id=20230605_095927_00019_icjsa)


============================== 2023-06-05 10:01:13.559216 | 30c12105-9277-4c26-8ccf-cafcdbede98e ==============================
[0m10:01:13.559216 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:01:13.561727 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:01:13.562728 [debug] [MainThread]: Tracking: tracking
[0m10:01:13.577849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786546CA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017862554BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017862075AE0>]}
[0m10:01:13.587424 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:01:13.609457 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:01:13.610457 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:01:13.611755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30c12105-9277-4c26-8ccf-cafcdbede98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178654C2050>]}
[0m10:01:14.264172 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m10:01:14.277485 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m10:01:14.281573 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m10:01:14.368667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30c12105-9277-4c26-8ccf-cafcdbede98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017865569840>]}
[0m10:01:14.377789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30c12105-9277-4c26-8ccf-cafcdbede98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178654C2D40>]}
[0m10:01:14.378790 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:01:14.379788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c12105-9277-4c26-8ccf-cafcdbede98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786564EFE0>]}
[0m10:01:14.381986 [info ] [MainThread]: 
[0m10:01:14.386011 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:01:14.389009 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:01:14.410663 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:01:14.411615 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m10:01:14.411615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:14.597956 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m10:01:14.600472 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:01:14.603646 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m10:01:14.607659 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m10:01:14.608667 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m10:01:14.608667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:14.657003 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_100114_00023_icjsa
[0m10:01:14.658002 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_100114_00023_icjsa)
[0m10:01:14.659000 [debug] [ThreadPool]: On list_gold: Close
[0m10:01:14.662523 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:01:14.668039 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:01:14.669050 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m10:01:14.669050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:14.811272 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m10:01:14.814295 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:01:14.816882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:14.818898 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m10:01:14.819408 [info ] [MainThread]: 
[0m10:01:14.821430 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m10:01:14.824433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178655685E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017865728760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178657281F0>]}
[0m10:01:14.826446 [debug] [MainThread]: Flushing usage events
[0m10:01:15.217812 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_100114_00023_icjsa)


============================== 2023-06-05 10:01:31.475459 | 96be6e2e-5ed5-47f1-8645-3a8b06f8e403 ==============================
[0m10:01:31.475459 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:01:31.475459 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:01:31.475459 [debug] [MainThread]: Tracking: tracking
[0m10:01:31.499242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8B4CA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE5C973D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE57B9AE0>]}
[0m10:01:31.518345 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:01:31.542477 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:01:31.543474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96be6e2e-5ed5-47f1-8645-3a8b06f8e403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE5C95090>]}
[0m10:01:32.283973 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m10:01:32.299558 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m10:01:32.300566 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m10:01:32.386054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96be6e2e-5ed5-47f1-8645-3a8b06f8e403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8C19810>]}
[0m10:01:32.393565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96be6e2e-5ed5-47f1-8645-3a8b06f8e403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8B81E70>]}
[0m10:01:32.394567 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:01:32.395568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96be6e2e-5ed5-47f1-8645-3a8b06f8e403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE5C95270>]}
[0m10:01:32.397569 [info ] [MainThread]: 
[0m10:01:32.400651 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:01:32.402662 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:01:32.419221 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:01:32.419221 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m10:01:32.420809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:32.543988 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m10:01:32.546999 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:01:32.549001 [debug] [ThreadPool]: Acquiring new trino connection 'list_gold'
[0m10:01:32.553026 [debug] [ThreadPool]: Using trino connection "list_gold"
[0m10:01:32.553026 [debug] [ThreadPool]: On list_gold: select distinct schema_name
    from gold.INFORMATION_SCHEMA.schemata
[0m10:01:32.553026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:32.583867 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_100132_00026_icjsa
[0m10:01:32.584866 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_100132_00026_icjsa)
[0m10:01:32.584866 [debug] [ThreadPool]: On list_gold: Close
[0m10:01:32.587869 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:01:32.591393 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:01:32.592395 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m10:01:32.592916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:32.715484 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m10:01:32.715484 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:01:32.720517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:32.720517 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m10:01:32.720517 [info ] [MainThread]: 
[0m10:01:32.724571 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m10:01:32.728370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8C185B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8DE0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8DE01C0>]}
[0m10:01:32.730380 [debug] [MainThread]: Flushing usage events
[0m10:01:33.106567 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 2:10: Catalog 'gold' does not exist", query_id=20230605_100132_00026_icjsa)


============================== 2023-06-05 10:02:53.951559 | d4c76bf0-d15f-44a0-b64a-7398eb2f44c4 ==============================
[0m10:02:53.951559 [info ] [MainThread]: Running with dbt=1.4.6
[0m10:02:53.955514 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:02:53.955514 [debug] [MainThread]: Tracking: tracking
[0m10:02:53.988168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D09A1570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D0ABDFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D0ABDB10>]}
[0m10:02:54.020588 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m10:02:54.146120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:02:54.150143 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\gold\weathergold.sql
[0m10:02:54.189149 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m10:02:54.233027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4c76bf0-d15f-44a0-b64a-7398eb2f44c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D3B11750>]}
[0m10:02:54.250162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4c76bf0-d15f-44a0-b64a-7398eb2f44c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D3AEFF10>]}
[0m10:02:54.250162 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:02:54.255225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c76bf0-d15f-44a0-b64a-7398eb2f44c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D09A1570>]}
[0m10:02:54.261490 [info ] [MainThread]: 
[0m10:02:54.272130 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:02:54.278743 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:02:54.321270 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:02:54.322274 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m10:02:54.323267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:54.525539 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m10:02:54.530347 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:02:54.530347 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m10:02:54.541034 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m10:02:54.542590 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m10:02:54.544106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:04.950304 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_100254_00029_icjsa
[0m10:03:04.952839 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: host1, server ClickHouseNode [uri=http://host1:8123/default, options={use_binary_string=true}]@-1279576232", query_id=20230605_100254_00029_icjsa)
[0m10:03:04.952839 [debug] [ThreadPool]: On list_clickhouse: Close
[0m10:03:04.954885 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m10:03:04.958948 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m10:03:04.958948 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m10:03:04.958948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:05.074086 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m10:03:05.074086 [debug] [ThreadPool]: On list_lakehouse: Close
[0m10:03:05.077108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:05.077108 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m10:03:05.080129 [info ] [MainThread]: 
[0m10:03:05.080129 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 10.81 seconds (10.81s).
[0m10:03:05.081865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D3983460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D3983670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D3982170>]}
[0m10:03:05.083396 [debug] [MainThread]: Flushing usage events
[0m10:03:05.470375 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: host1, server ClickHouseNode [uri=http://host1:8123/default, options={use_binary_string=true}]@-1279576232", query_id=20230605_100254_00029_icjsa)


============================== 2023-06-05 12:08:03.284016 | 8e4f525b-50fd-4c51-a3e1-29707eeb1691 ==============================
[0m12:08:03.284016 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:08:03.284016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:08:03.284016 [debug] [MainThread]: Tracking: tracking
[0m12:08:03.305904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC7498A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC46173D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC4137880>]}
[0m12:08:03.328490 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:08:03.349245 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:08:03.350241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e4f525b-50fd-4c51-a3e1-29707eeb1691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC4615090>]}
[0m12:08:05.001887 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:08:05.013983 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:08:05.017768 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:08:05.103637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e4f525b-50fd-4c51-a3e1-29707eeb1691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC75A5810>]}
[0m12:08:05.118536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e4f525b-50fd-4c51-a3e1-29707eeb1691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC7501EA0>]}
[0m12:08:05.119537 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:08:05.120536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4f525b-50fd-4c51-a3e1-29707eeb1691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC4615270>]}
[0m12:08:05.122538 [info ] [MainThread]: 
[0m12:08:05.126587 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:08:05.128599 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:08:05.152680 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:08:05.154208 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:08:05.154208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:07.177377 [debug] [ThreadPool]: SQL status: SUCCESS in 2 seconds
[0m12:08:07.181922 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:08:07.185376 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:08:07.189748 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:08:07.193784 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:08:07.193784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:07.530338 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m12:08:07.533091 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:08:07.536487 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m12:08:07.542602 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m12:08:07.542602 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m12:08:07.543637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:07.895813 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_120807_00002_7rx97
[0m12:08:07.898866 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: Connection refused, server ClickHouseNode [uri=http://localhost:8123/default, options={use_binary_string=true}]@-792430009", query_id=20230605_120807_00002_7rx97)
[0m12:08:07.899383 [debug] [ThreadPool]: On list_clickhouse: Close
[0m12:08:07.903490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:07.904605 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m12:08:07.907037 [info ] [MainThread]: 
[0m12:08:07.909333 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m12:08:07.911624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC75A45B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC775C4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EC775C040>]}
[0m12:08:07.913290 [debug] [MainThread]: Flushing usage events
[0m12:08:08.354921 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: Connection refused, server ClickHouseNode [uri=http://localhost:8123/default, options={use_binary_string=true}]@-792430009", query_id=20230605_120807_00002_7rx97)


============================== 2023-06-05 12:11:24.926270 | 76e015d2-c59c-439a-88f4-41951965fedd ==============================
[0m12:11:24.926270 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:11:24.926270 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m12:11:24.926270 [debug] [MainThread]: Tracking: tracking
[0m12:11:24.945973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001411BEBE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001411BEBFCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001411BEBFAC0>]}
[0m12:11:25.075161 [debug] [MainThread]: Executing "git --help"
[0m12:11:25.130526 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:11:25.131550 [debug] [MainThread]: STDERR: "b''"
[0m12:11:25.136070 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m12:11:25.137070 [debug] [MainThread]: Using trino connection "debug"
[0m12:11:25.138070 [debug] [MainThread]: On debug: select 1 as id
[0m12:11:25.138070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:25.288439 [debug] [MainThread]: SQL status: SUCCESS in 0 seconds
[0m12:11:25.290084 [debug] [MainThread]: On debug: Close
[0m12:11:25.292250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014117DB4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001411C203190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141192FCAC0>]}
[0m12:11:25.293074 [debug] [MainThread]: Flushing usage events
[0m12:11:25.675388 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-06-05 12:21:07.461218 | 9b82030f-af4f-412e-bc69-83bd7144c276 ==============================
[0m12:21:07.461218 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:21:07.461218 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:21:07.461218 [debug] [MainThread]: Tracking: tracking
[0m12:21:07.542043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259E1ECD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259ADC5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259ADC6B00>]}
[0m12:21:07.571300 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:21:08.908251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:08.908251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:08.921210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b82030f-af4f-412e-bc69-83bd7144c276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259E3FC0D0>]}
[0m12:21:08.931162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b82030f-af4f-412e-bc69-83bd7144c276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259E3C3D00>]}
[0m12:21:08.931162 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:21:08.935682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b82030f-af4f-412e-bc69-83bd7144c276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259E1ECD60>]}
[0m12:21:08.938463 [info ] [MainThread]: 
[0m12:21:08.944001 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:21:08.947008 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m12:21:08.971213 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m12:21:08.973175 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m12:21:08.973175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:10.510376 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_122109_00000_xu384
[0m12:21:10.512002 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: Connection refused, server ClickHouseNode [uri=http://localhost:8123/default, options={use_binary_string=true}]@1358335255", query_id=20230605_122109_00000_xu384)
[0m12:21:10.512002 [debug] [ThreadPool]: On list_clickhouse: Close
[0m12:21:10.518714 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:21:10.528615 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:21:10.530165 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:21:10.531216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:11.488869 [debug] [ThreadPool]: SQL status: SUCCESS in 1 seconds
[0m12:21:11.491985 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:21:11.496959 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:21:11.503057 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:21:11.505337 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:21:11.507857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:11.906905 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m12:21:11.910992 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:21:11.910992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:11.910992 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m12:21:11.910992 [info ] [MainThread]: 
[0m12:21:11.920910 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m12:21:11.923842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259E3C3A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259E48E200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259E48DC90>]}
[0m12:21:11.925956 [debug] [MainThread]: Flushing usage events
[0m12:21:12.326197 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: Connection refused, server ClickHouseNode [uri=http://localhost:8123/default, options={use_binary_string=true}]@1358335255", query_id=20230605_122109_00000_xu384)


============================== 2023-06-05 12:23:48.880388 | 643f3cbe-4716-4772-9818-c415d320a9ba ==============================
[0m12:23:48.880388 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:23:48.885463 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:23:48.885463 [debug] [MainThread]: Tracking: tracking
[0m12:23:48.917439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285F1570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2870DFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2870DB10>]}
[0m12:23:48.936294 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:23:49.001241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:49.001241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:49.010321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '643f3cbe-4716-4772-9818-c415d320a9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2B76C0D0>]}
[0m12:23:49.020381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '643f3cbe-4716-4772-9818-c415d320a9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2B64BCD0>]}
[0m12:23:49.020381 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:23:49.020381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '643f3cbe-4716-4772-9818-c415d320a9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285F1570>]}
[0m12:23:49.025624 [info ] [MainThread]: 
[0m12:23:49.031136 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:23:49.034164 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:23:49.059436 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:23:49.060437 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:23:49.061740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:51.263644 [debug] [ThreadPool]: SQL status: SUCCESS in 2 seconds
[0m12:23:51.268674 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:23:51.272759 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m12:23:51.280532 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m12:23:51.282486 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m12:23:51.283501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:51.682714 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_122351_00001_ufm64
[0m12:23:51.683713 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: Connection refused, server ClickHouseNode [uri=http://localhost:8123/default, options={use_binary_string=true}]@450695823", query_id=20230605_122351_00001_ufm64)
[0m12:23:51.687282 [debug] [ThreadPool]: On list_clickhouse: Close
[0m12:23:51.692326 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:23:51.702252 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:23:51.703246 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:23:51.704776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:52.037741 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m12:23:52.040865 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:23:52.047159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:52.049180 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m12:23:52.051728 [info ] [MainThread]: 
[0m12:23:52.054344 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m12:23:52.058397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2B64BA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2B7FE800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2B7FE290>]}
[0m12:23:52.061732 [debug] [MainThread]: Flushing usage events
[0m12:23:52.452892 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: Connection refused, server ClickHouseNode [uri=http://localhost:8123/default, options={use_binary_string=true}]@450695823", query_id=20230605_122351_00001_ufm64)


============================== 2023-06-05 12:29:12.882896 | cdaa1f9e-d23f-4db4-8d51-3876804e3062 ==============================
[0m12:29:12.882896 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:29:12.889504 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:29:12.889504 [debug] [MainThread]: Tracking: tracking
[0m12:29:12.917147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFB801570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFB91DFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFB91DB10>]}
[0m12:29:12.935033 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:29:12.997203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:12.998204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:13.005735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdaa1f9e-d23f-4db4-8d51-3876804e3062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFE96C0D0>]}
[0m12:29:13.013256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdaa1f9e-d23f-4db4-8d51-3876804e3062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFE933CD0>]}
[0m12:29:13.014254 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:29:13.015256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdaa1f9e-d23f-4db4-8d51-3876804e3062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFB801570>]}
[0m12:29:13.017258 [info ] [MainThread]: 
[0m12:29:13.021422 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:29:13.023436 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:29:13.043036 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:29:13.044036 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:29:13.044036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:15.269816 [debug] [ThreadPool]: SQL status: SUCCESS in 2 seconds
[0m12:29:15.273377 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:29:15.277739 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:29:15.287462 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:29:15.288457 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:29:15.289466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:15.629572 [debug] [ThreadPool]: SQL status: SUCCESS in 0 seconds
[0m12:29:15.633659 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:29:15.638233 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m12:29:15.646936 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m12:29:15.647926 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m12:29:15.649495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:16.047710 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_122915_00002_7pc6f
[0m12:29:16.050320 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: Connection refused, server ClickHouseNode [uri=http://localhost:9000/default, options={use_binary_string=true}]@-1076698689", query_id=20230605_122915_00002_7pc6f)
[0m12:29:16.052323 [debug] [ThreadPool]: On list_clickhouse: Close
[0m12:29:16.058485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:16.060012 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m12:29:16.061034 [info ] [MainThread]: 
[0m12:29:16.064122 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m12:29:16.067707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFE933A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFE9EF010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFE9EDF60>]}
[0m12:29:16.070250 [debug] [MainThread]: Flushing usage events
[0m12:29:16.464090 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=JDBC_ERROR, message="Error listing schemas for catalog clickhouse: Connection refused, server ClickHouseNode [uri=http://localhost:9000/default, options={use_binary_string=true}]@-1076698689", query_id=20230605_122915_00002_7pc6f)


============================== 2023-06-05 12:40:20.412681 | ddefa6b4-e0fa-4784-a636-1d4145832b81 ==============================
[0m12:40:20.412681 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:40:20.414614 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'target': 'gold', 'select': ['weathergold'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:40:20.414614 [debug] [MainThread]: Tracking: tracking
[0m12:40:20.430699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017449241C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017448DA38E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017448DA3EB0>]}
[0m12:40:20.449803 [debug] [MainThread]: checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2, vars: {}, profile: None, target: gold, version: 1.4.6
[0m12:40:20.469880 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:40:20.471209 [debug] [MainThread]: previous checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, current checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2
[0m12:40:20.472239 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:40:20.472239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddefa6b4-e0fa-4784-a636-1d4145832b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017448E09F90>]}
[0m12:40:21.915052 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:40:21.930269 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:40:21.934274 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:40:21.995397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001744C3738B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001744C330DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001744C333A90>]}
[0m12:40:21.997038 [debug] [MainThread]: Flushing usage events
[0m12:40:22.414381 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 12:40:41.463910 | 7cddf348-69b1-4b9f-88d6-30fae4bdeb24 ==============================
[0m12:40:41.463910 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:40:41.466856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'target': 'gold', 'select': ['weathergold'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:40:41.466856 [debug] [MainThread]: Tracking: tracking
[0m12:40:41.486201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001655CBDC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001655C5A5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001655C5A4D60>]}
[0m12:40:41.500870 [debug] [MainThread]: checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2, vars: {}, profile: None, target: gold, version: 1.4.6
[0m12:40:41.511052 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:40:41.513059 [debug] [MainThread]: previous checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, current checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2
[0m12:40:41.513059 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:40:41.514050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7cddf348-69b1-4b9f-88d6-30fae4bdeb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001655C60A050>]}
[0m12:40:42.295212 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:40:42.313345 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:40:42.318479 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:40:42.380504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001655FB23910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001655FAE6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001655FAE63E0>]}
[0m12:40:42.381421 [debug] [MainThread]: Flushing usage events
[0m12:40:42.819865 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 12:43:07.897963 | 7c10189a-41ec-4d80-a8cd-019e8def9cb8 ==============================
[0m12:43:07.897963 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:43:07.899966 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'target': 'gold', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:43:07.899966 [debug] [MainThread]: Tracking: tracking
[0m12:43:07.914009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B62A2B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B5E08B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B5E0B7F0>]}
[0m12:43:07.927049 [debug] [MainThread]: checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2, vars: {}, profile: None, target: gold, version: 1.4.6
[0m12:43:07.935068 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:43:07.937595 [debug] [MainThread]: previous checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, current checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2
[0m12:43:07.937595 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:43:07.938596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c10189a-41ec-4d80-a8cd-019e8def9cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B5E69F60>]}
[0m12:43:08.461839 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:43:08.470362 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:43:08.473360 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:43:08.511621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B93A3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B9365300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B9367C10>]}
[0m12:43:08.512596 [debug] [MainThread]: Flushing usage events
[0m12:43:08.909894 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 12:44:15.644160 | 2b36c448-582f-4b77-934a-9e2cf66d2bf9 ==============================
[0m12:44:15.644160 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:44:15.649650 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'target': 'gold', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:44:15.650675 [debug] [MainThread]: Tracking: tracking
[0m12:44:15.686203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012651604AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126516067A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012651604850>]}
[0m12:44:15.718048 [debug] [MainThread]: checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2, vars: {}, profile: None, target: gold, version: 1.4.6
[0m12:44:15.738244 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:44:15.740238 [debug] [MainThread]: previous checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, current checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2
[0m12:44:15.742204 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:44:15.744204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b36c448-582f-4b77-934a-9e2cf66d2bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001265166DF90>]}
[0m12:44:16.768309 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:44:16.781963 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:44:16.788846 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:44:16.874258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012654C138B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012654BD7B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012654BD7FD0>]}
[0m12:44:16.875252 [debug] [MainThread]: Flushing usage events
[0m12:44:17.326901 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 12:46:23.842306 | ac0b02ea-7339-4d7c-baea-1b0850f04dea ==============================
[0m12:46:23.842306 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:46:23.845895 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'target': 'gold', 'select': ['weathergold'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:46:23.846834 [debug] [MainThread]: Tracking: tracking
[0m12:46:23.864909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC9AA9C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC9A465990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC9A467EB0>]}
[0m12:46:23.878932 [debug] [MainThread]: checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2, vars: {}, profile: None, target: gold, version: 1.4.6
[0m12:46:23.890996 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:46:23.891996 [debug] [MainThread]: previous checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, current checksum: 15008b33a0411e2f49e6a1467161974940c4eb3598156b380ae8c78a3fd30cd2
[0m12:46:23.893006 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:46:23.895010 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:46:23.899540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac0b02ea-7339-4d7c-baea-1b0850f04dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC9A465930>]}
[0m12:46:24.682649 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:46:24.694402 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:46:24.698980 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:46:24.754226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC9DA93910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC9DA57BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC9DA56C50>]}
[0m12:46:24.754226 [debug] [MainThread]: Flushing usage events
[0m12:46:25.169744 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 12:50:05.032586 | 82f44bae-c703-47a2-a149-fb298d333c7f ==============================
[0m12:50:05.032586 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:50:05.035216 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:50:05.036139 [debug] [MainThread]: Tracking: tracking
[0m12:50:05.067630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B542AEA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B53538C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B5353BAC0>]}
[0m12:50:05.102357 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:50:05.118610 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:50:05.120601 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:50:05.121600 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:50:05.123604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82f44bae-c703-47a2-a149-fb298d333c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B5359B310>]}
[0m12:50:07.196787 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:50:07.215108 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:50:07.221176 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:50:07.305565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B56A22B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B56A23460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B56A23520>]}
[0m12:50:07.307630 [debug] [MainThread]: Flushing usage events
[0m12:50:07.732270 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 12:52:25.851427 | fe146ef6-0dd6-46c9-aac0-95e1082b9439 ==============================
[0m12:52:25.851427 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:52:25.854530 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:52:25.855476 [debug] [MainThread]: Tracking: tracking
[0m12:52:25.876063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001274AE639D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001274A93B8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001274A938D00>]}
[0m12:52:25.906219 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:52:25.930315 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:52:25.931115 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:52:25.932208 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:52:25.933179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fe146ef6-0dd6-46c9-aac0-95e1082b9439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001274A99B3A0>]}
[0m12:52:27.646410 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:52:27.659062 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:52:27.663070 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:52:27.719357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001274DD30DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001274DD313F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001274DD31990>]}
[0m12:52:27.720358 [debug] [MainThread]: Flushing usage events
[0m12:52:28.150875 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 12:54:57.971251 | 8740dd94-b44b-41f3-bf25-6d7d0b2f447a ==============================
[0m12:54:57.971251 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:54:57.973209 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:54:57.973209 [debug] [MainThread]: Tracking: tracking
[0m12:54:57.987002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F430EEAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F42378CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F4237BCD0>]}
[0m12:54:57.997592 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:54:58.004091 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:54:58.005138 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:54:58.006112 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:54:58.007113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8740dd94-b44b-41f3-bf25-6d7d0b2f447a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F423D5510>]}
[0m12:54:58.545804 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:54:58.556051 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:54:58.559060 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:54:58.607175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F4578E200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F4578E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F4578EFB0>]}
[0m12:54:58.608176 [debug] [MainThread]: Flushing usage events
[0m12:54:59.006972 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 12:57:00.341629 | 8b724ae2-aa28-4165-8fc1-3db86481a36f ==============================
[0m12:57:00.341629 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:57:00.344709 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:57:00.345708 [debug] [MainThread]: Tracking: tracking
[0m12:57:00.365819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6985139D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D697FEB8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D697FE8D60>]}
[0m12:57:00.381347 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:57:00.397915 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:57:00.399022 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:57:00.399967 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:57:00.400930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b724ae2-aa28-4165-8fc1-3db86481a36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D698047010>]}
[0m12:57:01.261158 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:57:01.275220 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:57:01.280223 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:57:01.347354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69B3DA080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69B3DACE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D69B3DADA0>]}
[0m12:57:01.348353 [debug] [MainThread]: Flushing usage events
[0m12:57:01.795685 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 12:57:55.491965 | 7f1c23a6-2f11-42d2-808e-50c98c398edc ==============================
[0m12:57:55.491965 [info ] [MainThread]: Running with dbt=1.4.6
[0m12:57:55.493659 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:57:55.493659 [debug] [MainThread]: Tracking: tracking
[0m12:57:55.507394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A74F54EAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A74E7D8CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A74E7DB460>]}
[0m12:57:55.517971 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m12:57:55.524489 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:57:55.525488 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:57:55.526488 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:57:55.528490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f1c23a6-2f11-42d2-808e-50c98c398edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A74E836FE0>]}
[0m12:57:56.060037 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:57:56.068981 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:57:56.071995 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:57:56.109494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A751BD5F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A751BD6CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A751BD74F0>]}
[0m12:57:56.110486 [debug] [MainThread]: Flushing usage events
[0m12:57:56.473892 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:10:13.211558 | 2d69dd76-5577-40b1-81b6-dfd855b0133a ==============================
[0m13:10:13.211558 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:10:13.213720 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:10:13.213720 [debug] [MainThread]: Tracking: tracking
[0m13:10:13.229576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014442567DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014442565AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014442565750>]}
[0m13:10:13.247575 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:10:13.266321 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:10:13.267428 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:10:13.268331 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:10:13.269329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d69dd76-5577-40b1-81b6-dfd855b0133a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144425C7010>]}
[0m13:10:14.527949 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:10:14.537963 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:10:14.541984 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:10:14.593872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014445AC38B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014445AC2FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014445AC32B0>]}
[0m13:10:14.594786 [debug] [MainThread]: Flushing usage events
[0m13:10:15.045284 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:13:36.960414 | 6709c212-fa5a-4e40-9e9d-c73b14fa47cc ==============================
[0m13:13:36.960414 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:13:36.962375 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:13:36.962375 [debug] [MainThread]: Tracking: tracking
[0m13:13:36.977330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44CD2B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4483AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44838D30>]}
[0m13:13:36.986898 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:13:36.993881 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:13:36.994878 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:13:36.996889 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:13:36.999881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6709c212-fa5a-4e40-9e9d-c73b14fa47cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F448958A0>]}
[0m13:13:37.508040 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:13:37.516511 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:13:37.518519 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:13:37.557519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F47DE77C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F47CCEEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F47CCEFB0>]}
[0m13:13:37.557519 [debug] [MainThread]: Flushing usage events
[0m13:13:37.935760 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:14:12.381114 | 4438b0e1-b2f7-4a13-b279-47cafbeee9d9 ==============================
[0m13:14:12.381114 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:14:12.383177 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:14:12.384071 [debug] [MainThread]: Tracking: tracking
[0m13:14:12.400710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC85F42B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC85AAAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC85AA8DC0>]}
[0m13:14:12.413914 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:14:12.420916 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:14:12.420916 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:14:12.421918 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:14:12.423920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4438b0e1-b2f7-4a13-b279-47cafbeee9d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC85AA9AE0>]}
[0m13:14:12.955779 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:14:12.964115 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:14:12.967124 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:14:13.004212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC88EBF550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC88EBFB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC88EBDD20>]}
[0m13:14:13.005123 [debug] [MainThread]: Flushing usage events
[0m13:14:13.390433 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:20:00.536705 | 048e23aa-933a-416b-8294-cb6a9f3d8f24 ==============================
[0m13:20:00.536705 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:20:00.538710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:20:00.538710 [debug] [MainThread]: Tracking: tracking
[0m13:20:00.553812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002876416A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002876416B880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287641696F0>]}
[0m13:20:00.567170 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:20:00.574174 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:20:00.575174 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:20:00.576171 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:20:00.577172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '048e23aa-933a-416b-8294-cb6a9f3d8f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002876416BCD0>]}
[0m13:20:01.146331 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:20:01.155001 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:20:01.159874 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:20:01.201968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287676B17E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287676B2080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287676B37C0>]}
[0m13:20:01.201968 [debug] [MainThread]: Flushing usage events
[0m13:20:01.607148 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:20:48.480904 | b069fa57-69fb-47ea-af95-64f300605f90 ==============================
[0m13:20:48.480904 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:20:48.482846 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:20:48.482846 [debug] [MainThread]: Tracking: tracking
[0m13:20:48.497846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218079BE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218079BFB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218079BE4D0>]}
[0m13:20:48.575376 [debug] [MainThread]: Executing "git --help"
[0m13:20:48.618620 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:20:48.620192 [debug] [MainThread]: STDERR: "b''"
[0m13:20:48.626001 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:20:48.627028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:51.050893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021804859D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021808E26B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021808E26D70>]}
[0m13:20:51.052878 [debug] [MainThread]: Flushing usage events
[0m13:20:51.435557 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:20:51.436445 [debug] [MainThread]: On debug: No close available on handle


============================== 2023-06-05 13:22:38.596403 | a75052cc-7868-465e-b2eb-f50624dc4318 ==============================
[0m13:22:38.596403 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:22:38.599401 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:22:38.600402 [debug] [MainThread]: Tracking: tracking
[0m13:22:38.622716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C41DEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C41DF820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C41DFBE0>]}
[0m13:22:38.767944 [debug] [MainThread]: Executing "git --help"
[0m13:22:38.859528 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:22:38.860520 [debug] [MainThread]: STDERR: "b''"
[0m13:22:38.865522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C421F760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C10720E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C1071780>]}
[0m13:22:38.865522 [debug] [MainThread]: Flushing usage events


============================== 2023-06-05 13:23:54.627121 | a90263f4-a06f-415f-be52-efae263baac0 ==============================
[0m13:23:54.627121 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:23:54.631251 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:23:54.631251 [debug] [MainThread]: Tracking: tracking
[0m13:23:54.655591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABBDCE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABBDCFF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABBDCE3B0>]}
[0m13:23:54.779368 [debug] [MainThread]: Executing "git --help"
[0m13:23:54.839385 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:23:54.840383 [debug] [MainThread]: STDERR: "b''"
[0m13:23:54.851404 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:23:54.852396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:57.296008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB8C54B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABD226B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABD226DD0>]}
[0m13:23:57.297021 [debug] [MainThread]: Flushing usage events
[0m13:23:57.687318 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:23:57.688455 [debug] [MainThread]: On debug: No close available on handle


============================== 2023-06-05 13:24:10.752967 | 71a814a6-e3cf-42cb-af8e-56d5bd5505af ==============================
[0m13:24:10.752967 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:24:10.754966 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:24:10.755966 [debug] [MainThread]: Tracking: tracking
[0m13:24:10.769972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB303EEB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB303EFFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB303EFC70>]}
[0m13:24:10.848743 [debug] [MainThread]: Executing "git --help"
[0m13:24:10.891806 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:24:10.892785 [debug] [MainThread]: STDERR: "b''"
[0m13:24:10.895743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB30433760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB2D261F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB2D260C70>]}
[0m13:24:10.896744 [debug] [MainThread]: Flushing usage events


============================== 2023-06-05 13:26:20.197364 | b7c58086-2501-4175-8528-40a7a4444023 ==============================
[0m13:26:20.197364 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:26:20.199367 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:26:20.199367 [debug] [MainThread]: Tracking: tracking
[0m13:26:20.225695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176D5ADE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176D5ADE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176D5ADE6B0>]}
[0m13:26:20.334362 [debug] [MainThread]: Executing "git --help"
[0m13:26:20.386323 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:26:20.387323 [debug] [MainThread]: STDERR: "b''"
[0m13:26:20.396316 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:26:20.397352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:21.094647 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m13:26:21.099660 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:26:21.102657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176D19E4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176D29953C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176D2E11C90>]}
[0m13:26:21.102657 [debug] [MainThread]: Flushing usage events
[0m13:26:21.502000 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:26:21.503003 [debug] [MainThread]: On debug: Close


============================== 2023-06-05 13:26:31.347148 | 8bda4b24-8b81-4c21-a800-91dbeb6ba083 ==============================
[0m13:26:31.347148 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:26:31.349148 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:26:31.349148 [debug] [MainThread]: Tracking: tracking
[0m13:26:31.363150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E186BEA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E17938C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1793BCA0>]}
[0m13:26:31.381157 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:26:31.401148 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:26:31.402017 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:26:31.403076 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:26:31.404140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8bda4b24-8b81-4c21-a800-91dbeb6ba083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E179399F0>]}
[0m13:26:32.617957 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:26:32.626953 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:26:32.630463 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:26:32.671462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1AD8EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1AD8FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1AD8E1A0>]}
[0m13:26:32.671462 [debug] [MainThread]: Flushing usage events
[0m13:26:33.058065 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:28:21.347475 | 1019abe8-2412-40b5-8f39-e046d798d57c ==============================
[0m13:28:21.347475 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:28:21.349469 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:28:21.350469 [debug] [MainThread]: Tracking: tracking
[0m13:28:21.365464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0F0E2B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0EC4AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0EC48CD0>]}
[0m13:28:21.377475 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:28:21.386478 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:28:21.387477 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:28:21.388474 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:28:21.391019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1019abe8-2412-40b5-8f39-e046d798d57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0EC49AE0>]}
[0m13:28:21.970251 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:28:21.980257 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:28:21.983256 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:28:22.021847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1208CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1208E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1208EA70>]}
[0m13:28:22.022830 [debug] [MainThread]: Flushing usage events
[0m13:28:22.404040 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:28:57.409722 | 7cba9cc1-c573-47d1-a812-c4812683d60e ==============================
[0m13:28:57.409722 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:28:57.411840 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:28:57.412765 [debug] [MainThread]: Tracking: tracking
[0m13:28:57.424721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B241D10A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2418796C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B241878D00>]}
[0m13:28:57.436729 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:28:57.445078 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:28:57.446081 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:28:57.447082 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:28:57.448082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7cba9cc1-c573-47d1-a812-c4812683d60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B241879A80>]}
[0m13:28:57.987540 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:28:57.996057 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:28:57.999066 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:28:58.039068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B244E33730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B244D1E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B244D1CA30>]}
[0m13:28:58.040070 [debug] [MainThread]: Flushing usage events
[0m13:28:58.402982 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:29:14.720648 | f8d48a21-34c1-47e2-99e4-ab75a8cca64f ==============================
[0m13:29:14.720648 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:29:14.722560 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:29:14.722560 [debug] [MainThread]: Tracking: tracking
[0m13:29:14.735816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8AD08970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8AD09AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8AD096F0>]}
[0m13:29:14.745815 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:29:14.756832 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:29:14.757830 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:29:14.758835 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:29:14.761830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8d48a21-34c1-47e2-99e4-ab75a8cca64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8AD08E80>]}
[0m13:29:15.270409 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:29:15.278056 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:29:15.280962 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:29:15.320057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8E12E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8E12EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8E12F670>]}
[0m13:29:15.320057 [debug] [MainThread]: Flushing usage events
[0m13:29:15.690160 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:32:28.523692 | 06733982-d037-4397-8973-bceb65f22606 ==============================
[0m13:32:28.523692 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:32:28.525675 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:32:28.525675 [debug] [MainThread]: Tracking: tracking
[0m13:32:28.542693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5714EB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5714F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5714E4D0>]}
[0m13:32:28.616222 [debug] [MainThread]: Executing "git --help"
[0m13:32:28.653737 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:32:28.654749 [debug] [MainThread]: STDERR: "b''"
[0m13:32:28.660853 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:32:28.661847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:29.129333 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m13:32:29.132333 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:32:29.134332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5307C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F54039420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F544B2DA0>]}
[0m13:32:29.135330 [debug] [MainThread]: Flushing usage events
[0m13:32:29.520676 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:32:29.520676 [debug] [MainThread]: On debug: Close


============================== 2023-06-05 13:32:35.129956 | b43c2b98-599c-4de7-b538-1bf91154d817 ==============================
[0m13:32:35.129956 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:32:35.131901 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:32:35.132872 [debug] [MainThread]: Tracking: tracking
[0m13:32:35.150883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916943D930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029168E09F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029168E09930>]}
[0m13:32:35.161428 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:32:35.170461 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:32:35.171438 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:32:35.172441 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:32:35.173445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b43c2b98-599c-4de7-b538-1bf91154d817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029168E0BF10>]}
[0m13:32:35.704919 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:32:35.714062 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:32:35.717064 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:32:35.757095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916C2CC5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916C2CEE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916C2CECB0>]}
[0m13:32:35.758097 [debug] [MainThread]: Flushing usage events
[0m13:32:36.150409 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:32:48.801973 | 00911db8-b828-4911-8ae4-e7d4d7a5b04a ==============================
[0m13:32:48.801973 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:32:48.803969 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:32:48.803969 [debug] [MainThread]: Tracking: tracking
[0m13:32:48.819979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024465A3E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024465A3F8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024465A3FF40>]}
[0m13:32:48.905342 [debug] [MainThread]: Executing "git --help"
[0m13:32:48.957958 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:32:48.958958 [debug] [MainThread]: STDERR: "b''"
[0m13:32:48.967995 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:32:48.967995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:49.610998 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m13:32:49.614997 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:32:49.617000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024461974940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024462926350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024462926380>]}
[0m13:32:49.617999 [debug] [MainThread]: Flushing usage events
[0m13:32:49.986150 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:32:49.986150 [debug] [MainThread]: On debug: Close


============================== 2023-06-05 13:32:54.839848 | 140d745b-71fb-42fc-ba27-016121ad6791 ==============================
[0m13:32:54.839848 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:32:54.843819 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:32:54.844817 [debug] [MainThread]: Tracking: tracking
[0m13:32:54.875833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002122EB02B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002122E666D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002122E664DC0>]}
[0m13:32:54.900823 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:32:54.915835 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:32:54.917838 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:32:54.918835 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:32:54.919842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '140d745b-71fb-42fc-ba27-016121ad6791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002122E664DC0>]}
[0m13:32:56.113142 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:32:56.129143 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:32:56.135143 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:32:56.209663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021231ABED40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021231ABE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021231ABE680>]}
[0m13:32:56.210665 [debug] [MainThread]: Flushing usage events
[0m13:32:56.589654 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:37:49.343996 | 2b2106d3-a9b2-4a10-8b06-80a07a2a497c ==============================
[0m13:37:49.343996 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:37:49.346043 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:37:49.346043 [debug] [MainThread]: Tracking: tracking
[0m13:37:49.359997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001904E562B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001904E0CAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001904E0C8DC0>]}
[0m13:37:49.381074 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:37:49.399108 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:37:49.400021 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:37:49.401018 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:37:49.402050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b2106d3-a9b2-4a10-8b06-80a07a2a497c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001904E0C9AE0>]}
[0m13:37:50.741296 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:37:50.753303 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:37:50.758193 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:37:50.819090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190514F3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190514F2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190514F1C60>]}
[0m13:37:50.820075 [debug] [MainThread]: Flushing usage events
[0m13:37:51.210375 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:38:06.544419 | c9d04c77-de02-4284-9644-8b1e47ac0f39 ==============================
[0m13:38:06.544419 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:38:06.546323 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:38:06.547333 [debug] [MainThread]: Tracking: tracking
[0m13:38:06.565939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713F999930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713F365F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713F365930>]}
[0m13:38:06.580938 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:38:06.595437 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:38:06.597433 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:38:06.598430 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:38:06.599430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9d04c77-de02-4284-9644-8b1e47ac0f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713F367F10>]}
[0m13:38:07.444236 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:38:07.460329 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:38:07.465236 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:38:07.522242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714280EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714280D9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714280F8B0>]}
[0m13:38:07.522242 [debug] [MainThread]: Flushing usage events
[0m13:38:07.912363 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:44:37.516520 | c3f9f073-a148-4e12-85d9-8799ad44ec16 ==============================
[0m13:44:37.516520 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:44:37.521531 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:44:37.521531 [debug] [MainThread]: Tracking: tracking
[0m13:44:37.562510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021930A0E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021930A0F8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021930A0F8B0>]}
[0m13:44:37.640327 [debug] [MainThread]: Executing "git --help"
[0m13:44:37.688325 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:44:37.688325 [debug] [MainThread]: STDERR: "b''"
[0m13:44:37.696340 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:44:37.697365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:48.327563 [debug] [MainThread]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPSConnectionPool(host='localhost', port=8443): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000021931F16E60>: Failed to establish a new connection: [WinError 10061] Aucune connexion n’a pu être établie car l’ordinateur cible l’a expressément refusée')) executing HTTP request https://localhost:8443
[0m13:44:57.477599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192D945420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021931F172E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021931F17220>]}
[0m13:44:57.478761 [debug] [MainThread]: Flushing usage events
[0m13:44:57.866462 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:44:57.866462 [debug] [MainThread]: On debug: No close available on handle


============================== 2023-06-05 13:45:38.499391 | 26ca20c5-786a-4196-94e2-c7d9ddc61069 ==============================
[0m13:45:38.499391 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:45:38.511396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:45:38.511396 [debug] [MainThread]: Tracking: tracking
[0m13:45:38.526246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018637B18100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186374B96F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186374BA170>]}
[0m13:45:38.536246 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:45:38.544246 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:45:38.545282 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:45:38.546248 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:45:38.547246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26ca20c5-786a-4196-94e2-c7d9ddc61069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186374BA170>]}
[0m13:45:39.094641 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:45:39.094641 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:45:39.094641 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:45:39.142040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001863A8E2140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001863A8E25F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001863A8E2770>]}
[0m13:45:39.142040 [debug] [MainThread]: Flushing usage events
[0m13:45:39.518981 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:45:46.560974 | 19b72bd2-dd36-4dad-b97f-a1def92fe9b4 ==============================
[0m13:45:46.560974 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:45:46.560974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:45:46.560974 [debug] [MainThread]: Tracking: tracking
[0m13:45:46.585406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFD1EE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFD1EE6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFD1EE710>]}
[0m13:45:46.655072 [debug] [MainThread]: Executing "git --help"
[0m13:45:46.687679 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:45:46.687679 [debug] [MainThread]: STDERR: "b''"
[0m13:45:46.694679 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:45:46.695721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:55.221117 [debug] [MainThread]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPSConnectionPool(host='localhost', port=8443): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000016FFE636EC0>: Failed to establish a new connection: [WinError 10061] Aucune connexion n’a pu être établie car l’ordinateur cible l’a expressément refusée')) executing HTTP request https://localhost:8443
[0m13:46:04.379072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFA064B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFE6372B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FFE6372E0>]}
[0m13:46:04.380074 [debug] [MainThread]: Flushing usage events
[0m13:46:04.753202 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:46:04.755207 [debug] [MainThread]: On debug: No close available on handle


============================== 2023-06-05 13:46:45.704873 | 99e289eb-ec0b-442d-93db-62c236232671 ==============================
[0m13:46:45.704873 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:46:45.704873 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:46:45.704873 [debug] [MainThread]: Tracking: tracking
[0m13:46:45.730916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8170EEBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8170EE560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8170EDAE0>]}
[0m13:46:45.789055 [debug] [MainThread]: Executing "git --help"
[0m13:46:45.837501 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:46:45.837501 [debug] [MainThread]: STDERR: "b''"
[0m13:46:45.844510 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:46:45.845509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:54.346638 [debug] [MainThread]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPSConnectionPool(host='localhost', port=8143): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x000002D8185B6EF0>: Failed to establish a new connection: [WinError 10061] Aucune connexion n’a pu être établie car l’ordinateur cible l’a expressément refusée')) executing HTTP request https://localhost:8143
[0m13:47:03.493940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D813FE8BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8185B72E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8185B7310>]}
[0m13:47:03.495943 [debug] [MainThread]: Flushing usage events
[0m13:47:03.894695 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:47:03.895265 [debug] [MainThread]: On debug: No close available on handle


============================== 2023-06-05 13:47:17.492016 | ad819b2d-3b3b-4947-86e9-5043c1e8582c ==============================
[0m13:47:17.492016 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:47:17.492016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:47:17.492016 [debug] [MainThread]: Tracking: tracking
[0m13:47:17.509367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DDAFEB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DDAFF8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DDAFF8B0>]}
[0m13:47:17.577625 [debug] [MainThread]: Executing "git --help"
[0m13:47:17.616306 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:47:17.616306 [debug] [MainThread]: STDERR: "b''"
[0m13:47:17.622260 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:47:17.622260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:26.192316 [debug] [MainThread]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8143): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001F0DF006E60>: Failed to establish a new connection: [WinError 10061] Aucune connexion n’a pu être établie car l’ordinateur cible l’a expressément refusée')) executing HTTP request http://localhost:8143
[0m13:47:35.355087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DAA34B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DF0072B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DF007340>]}
[0m13:47:35.356093 [debug] [MainThread]: Flushing usage events
[0m13:47:35.725149 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:47:35.725149 [debug] [MainThread]: On debug: No close available on handle


============================== 2023-06-05 13:48:15.101247 | 441b0046-90e3-466f-90bb-6259d5c34409 ==============================
[0m13:48:15.101247 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:48:15.101247 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:48:15.101247 [debug] [MainThread]: Tracking: tracking
[0m13:48:15.121231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1B539EBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1B539E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1B539F220>]}
[0m13:48:15.188135 [debug] [MainThread]: Executing "git --help"
[0m13:48:15.223096 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:48:15.225124 [debug] [MainThread]: STDERR: "b''"
[0m13:48:15.231130 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:48:15.231130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:15.728681 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m13:48:15.728681 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:48:15.728681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1B1288910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1B22448B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1B285D930>]}
[0m13:48:15.734984 [debug] [MainThread]: Flushing usage events
[0m13:48:16.125386 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:48:16.125386 [debug] [MainThread]: On debug: Close


============================== 2023-06-05 13:48:21.875567 | 5817e0eb-641a-44f4-acee-26cb92fb2203 ==============================
[0m13:48:21.875567 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:48:21.875567 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:48:21.875567 [debug] [MainThread]: Tracking: tracking
[0m13:48:21.895492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B56730EAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B566598CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B56659BCD0>]}
[0m13:48:21.905004 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:48:21.914002 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:48:21.915006 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:48:21.916005 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:48:21.916005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5817e0eb-641a-44f4-acee-26cb92fb2203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B56659B760>]}
[0m13:48:22.454999 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:48:22.454999 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:48:22.454999 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:48:22.501672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5699EEE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5699EC520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5699EFC40>]}
[0m13:48:22.501672 [debug] [MainThread]: Flushing usage events
[0m13:48:22.863553 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:51:21.564098 | 2fa254ce-0ff5-48f0-8811-60da2ceb55e1 ==============================
[0m13:51:21.564098 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:51:21.579768 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:51:21.579768 [debug] [MainThread]: Tracking: tracking
[0m13:51:21.594954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639B54F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639B54E5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639B54F820>]}
[0m13:51:21.603955 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:51:21.612972 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:51:21.613954 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:51:21.614956 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:51:21.614956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2fa254ce-0ff5-48f0-8811-60da2ceb55e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639B53C460>]}
[0m13:51:22.128589 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:51:22.128589 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:51:22.144110 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:51:22.175759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639E94F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639E94C5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639E94E620>]}
[0m13:51:22.175759 [debug] [MainThread]: Flushing usage events
[0m13:51:22.568850 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:51:46.387708 | 41cbe142-d34c-42e1-877a-438ff74d62ba ==============================
[0m13:51:46.387708 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:51:46.387708 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:51:46.387708 [debug] [MainThread]: Tracking: tracking
[0m13:51:46.402454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC17008EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC17009B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1700B100>]}
[0m13:51:46.420967 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:51:46.435083 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:51:46.436969 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:51:46.437971 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:51:46.438974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41cbe142-d34c-42e1-877a-438ff74d62ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC16FF8B80>]}
[0m13:51:47.440663 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:51:47.440663 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:51:47.456296 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:51:47.487551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1A45E560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1A45E650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1A45ECB0>]}
[0m13:51:47.487551 [debug] [MainThread]: Flushing usage events
[0m13:51:47.879156 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:51:56.961866 | 671a8056-07c0-4707-9c51-b19b02f4c8bc ==============================
[0m13:51:56.961866 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:51:56.962867 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:51:56.963867 [debug] [MainThread]: Tracking: tracking
[0m13:51:56.977387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B663E7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B663E680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B663DA50>]}
[0m13:51:57.045188 [debug] [MainThread]: Executing "git --help"
[0m13:51:57.086401 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:51:57.086401 [debug] [MainThread]: STDERR: "b''"
[0m13:51:57.093401 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:51:57.094443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:59.150928 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m13:51:59.154904 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:51:59.156956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B25B4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B35677C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B3B7D930>]}
[0m13:51:59.157891 [debug] [MainThread]: Flushing usage events
[0m13:51:59.523077 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:51:59.528250 [debug] [MainThread]: On debug: Close


============================== 2023-06-05 13:53:58.607630 | 1723499d-6ac7-420e-891e-232323223a6a ==============================
[0m13:53:58.607630 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:53:58.609640 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:53:58.610634 [debug] [MainThread]: Tracking: tracking
[0m13:53:58.628668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8F520EA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8F520F8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8F520FA30>]}
[0m13:53:58.702946 [debug] [MainThread]: Executing "git --help"
[0m13:53:58.746184 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:53:58.746184 [debug] [MainThread]: STDERR: "b''"
[0m13:53:58.750399 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:53:58.751408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:59.331747 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m13:53:59.335747 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:53:59.336748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8F10D0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8F2084790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8F2502DA0>]}
[0m13:53:59.337947 [debug] [MainThread]: Flushing usage events
[0m13:53:59.739124 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:53:59.740124 [debug] [MainThread]: On debug: Close


============================== 2023-06-05 13:54:11.697515 | 0900e48a-315f-46c1-a0b8-0ed3de29c85b ==============================
[0m13:54:11.697515 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:54:11.698515 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:54:11.699499 [debug] [MainThread]: Tracking: tracking
[0m13:54:11.711718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BF208100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BEBA9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BEBABA00>]}
[0m13:54:11.721729 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m13:54:11.730719 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:54:11.731720 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:54:11.731720 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:54:11.732720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0900e48a-315f-46c1-a0b8-0ed3de29c85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3BEBAB580>]}
[0m13:54:12.236828 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m13:54:12.236828 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m13:54:12.236828 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m13:54:12.284984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C21021D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C2102110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3C21012D0>]}
[0m13:54:12.284984 [debug] [MainThread]: Flushing usage events
[0m13:54:12.646593 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 13:59:35.820790 | 457a7538-4b5e-4472-a268-72ad227778af ==============================
[0m13:59:35.820790 [info ] [MainThread]: Running with dbt=1.4.6
[0m13:59:35.836931 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:59:35.836931 [debug] [MainThread]: Tracking: tracking
[0m13:59:35.850243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3A1BE770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3A1BE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3A1BD9F0>]}
[0m13:59:35.919308 [debug] [MainThread]: Executing "git --help"
[0m13:59:35.958875 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:59:35.959893 [debug] [MainThread]: STDERR: "b''"
[0m13:59:35.965132 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m13:59:35.966158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:36.402182 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m13:59:36.417808 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:59:36.417808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D36144940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D370FB7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D37571C90>]}
[0m13:59:36.417808 [debug] [MainThread]: Flushing usage events
[0m13:59:36.824370 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:59:36.824370 [debug] [MainThread]: On debug: Close


============================== 2023-06-05 14:00:43.001759 | fbfdf451-963e-4101-9f91-63f80ca77a35 ==============================
[0m14:00:43.001759 [info ] [MainThread]: Running with dbt=1.4.6
[0m14:00:43.017398 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:00:43.017398 [debug] [MainThread]: Tracking: tracking
[0m14:00:43.017398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D52B8C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D52BBEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D52BB070>]}
[0m14:00:43.040071 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m14:00:43.048070 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:00:43.049071 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:00:43.050065 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:00:43.050065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fbfdf451-963e-4101-9f91-63f80ca77a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D52B8F10>]}
[0m14:00:43.599579 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m14:00:43.605690 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m14:00:43.605690 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m14:00:43.657437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D86EF760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D86EE560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D86EFE80>]}
[0m14:00:43.657437 [debug] [MainThread]: Flushing usage events
[0m14:00:44.043651 [error] [MainThread]: Encountered an error:
Runtime Error
  Cannot set database source in clickhouse!


============================== 2023-06-05 14:02:51.422961 | 79e2516d-c7c6-4738-a806-445f67df5f87 ==============================
[0m14:02:51.422961 [info ] [MainThread]: Running with dbt=1.4.6
[0m14:02:51.422961 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:02:51.422961 [debug] [MainThread]: Tracking: tracking
[0m14:02:51.438585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77FA89A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77FABE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77FABFD0>]}
[0m14:02:51.456388 [debug] [MainThread]: checksum: 0325e47f1211ebbdb24627f81d8289d705fdb573380364d07ab35982cb3d57cd, vars: {}, profile: None, target: None, version: 1.4.6
[0m14:02:51.466407 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:02:51.466407 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:02:51.466407 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:02:51.467623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79e2516d-c7c6-4738-a806-445f67df5f87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77FA8F70>]}
[0m14:02:51.967182 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m14:02:51.993489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77F9C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7B456B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7B45D570>]}
[0m14:02:51.994483 [debug] [MainThread]: Flushing usage events
[0m14:02:52.374745 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projet_dbt.weathergold' (models\gold\weathergold.sql) depends on a node named 'weathersil' which was not found
[0m16:08:45.392835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237854A75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023787CDA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023787CDA2C0>]}


============================== 16:08:45.398837 | d4eca219-bdf1-4d95-ae71-bb3fdf8b6511 ==============================
[0m16:08:45.398837 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:08:45.399836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:08:45.400838 [info ] [MainThread]: dbt version: 1.5.1
[0m16:08:45.401836 [info ] [MainThread]: python version: 3.10.9
[0m16:08:45.402837 [info ] [MainThread]: python path: C:\Users\eho.mbengue\AppData\Local\anaconda3\python.exe
[0m16:08:45.403842 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m16:08:45.404842 [info ] [MainThread]: Using profiles.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\profiles.yml
[0m16:08:45.406839 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\dbt_project.yml
[0m16:08:45.407838 [info ] [MainThread]: Configuration:
[0m16:08:45.530711 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:08:45.552151 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:08:45.553218 [info ] [MainThread]: Required dependencies:
[0m16:08:45.554230 [debug] [MainThread]: Executing "git --help"
[0m16:08:45.591386 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:08:45.592407 [debug] [MainThread]: STDERR: "b''"
[0m16:08:45.592407 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:08:45.594385 [info ] [MainThread]: Connection:
[0m16:08:45.595384 [info ] [MainThread]:   host: localhost
[0m16:08:45.595384 [info ] [MainThread]:   port: 8080
[0m16:08:45.596387 [info ] [MainThread]:   user: Trino
[0m16:08:45.597389 [info ] [MainThread]:   database: lakehouse
[0m16:08:45.598389 [info ] [MainThread]:   schema: bronze
[0m16:08:45.599387 [info ] [MainThread]:   cert: None
[0m16:08:45.600389 [info ] [MainThread]:   prepared_statements_enabled: True
[0m16:08:45.600389 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m16:08:45.601390 [debug] [MainThread]: Using trino connection "debug"
[0m16:08:45.602385 [debug] [MainThread]: On debug: select 1 as id
[0m16:08:45.602385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:45.709754 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m16:08:45.711344 [debug] [MainThread]: On debug: Close
[0m16:08:45.712424 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:08:45.714401 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:08:45.717025 [debug] [MainThread]: Command `dbt debug` succeeded at 16:08:45.716014 after 0.43 seconds
[0m16:08:45.718025 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:08:45.718025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237854A75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023784D45630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023784D46350>]}
[0m16:08:45.719022 [debug] [MainThread]: Flushing usage events
[0m17:45:52.875741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB6F775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB98565C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB9856380>]}


============================== 17:45:52.885350 | 205c7fa3-6b59-4eda-a619-7fd41b95999a ==============================
[0m17:45:52.885350 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:45:52.887335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:45:53.198458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '205c7fa3-6b59-4eda-a619-7fd41b95999a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB9856680>]}
[0m17:45:53.218879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '205c7fa3-6b59-4eda-a619-7fd41b95999a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB9B53790>]}
[0m17:45:53.252448 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m17:45:53.297587 [debug] [MainThread]: Failed to load parsed file from disk at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\target\partial_parse.msgpack: Field "nodes" of type MutableMapping[str, Union[AnalysisNode, SingularTestNode, HookNode, ModelNode, RPCNode, SqlNode, GenericTestNode, SnapshotNode, SeedNode]] in Manifest has invalid value {'model.projet_dbt.weatheronepoint': {'database': 'lakehouse', 'schema': 'bronze', 'name': 'weatheronepoint', 'resource_type': 'model', 'package_name': 'projet_dbt', 'path': 'bronze\\weatheronepoint.sql', 'original_file_path': 'models\\bronze\\weatheronepoint.sql', 'unique_id': 'model.projet_dbt.weatheronepoint', 'fqn': ['projet_dbt', 'bronze', 'weatheronepoint'], 'alias': 'weatheronepoint', 'checksum': {'name': 'sha256', 'checksum': 'c2e46f009fb67beaf47cc29bdb51372147ab9295aa6f6e18c908593abcaf8bd1'}, 'config': {'enabled': True, 'alias': None, 'schema': 'bronze', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': 'A dbt model using data from lakehouse.bronze.weatheronepoint', 'columns': {'_airbyte_ab_id': {'name': '_airbyte_ab_id', 'description': 'id', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, '_airbyte_emitted_at': {'name': '_airbyte_emitted_at', 'description': 'timestamp', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, '_airbyte_data': {'name': '_airbyte_data', 'description': 'Main data', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'projet_dbt://models\\bronze\\schema.yml', 'build_path': None, 'deferred': False, 'unrendered_config': {'schema': 'bronze', 'materialized': 'table'}, 'created_at': 1685966885.0439754, 'config_call_dict': {'materialized': 'table'}, 'relation_name': 'lakehouse.bronze.weatheronepoint', 'raw_code': '/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing "table" to "view" below \n*/\n\n{{ config(materialized=\'table\') }}\n\nwith source_data as (\n\n    SELECT\n    *\n    FROM  {{ source(\'source\', \'weather\') }}\n    WHERE\n    json_extract_scalar(_airbyte_data, \'$.coord.lon\') IS NOT NULL\n    AND json_extract_scalar(_airbyte_data, \'$.coord.lat\') IS NOT NULL\n)\n\nselect *\nfrom source_data\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/\n\n-- where id is not null', 'language': 'sql', 'refs': [], 'sources': [['source', 'weather']], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['source.projet_dbt.source.weather']}, 'compiled_path': None}, 'model.projet_dbt.weathergold': {'database': 'clickhouse', 'schema': 'gold', 'name': 'weathergold', 'resource_type': 'model', 'package_name': 'projet_dbt', 'path': 'gold\\weathergold.sql', 'original_file_path': 'models\\gold\\weathergold.sql', 'unique_id': 'model.projet_dbt.weathergold', 'fqn': ['projet_dbt', 'gold', 'weathergold'], 'alias': 'weathergold', 'checksum': {'name': 'sha256', 'checksum': 'c320688d659e8d09d2913ac274701ef835188e0ba34db074b202cf8d4044a1cf'}, 'config': {'enabled': True, 'alias': None, 'schema': 'gold', 'database': 'clickhouse', 'tags': [], 'meta': {}, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'schema': 'gold', 'materialized': 'table', 'database': 'clickhouse'}, 'created_at': 1685966885.013983, 'config_call_dict': {'materialized': 'table', 'database': 'clickhouse'}, 'relation_name': 'clickhouse.gold.weathergold', 'raw_code': "/*\r\n    Welcome to your gold dbt model!\r\n    Temperature, humidity, and wind speed.\r\n*/\r\n\r\n{{ config(materialized='table', database='clickhouse') }}\r\n\r\nwith silver_data as (\r\n\r\n    SELECT\r\n      coord_lon,\r\n      coord_lat,\r\n      CAST(main_temp AS FLOAT) AS main_temp,\r\n      CAST(main_humidity AS FLOAT) AS main_humidity,\r\n      CAST(wind_speed AS FLOAT) AS wind_speed\r\n    FROM  {{ ref('weathersil') }}\r\n\r\n)\r\n\r\nselect \r\n    coord_lon,\r\n    coord_lat,\r\n    AVG(main_temp) AS avg_temp,\r\n    AVG(main_humidity) AS avg_humidity,\r\n    AVG(wind_speed) AS avg_wind_speed\r\nfrom silver_data\r\ngroup by coord_lon, coord_lat", 'language': 'sql', 'refs': [['weathersil']], 'sources': [], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['model.projet_dbt.weathersil']}, 'compiled_path': None}, 'model.projet_dbt.weathersil': {'database': 'lakehouse', 'schema': 'silver', 'name': 'weathersil', 'resource_type': 'model', 'package_name': 'projet_dbt', 'path': 'silver\\weathersil.sql', 'original_file_path': 'models\\silver\\weathersil.sql', 'unique_id': 'model.projet_dbt.weathersil', 'fqn': ['projet_dbt', 'silver', 'weathersil'], 'alias': 'weathersil', 'checksum': {'name': 'sha256', 'checksum': '792d0639e2b21176e7edeab94be9540d751685ea8777b832f014e0bc7f08b030'}, 'config': {'enabled': True, 'alias': None, 'schema': 'silver', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'schema': 'silver', 'materialized': 'table'}, 'created_at': 1685966885.0177681, 'config_call_dict': {'materialized': 'table'}, 'relation_name': 'lakehouse.silver.weathersil', 'raw_code': '/*\r\n    Welcome to your first dbt model!\r\n    Did you know that you can also configure models directly within SQL files?\r\n    This will override configurations stated in dbt_project.yml\r\n\r\n    Try changing "table" to "view" below \r\n*/\r\n\r\n{{ config(materialized=\'table\') }}\r\n\r\nwith bronze_data  as (\r\n\r\n    SELECT\r\n  json_extract_scalar(_airbyte_data, \'$.coord.lon\') AS coord_lon,\r\n  json_extract_scalar(_airbyte_data, \'$.coord.lat\') AS coord_lat,\r\n  json_extract_scalar(_airbyte_data, \'$.weather[0].main\') AS weather_main,\r\n  json_extract_scalar(_airbyte_data, \'$.weather[0].description\') AS weather_description,\r\n  json_extract_scalar(_airbyte_data, \'$.main.temp\') AS main_temp,\r\n  json_extract_scalar(_airbyte_data, \'$.main.humidity\') AS main_humidity,\r\n  json_extract_scalar(_airbyte_data, \'$.wind.speed\') AS wind_speed,\r\n  json_extract_scalar(_airbyte_data, \'$.wind.deg\') AS wind_deg\r\n  FROM  {{ ref(\'weatheronepoint\') }}\r\n  WHERE\r\n  json_extract_scalar(_airbyte_data, \'$.coord.lon\') IS NOT NULL\r\n  AND json_extract_scalar(_airbyte_data, \'$.coord.lat\') IS NOT NULL\r\n\r\n)\r\n\r\nselect *\r\nfrom bronze_data \r\n\r\n/*\r\n    Uncomment the line below to remove records with null `id` values\r\n*/\r\n\r\n-- where id is not null', 'language': 'sql', 'refs': [['weatheronepoint']], 'sources': [], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['model.projet_dbt.weatheronepoint']}, 'compiled_path': None}, 'test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': '_airbyte_ab_id', 'model': "{{ get_where_subquery(ref('weatheronepoint')) }}"}, 'namespace': None}, 'database': 'lakehouse', 'schema': 'dbt_test__audit', 'name': 'not_null_weatheronepoint__airbyte_ab_id', 'resource_type': 'test', 'package_name': 'projet_dbt', 'path': 'not_null_weatheronepoint__airbyte_ab_id.sql', 'original_file_path': 'models\\bronze\\schema.yml', 'unique_id': 'test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492', 'fqn': ['projet_dbt', 'bronze', 'not_null_weatheronepoint__airbyte_ab_id'], 'alias': 'not_null_weatheronepoint__airbyte_ab_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1685966885.0585177, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weatheronepoint']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.projet_dbt.weatheronepoint']}, 'compiled_path': None, 'column_name': '_airbyte_ab_id', 'file_key_name': 'models.weatheronepoint'}, 'test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': '_airbyte_emitted_at', 'model': "{{ get_where_subquery(ref('weatheronepoint')) }}"}, 'namespace': None}, 'database': 'lakehouse', 'schema': 'dbt_test__audit', 'name': 'not_null_weatheronepoint__airbyte_emitted_at', 'resource_type': 'test', 'package_name': 'projet_dbt', 'path': 'not_null_weatheronepoint__airbyte_emitted_at.sql', 'original_file_path': 'models\\bronze\\schema.yml', 'unique_id': 'test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31', 'fqn': ['projet_dbt', 'bronze', 'not_null_weatheronepoint__airbyte_emitted_at'], 'alias': 'not_null_weatheronepoint__airbyte_emitted_at', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1685966885.0631435, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weatheronepoint']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.projet_dbt.weatheronepoint']}, 'compiled_path': None, 'column_name': '_airbyte_emitted_at', 'file_key_name': 'models.weatheronepoint'}, 'test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': '_airbyte_data', 'model': "{{ get_where_subquery(ref('weatheronepoint')) }}"}, 'namespace': None}, 'database': 'lakehouse', 'schema': 'dbt_test__audit', 'name': 'not_null_weatheronepoint__airbyte_data', 'resource_type': 'test', 'package_name': 'projet_dbt', 'path': 'not_null_weatheronepoint__airbyte_data.sql', 'original_file_path': 'models\\bronze\\schema.yml', 'unique_id': 'test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01', 'fqn': ['projet_dbt', 'bronze', 'not_null_weatheronepoint__airbyte_data'], 'alias': 'not_null_weatheronepoint__airbyte_data', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1685966885.0647163, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weatheronepoint']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.projet_dbt.weatheronepoint']}, 'compiled_path': None, 'column_name': '_airbyte_data', 'file_key_name': 'models.weatheronepoint'}}
[0m17:45:53.300095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '205c7fa3-6b59-4eda-a619-7fd41b95999a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB9B9AD40>]}
[0m17:45:55.633170 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:45:55.652996 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:45:55.660516 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m17:45:55.815283 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "source_weather".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("source", "weather").
  
  To fix this, change the name of one of these resources:
  - source.projet_dbt.source.weather (models\gold\sources.yml)
  - source.projet_dbt.source.weather (models\bronze\sources.yml)
[0m17:45:55.821122 [debug] [MainThread]: Command `dbt run` failed at 17:45:55.820120 after 3.16 seconds
[0m17:45:55.822179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB6F775E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB9D89FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB9D89F60>]}
[0m17:45:55.824124 [debug] [MainThread]: Flushing usage events
[0m17:46:11.150884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C179175E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C1A136560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C1A136260>]}


============================== 17:46:11.157416 | 3d6c80c5-cd08-4a32-b823-f0b71d94c1e5 ==============================
[0m17:46:11.157416 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:46:11.159416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:46:11.159416 [info ] [MainThread]: dbt version: 1.5.1
[0m17:46:11.161722 [info ] [MainThread]: python version: 3.10.9
[0m17:46:11.163745 [info ] [MainThread]: python path: C:\Users\eho.mbengue\AppData\Local\anaconda3\python.exe
[0m17:46:11.166290 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m17:46:11.169771 [info ] [MainThread]: Using profiles.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\profiles.yml
[0m17:46:11.171271 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\dbt_project.yml
[0m17:46:11.173499 [info ] [MainThread]: Configuration:
[0m17:46:11.361503 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:46:11.395247 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:46:11.397172 [info ] [MainThread]: Required dependencies:
[0m17:46:11.398170 [debug] [MainThread]: Executing "git --help"
[0m17:46:11.457051 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:46:11.458075 [debug] [MainThread]: STDERR: "b''"
[0m17:46:11.459127 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:46:11.460076 [info ] [MainThread]: Connection:
[0m17:46:11.462047 [info ] [MainThread]:   host: localhost
[0m17:46:11.463042 [info ] [MainThread]:   port: 8080
[0m17:46:11.465042 [info ] [MainThread]:   user: Trino
[0m17:46:11.466566 [info ] [MainThread]:   database: lakehouse
[0m17:46:11.468597 [info ] [MainThread]:   schema: bronze
[0m17:46:11.469566 [info ] [MainThread]:   cert: None
[0m17:46:11.471569 [info ] [MainThread]:   prepared_statements_enabled: True
[0m17:46:11.476109 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m17:46:11.477504 [debug] [MainThread]: Using trino connection "debug"
[0m17:46:11.478983 [debug] [MainThread]: On debug: select 1 as id
[0m17:46:11.480002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:11.560183 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:46:11.563467 [debug] [MainThread]: On debug: Close
[0m17:46:11.565094 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:46:11.566848 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:46:11.570450 [debug] [MainThread]: Command `dbt debug` succeeded at 17:46:11.568900 after 0.45 seconds
[0m17:46:11.571464 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:46:11.572925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C179175E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C171B6620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C171B62F0>]}
[0m17:46:11.576188 [debug] [MainThread]: Flushing usage events
[0m17:46:52.346452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BAE275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BD6DA590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BD6DA350>]}


============================== 17:46:52.351470 | 353f58b5-70f9-432c-bb88-a90f7c6db72d ==============================
[0m17:46:52.351470 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:46:52.353468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:46:52.551288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '353f58b5-70f9-432c-bb88-a90f7c6db72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BD6DA650>]}
[0m17:46:52.567533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '353f58b5-70f9-432c-bb88-a90f7c6db72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BD9D3520>]}
[0m17:46:52.583016 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m17:46:52.591507 [debug] [MainThread]: Failed to load parsed file from disk at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\target\partial_parse.msgpack: Field "nodes" of type MutableMapping[str, Union[AnalysisNode, SingularTestNode, HookNode, ModelNode, RPCNode, SqlNode, GenericTestNode, SnapshotNode, SeedNode]] in Manifest has invalid value {'model.projet_dbt.weatheronepoint': {'database': 'lakehouse', 'schema': 'bronze', 'name': 'weatheronepoint', 'resource_type': 'model', 'package_name': 'projet_dbt', 'path': 'bronze\\weatheronepoint.sql', 'original_file_path': 'models\\bronze\\weatheronepoint.sql', 'unique_id': 'model.projet_dbt.weatheronepoint', 'fqn': ['projet_dbt', 'bronze', 'weatheronepoint'], 'alias': 'weatheronepoint', 'checksum': {'name': 'sha256', 'checksum': 'c2e46f009fb67beaf47cc29bdb51372147ab9295aa6f6e18c908593abcaf8bd1'}, 'config': {'enabled': True, 'alias': None, 'schema': 'bronze', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': 'A dbt model using data from lakehouse.bronze.weatheronepoint', 'columns': {'_airbyte_ab_id': {'name': '_airbyte_ab_id', 'description': 'id', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, '_airbyte_emitted_at': {'name': '_airbyte_emitted_at', 'description': 'timestamp', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}, '_airbyte_data': {'name': '_airbyte_data', 'description': 'Main data', 'meta': {}, 'data_type': None, 'quote': None, 'tags': []}}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': 'projet_dbt://models\\bronze\\schema.yml', 'build_path': None, 'deferred': False, 'unrendered_config': {'schema': 'bronze', 'materialized': 'table'}, 'created_at': 1685966885.0439754, 'config_call_dict': {'materialized': 'table'}, 'relation_name': 'lakehouse.bronze.weatheronepoint', 'raw_code': '/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing "table" to "view" below \n*/\n\n{{ config(materialized=\'table\') }}\n\nwith source_data as (\n\n    SELECT\n    *\n    FROM  {{ source(\'source\', \'weather\') }}\n    WHERE\n    json_extract_scalar(_airbyte_data, \'$.coord.lon\') IS NOT NULL\n    AND json_extract_scalar(_airbyte_data, \'$.coord.lat\') IS NOT NULL\n)\n\nselect *\nfrom source_data\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/\n\n-- where id is not null', 'language': 'sql', 'refs': [], 'sources': [['source', 'weather']], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['source.projet_dbt.source.weather']}, 'compiled_path': None}, 'model.projet_dbt.weathergold': {'database': 'clickhouse', 'schema': 'gold', 'name': 'weathergold', 'resource_type': 'model', 'package_name': 'projet_dbt', 'path': 'gold\\weathergold.sql', 'original_file_path': 'models\\gold\\weathergold.sql', 'unique_id': 'model.projet_dbt.weathergold', 'fqn': ['projet_dbt', 'gold', 'weathergold'], 'alias': 'weathergold', 'checksum': {'name': 'sha256', 'checksum': 'c320688d659e8d09d2913ac274701ef835188e0ba34db074b202cf8d4044a1cf'}, 'config': {'enabled': True, 'alias': None, 'schema': 'gold', 'database': 'clickhouse', 'tags': [], 'meta': {}, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'schema': 'gold', 'materialized': 'table', 'database': 'clickhouse'}, 'created_at': 1685966885.013983, 'config_call_dict': {'materialized': 'table', 'database': 'clickhouse'}, 'relation_name': 'clickhouse.gold.weathergold', 'raw_code': "/*\r\n    Welcome to your gold dbt model!\r\n    Temperature, humidity, and wind speed.\r\n*/\r\n\r\n{{ config(materialized='table', database='clickhouse') }}\r\n\r\nwith silver_data as (\r\n\r\n    SELECT\r\n      coord_lon,\r\n      coord_lat,\r\n      CAST(main_temp AS FLOAT) AS main_temp,\r\n      CAST(main_humidity AS FLOAT) AS main_humidity,\r\n      CAST(wind_speed AS FLOAT) AS wind_speed\r\n    FROM  {{ ref('weathersil') }}\r\n\r\n)\r\n\r\nselect \r\n    coord_lon,\r\n    coord_lat,\r\n    AVG(main_temp) AS avg_temp,\r\n    AVG(main_humidity) AS avg_humidity,\r\n    AVG(wind_speed) AS avg_wind_speed\r\nfrom silver_data\r\ngroup by coord_lon, coord_lat", 'language': 'sql', 'refs': [['weathersil']], 'sources': [], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['model.projet_dbt.weathersil']}, 'compiled_path': None}, 'model.projet_dbt.weathersil': {'database': 'lakehouse', 'schema': 'silver', 'name': 'weathersil', 'resource_type': 'model', 'package_name': 'projet_dbt', 'path': 'silver\\weathersil.sql', 'original_file_path': 'models\\silver\\weathersil.sql', 'unique_id': 'model.projet_dbt.weathersil', 'fqn': ['projet_dbt', 'silver', 'weathersil'], 'alias': 'weathersil', 'checksum': {'name': 'sha256', 'checksum': '792d0639e2b21176e7edeab94be9540d751685ea8777b832f014e0bc7f08b030'}, 'config': {'enabled': True, 'alias': None, 'schema': 'silver', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'incremental_strategy': None, 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'grants': {}, 'packages': [], 'docs': {'show': True, 'node_color': None}, 'post-hook': [], 'pre-hook': []}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'schema': 'silver', 'materialized': 'table'}, 'created_at': 1685966885.0177681, 'config_call_dict': {'materialized': 'table'}, 'relation_name': 'lakehouse.silver.weathersil', 'raw_code': '/*\r\n    Welcome to your first dbt model!\r\n    Did you know that you can also configure models directly within SQL files?\r\n    This will override configurations stated in dbt_project.yml\r\n\r\n    Try changing "table" to "view" below \r\n*/\r\n\r\n{{ config(materialized=\'table\') }}\r\n\r\nwith bronze_data  as (\r\n\r\n    SELECT\r\n  json_extract_scalar(_airbyte_data, \'$.coord.lon\') AS coord_lon,\r\n  json_extract_scalar(_airbyte_data, \'$.coord.lat\') AS coord_lat,\r\n  json_extract_scalar(_airbyte_data, \'$.weather[0].main\') AS weather_main,\r\n  json_extract_scalar(_airbyte_data, \'$.weather[0].description\') AS weather_description,\r\n  json_extract_scalar(_airbyte_data, \'$.main.temp\') AS main_temp,\r\n  json_extract_scalar(_airbyte_data, \'$.main.humidity\') AS main_humidity,\r\n  json_extract_scalar(_airbyte_data, \'$.wind.speed\') AS wind_speed,\r\n  json_extract_scalar(_airbyte_data, \'$.wind.deg\') AS wind_deg\r\n  FROM  {{ ref(\'weatheronepoint\') }}\r\n  WHERE\r\n  json_extract_scalar(_airbyte_data, \'$.coord.lon\') IS NOT NULL\r\n  AND json_extract_scalar(_airbyte_data, \'$.coord.lat\') IS NOT NULL\r\n\r\n)\r\n\r\nselect *\r\nfrom bronze_data \r\n\r\n/*\r\n    Uncomment the line below to remove records with null `id` values\r\n*/\r\n\r\n-- where id is not null', 'language': 'sql', 'refs': [['weatheronepoint']], 'sources': [], 'metrics': [], 'depends_on': {'macros': [], 'nodes': ['model.projet_dbt.weatheronepoint']}, 'compiled_path': None}, 'test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': '_airbyte_ab_id', 'model': "{{ get_where_subquery(ref('weatheronepoint')) }}"}, 'namespace': None}, 'database': 'lakehouse', 'schema': 'dbt_test__audit', 'name': 'not_null_weatheronepoint__airbyte_ab_id', 'resource_type': 'test', 'package_name': 'projet_dbt', 'path': 'not_null_weatheronepoint__airbyte_ab_id.sql', 'original_file_path': 'models\\bronze\\schema.yml', 'unique_id': 'test.projet_dbt.not_null_weatheronepoint__airbyte_ab_id.cff31af492', 'fqn': ['projet_dbt', 'bronze', 'not_null_weatheronepoint__airbyte_ab_id'], 'alias': 'not_null_weatheronepoint__airbyte_ab_id', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1685966885.0585177, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weatheronepoint']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.projet_dbt.weatheronepoint']}, 'compiled_path': None, 'column_name': '_airbyte_ab_id', 'file_key_name': 'models.weatheronepoint'}, 'test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': '_airbyte_emitted_at', 'model': "{{ get_where_subquery(ref('weatheronepoint')) }}"}, 'namespace': None}, 'database': 'lakehouse', 'schema': 'dbt_test__audit', 'name': 'not_null_weatheronepoint__airbyte_emitted_at', 'resource_type': 'test', 'package_name': 'projet_dbt', 'path': 'not_null_weatheronepoint__airbyte_emitted_at.sql', 'original_file_path': 'models\\bronze\\schema.yml', 'unique_id': 'test.projet_dbt.not_null_weatheronepoint__airbyte_emitted_at.5666929a31', 'fqn': ['projet_dbt', 'bronze', 'not_null_weatheronepoint__airbyte_emitted_at'], 'alias': 'not_null_weatheronepoint__airbyte_emitted_at', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1685966885.0631435, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weatheronepoint']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.projet_dbt.weatheronepoint']}, 'compiled_path': None, 'column_name': '_airbyte_emitted_at', 'file_key_name': 'models.weatheronepoint'}, 'test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01': {'test_metadata': {'name': 'not_null', 'kwargs': {'column_name': '_airbyte_data', 'model': "{{ get_where_subquery(ref('weatheronepoint')) }}"}, 'namespace': None}, 'database': 'lakehouse', 'schema': 'dbt_test__audit', 'name': 'not_null_weatheronepoint__airbyte_data', 'resource_type': 'test', 'package_name': 'projet_dbt', 'path': 'not_null_weatheronepoint__airbyte_data.sql', 'original_file_path': 'models\\bronze\\schema.yml', 'unique_id': 'test.projet_dbt.not_null_weatheronepoint__airbyte_data.bf0b4fac01', 'fqn': ['projet_dbt', 'bronze', 'not_null_weatheronepoint__airbyte_data'], 'alias': 'not_null_weatheronepoint__airbyte_data', 'checksum': {'name': 'none', 'checksum': ''}, 'config': {'enabled': True, 'alias': None, 'schema': 'dbt_test__audit', 'database': None, 'tags': [], 'meta': {}, 'materialized': 'test', 'severity': 'ERROR', 'store_failures': None, 'where': None, 'limit': None, 'fail_calc': 'count(*)', 'warn_if': '!= 0', 'error_if': '!= 0'}, 'tags': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True, 'node_color': None}, 'patch_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1685966885.0647163, 'config_call_dict': {}, 'relation_name': None, 'raw_code': '{{ test_not_null(**_dbt_generic_test_kwargs) }}', 'language': 'sql', 'refs': [['weatheronepoint']], 'sources': [], 'metrics': [], 'depends_on': {'macros': ['macro.dbt.test_not_null'], 'nodes': ['model.projet_dbt.weatheronepoint']}, 'compiled_path': None, 'column_name': '_airbyte_data', 'file_key_name': 'models.weatheronepoint'}}
[0m17:46:52.593499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '353f58b5-70f9-432c-bb88-a90f7c6db72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BDA1A0B0>]}
[0m17:46:53.406603 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:46:53.421163 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:46:53.426195 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m17:46:53.565900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '353f58b5-70f9-432c-bb88-a90f7c6db72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BDBF3910>]}
[0m17:46:53.576025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '353f58b5-70f9-432c-bb88-a90f7c6db72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BDBF3940>]}
[0m17:46:53.576025 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:46:53.578026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '353f58b5-70f9-432c-bb88-a90f7c6db72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BDBF3A60>]}
[0m17:46:53.580029 [info ] [MainThread]: 
[0m17:46:53.582035 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:46:53.587562 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:46:53.609524 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:46:53.610523 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:46:53.611528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:54.296023 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:46:54.299139 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:46:54.307448 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:46:54.308447 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:46:54.309447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:54.445355 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:46:54.449069 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:46:54.457443 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:46:54.458441 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:46:54.458441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:54.596335 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:46:54.600412 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:46:54.605042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_gold)
[0m17:46:54.608332 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "gold"
"
[0m17:46:54.618578 [debug] [ThreadPool]: Using trino connection "create_lakehouse_gold"
[0m17:46:54.621145 [debug] [ThreadPool]: On create_lakehouse_gold: create schema if not exists lakehouse.gold
[0m17:46:54.622177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:55.117907 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_154654_00297_h3s8u
[0m17:46:55.119638 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/gold.db, failed to create database gold", query_id=20230605_154654_00297_h3s8u)
[0m17:46:55.121476 [debug] [ThreadPool]: On create_lakehouse_gold: ROLLBACK
[0m17:46:55.123614 [debug] [ThreadPool]: On create_lakehouse_gold: Close
[0m17:46:55.127834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:55.128994 [debug] [MainThread]: Connection 'create_lakehouse_gold' was properly closed.
[0m17:46:55.130013 [info ] [MainThread]: 
[0m17:46:55.132033 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m17:46:55.134036 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/gold.db, failed to create database gold", query_id=20230605_154654_00297_h3s8u)
[0m17:46:55.137126 [debug] [MainThread]: Command `dbt run` failed at 17:46:55.137126 after 2.82 seconds
[0m17:46:55.138131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BAE275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BDCC36A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BDCC37C0>]}
[0m17:46:55.140125 [debug] [MainThread]: Flushing usage events
[0m18:03:55.156807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C2EB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C56FA5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C56FA380>]}


============================== 18:03:55.164324 | a82f6d6a-5360-482a-99ff-c5a6eb9ad185 ==============================
[0m18:03:55.164324 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:03:55.166326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:03:55.449891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a82f6d6a-5360-482a-99ff-c5a6eb9ad185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C56FA680>]}
[0m18:03:55.469016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a82f6d6a-5360-482a-99ff-c5a6eb9ad185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C59F3790>]}
[0m18:03:55.500231 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:03:56.861585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:56.862233 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:56.872353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a82f6d6a-5360-482a-99ff-c5a6eb9ad185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C5C017E0>]}
[0m18:03:56.882521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a82f6d6a-5360-482a-99ff-c5a6eb9ad185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C5AE5E40>]}
[0m18:03:56.883524 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:03:56.884526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a82f6d6a-5360-482a-99ff-c5a6eb9ad185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C5AE6080>]}
[0m18:03:56.887533 [info ] [MainThread]: 
[0m18:03:56.888533 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:03:56.893480 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:03:56.915160 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:03:56.916140 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:03:56.918141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:59.247760 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m18:03:59.250427 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:03:59.259426 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:03:59.260440 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:03:59.262975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:59.543422 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:59.548360 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:03:59.558392 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:03:59.559913 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:03:59.561474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:59.899584 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:59.902114 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:03:59.906651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_gold)
[0m18:03:59.908183 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "gold"
"
[0m18:03:59.919261 [debug] [ThreadPool]: Using trino connection "create_lakehouse_gold"
[0m18:03:59.920266 [debug] [ThreadPool]: On create_lakehouse_gold: create schema if not exists lakehouse.gold
[0m18:03:59.921785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:00.145799 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230605_160359_00003_zgdgn
[0m18:04:00.146994 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/gold.db, failed to create database gold", query_id=20230605_160359_00003_zgdgn)
[0m18:04:00.147556 [debug] [ThreadPool]: On create_lakehouse_gold: ROLLBACK
[0m18:04:00.148581 [debug] [ThreadPool]: On create_lakehouse_gold: Close
[0m18:04:00.152085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:00.153598 [debug] [MainThread]: Connection 'create_lakehouse_gold' was properly closed.
[0m18:04:00.154614 [info ] [MainThread]: 
[0m18:04:00.158148 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m18:04:00.161653 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/gold.db, failed to create database gold", query_id=20230605_160359_00003_zgdgn)
[0m18:04:00.169207 [debug] [MainThread]: Command `dbt run` failed at 18:04:00.168208 after 5.22 seconds
[0m18:04:00.171724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C2EB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C5C9B4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C5C9B610>]}
[0m18:04:00.173743 [debug] [MainThread]: Flushing usage events
[0m18:06:51.040948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128B847F5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BAC9A620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BAC9A3B0>]}


============================== 18:06:51.045861 | d509e948-7880-461c-b59b-494f322fae2b ==============================
[0m18:06:51.045861 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:06:51.046894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:06:51.251620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd509e948-7880-461c-b59b-494f322fae2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BAC9A6E0>]}
[0m18:06:51.267948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd509e948-7880-461c-b59b-494f322fae2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BAF9B5B0>]}
[0m18:06:51.283616 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m18:06:51.293265 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:06:51.295262 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c
[0m18:06:51.295262 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:06:51.297263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd509e948-7880-461c-b59b-494f322fae2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BAFDFA90>]}
[0m18:06:52.255200 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:06:52.271054 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:06:52.280084 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:06:52.433026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd509e948-7880-461c-b59b-494f322fae2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128B7D04D90>]}
[0m18:06:52.444130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd509e948-7880-461c-b59b-494f322fae2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BB1A4790>]}
[0m18:06:52.444130 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:06:52.446134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd509e948-7880-461c-b59b-494f322fae2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BB0DDA50>]}
[0m18:06:52.448127 [info ] [MainThread]: 
[0m18:06:52.450973 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:06:52.456204 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m18:06:52.481011 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m18:06:52.481980 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m18:06:52.482938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:53.135215 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:06:53.139673 [debug] [ThreadPool]: On list_clickhouse: Close
[0m18:06:53.146535 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_silver'
[0m18:06:53.175039 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m18:06:53.176874 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:06:53.177873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:55.356721 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m18:06:55.361346 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m18:06:55.363669 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m18:06:55.368790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m18:06:55.386090 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m18:06:55.387143 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:06:55.388692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:56.041509 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:06:56.045168 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m18:06:56.046489 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m18:06:56.049820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m18:06:56.060984 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m18:06:56.063113 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:06:56.064112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:56.650196 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:06:56.655353 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m18:06:56.656517 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m18:06:56.659705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd509e948-7880-461c-b59b-494f322fae2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BAF71D20>]}
[0m18:06:56.663151 [debug] [MainThread]: On master: COMMIT
[0m18:06:56.666181 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m18:06:56.670817 [info ] [MainThread]: 
[0m18:06:56.704267 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m18:06:56.707839 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m18:06:56.714517 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m18:06:56.717274 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m18:06:56.730959 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m18:06:56.739717 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 18:06:56.719275 => 18:06:56.737735
[0m18:06:56.741823 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m18:06:56.867425 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m18:06:56.875975 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:06:56.877520 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS FLOAT) AS main_temp,
      CAST(main_humidity AS FLOAT) AS main_humidity,
      CAST(wind_speed AS FLOAT) AS wind_speed
    FROM  clickhouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m18:06:56.878521 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:57.076252 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230605_160656_00008_zgdgn
[0m18:06:57.079059 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 19:11: Schema 'silver' does not exist", query_id=20230605_160656_00008_zgdgn)
[0m18:06:57.082000 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 18:06:56.744811 => 18:06:57.080803
[0m18:06:57.083035 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m18:06:57.084043 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m18:06:57.398251 [debug] [Thread-1 (]: Database Error in model weathergold (models\gold\weathergold.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 19:11: Schema 'silver' does not exist", query_id=20230605_160656_00008_zgdgn)
  compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m18:06:57.399248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd509e948-7880-461c-b59b-494f322fae2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BB172710>]}
[0m18:06:57.400761 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.weathergold ......................... [[31mERROR[0m in 0.69s]
[0m18:06:57.407168 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m18:06:57.416527 [debug] [MainThread]: On master: COMMIT
[0m18:06:57.420129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:57.422705 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m18:06:57.424557 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m18:06:57.425724 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m18:06:57.427864 [info ] [MainThread]: 
[0m18:06:57.429863 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m18:06:57.434478 [debug] [MainThread]: Command end result
[0m18:06:57.452046 [info ] [MainThread]: 
[0m18:06:57.454588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:06:57.459134 [info ] [MainThread]: 
[0m18:06:57.462174 [error] [MainThread]: [33mDatabase Error in model weathergold (models\gold\weathergold.sql)[0m
[0m18:06:57.465201 [error] [MainThread]:   TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 19:11: Schema 'silver' does not exist", query_id=20230605_160656_00008_zgdgn)
[0m18:06:57.468196 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m18:06:57.471199 [info ] [MainThread]: 
[0m18:06:57.474365 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:06:57.478917 [debug] [MainThread]: Command `dbt run` failed at 18:06:57.477911 after 6.47 seconds
[0m18:06:57.481425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128B847F5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BAF9B5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128BB292B00>]}
[0m18:06:57.483451 [debug] [MainThread]: Flushing usage events
[0m18:09:52.686674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5787175E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57AFFA5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57AFFA380>]}


============================== 18:09:52.692187 | 166cd045-d1c0-4960-a96c-841ab2032b16 ==============================
[0m18:09:52.692187 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:09:52.693189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:09:52.950306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '166cd045-d1c0-4960-a96c-841ab2032b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57AFFA6B0>]}
[0m18:09:52.970642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '166cd045-d1c0-4960-a96c-841ab2032b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57B2FBA00>]}
[0m18:09:53.001287 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m18:09:54.040190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:09:54.041183 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\bronze\sources.yml
[0m18:09:54.042125 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\gold\weathergold.sql
[0m18:09:54.068719 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:09:54.116504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '166cd045-d1c0-4960-a96c-841ab2032b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57B5A00D0>]}
[0m18:09:54.127030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '166cd045-d1c0-4960-a96c-841ab2032b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57B54D480>]}
[0m18:09:54.129019 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:09:54.131072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '166cd045-d1c0-4960-a96c-841ab2032b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57B54CD00>]}
[0m18:09:54.135412 [info ] [MainThread]: 
[0m18:09:54.141544 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:09:54.144825 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m18:09:54.174137 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m18:09:54.175133 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m18:09:54.176132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:54.433201 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:09:54.436075 [debug] [ThreadPool]: On list_clickhouse: Close
[0m18:09:54.442635 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_bronze'
[0m18:09:54.462984 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m18:09:54.464496 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:09:54.465513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:54.888914 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:09:54.893943 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m18:09:54.896528 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m18:09:54.901061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_silver)
[0m18:09:54.911428 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m18:09:54.913423 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:09:54.914905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:55.310019 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:09:55.312675 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m18:09:55.312675 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m18:09:55.315383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_gold)
[0m18:09:55.320951 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m18:09:55.320951 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:09:55.328910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:55.743353 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:09:55.746471 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m18:09:55.748011 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m18:09:55.751467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '166cd045-d1c0-4960-a96c-841ab2032b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57B54F040>]}
[0m18:09:55.754487 [debug] [MainThread]: On master: COMMIT
[0m18:09:55.756585 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m18:09:55.758584 [info ] [MainThread]: 
[0m18:09:55.783312 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m18:09:55.786413 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m18:09:55.793662 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m18:09:55.796206 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m18:09:55.811565 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m18:09:55.816599 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 18:09:55.798206 => 18:09:55.815592
[0m18:09:55.817599 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m18:09:55.903871 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m18:09:55.913596 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:09:55.916026 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS FLOAT) AS main_temp,
      CAST(main_humidity AS FLOAT) AS main_humidity,
      CAST(wind_speed AS FLOAT) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m18:09:55.916674 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:09:58.307418 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230605_160955_00013_zgdgn
[0m18:09:58.308037 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 16:7: Unknown type: FLOAT", query_id=20230605_160955_00013_zgdgn)
[0m18:09:58.309180 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 18:09:55.819583 => 18:09:58.309180
[0m18:09:58.310291 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m18:09:58.311447 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m18:09:58.445996 [debug] [Thread-1 (]: Database Error in model weathergold (models\gold\weathergold.sql)
  TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 16:7: Unknown type: FLOAT", query_id=20230605_160955_00013_zgdgn)
  compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m18:09:58.446995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '166cd045-d1c0-4960-a96c-841ab2032b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57B623460>]}
[0m18:09:58.448998 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.weathergold ......................... [[31mERROR[0m in 2.66s]
[0m18:09:58.450285 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m18:09:58.454302 [debug] [MainThread]: On master: COMMIT
[0m18:09:58.456312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:58.458303 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m18:09:58.459304 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m18:09:58.460301 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m18:09:58.461398 [info ] [MainThread]: 
[0m18:09:58.462398 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m18:09:58.464397 [debug] [MainThread]: Command end result
[0m18:09:58.477705 [info ] [MainThread]: 
[0m18:09:58.479637 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:09:58.481171 [info ] [MainThread]: 
[0m18:09:58.482526 [error] [MainThread]: [33mDatabase Error in model weathergold (models\gold\weathergold.sql)[0m
[0m18:09:58.485517 [error] [MainThread]:   TrinoUserError(type=USER_ERROR, name=TYPE_MISMATCH, message="line 16:7: Unknown type: FLOAT", query_id=20230605_160955_00013_zgdgn)
[0m18:09:58.487943 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m18:09:58.491499 [info ] [MainThread]: 
[0m18:09:58.493909 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:09:58.496020 [debug] [MainThread]: Command `dbt run` failed at 18:09:58.496020 after 6.01 seconds
[0m18:09:58.497039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5787175E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57B4DA620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F57B622DA0>]}
[0m18:09:58.498037 [debug] [MainThread]: Flushing usage events
[0m18:12:07.457949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60CDB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60F60A680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60F60A350>]}


============================== 18:12:07.461986 | d3ea7229-e75f-45d6-890f-eeba885a1663 ==============================
[0m18:12:07.461986 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:12:07.464501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:12:07.672982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3ea7229-e75f-45d6-890f-eeba885a1663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60F60A620>]}
[0m18:12:07.690182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3ea7229-e75f-45d6-890f-eeba885a1663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60F90B5B0>]}
[0m18:12:07.703758 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m18:12:07.777162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:12:07.778281 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\gold\weathergold.sql
[0m18:12:07.799766 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:12:07.832888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3ea7229-e75f-45d6-890f-eeba885a1663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60FB700D0>]}
[0m18:12:07.842019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3ea7229-e75f-45d6-890f-eeba885a1663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60F9F20B0>]}
[0m18:12:07.843016 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:12:07.844017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ea7229-e75f-45d6-890f-eeba885a1663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60F9F2170>]}
[0m18:12:07.846019 [info ] [MainThread]: 
[0m18:12:07.848017 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:12:07.853266 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m18:12:07.877086 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m18:12:07.878077 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m18:12:07.879058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:08.045575 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:12:08.047746 [debug] [ThreadPool]: On list_clickhouse: Close
[0m18:12:08.053956 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_gold'
[0m18:12:08.067939 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m18:12:08.068939 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:12:08.070457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:08.360184 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:12:08.363087 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m18:12:08.365662 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m18:12:08.369668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_silver)
[0m18:12:08.381096 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m18:12:08.382092 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:12:08.384094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:08.668396 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:12:08.671927 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m18:12:08.673927 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m18:12:08.677361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m18:12:08.689977 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m18:12:08.691516 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:12:08.692517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:09.071603 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:12:09.073356 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m18:12:09.075926 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m18:12:09.078933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ea7229-e75f-45d6-890f-eeba885a1663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60F9F0E80>]}
[0m18:12:09.081460 [debug] [MainThread]: On master: COMMIT
[0m18:12:09.085003 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m18:12:09.087807 [info ] [MainThread]: 
[0m18:12:09.103404 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m18:12:09.105970 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m18:12:09.112500 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m18:12:09.113498 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m18:12:09.126694 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m18:12:09.132215 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 18:12:09.115026 => 18:12:09.131211
[0m18:12:09.133215 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m18:12:09.229047 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m18:12:09.236187 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:12:09.237188 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m18:12:09.238191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:12:11.433571 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:12:11.449380 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:12:11.450963 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m18:12:11.558273 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:12:11.576716 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:12:11.581171 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m18:12:11.651849 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:12:11.696097 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 18:12:09.135786 => 18:12:11.696097
[0m18:12:11.697069 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m18:12:11.699078 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m18:12:11.702278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3ea7229-e75f-45d6-890f-eeba885a1663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60FC43DF0>]}
[0m18:12:11.704802 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 2.59s]
[0m18:12:11.707819 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m18:12:11.713011 [debug] [MainThread]: On master: COMMIT
[0m18:12:11.717184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:11.718181 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m18:12:11.721271 [debug] [MainThread]: Connection 'list_clickhouse_bronze' was properly closed.
[0m18:12:11.723286 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m18:12:11.725822 [info ] [MainThread]: 
[0m18:12:11.728348 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m18:12:11.732912 [debug] [MainThread]: Command end result
[0m18:12:11.754130 [info ] [MainThread]: 
[0m18:12:11.758584 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:11.762127 [info ] [MainThread]: 
[0m18:12:11.765125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:12:11.769843 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:11.768814 after 4.34 seconds
[0m18:12:11.771068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60CDB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60FB07340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60CE63B20>]}
[0m18:12:11.773078 [debug] [MainThread]: Flushing usage events
[0m16:14:51.071812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208717F75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020874076680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020874076350>]}


============================== 16:14:51.080472 | b03f740c-1d2e-47ea-a64c-174e1f852865 ==============================
[0m16:14:51.080472 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:14:51.082522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:14:51.326284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b03f740c-1d2e-47ea-a64c-174e1f852865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020874076620>]}
[0m16:14:51.341481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b03f740c-1d2e-47ea-a64c-174e1f852865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020874373520>]}
[0m16:14:51.352399 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:14:51.394848 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:14:51.402958 [debug] [MainThread]: previous checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m16:14:51.402958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b03f740c-1d2e-47ea-a64c-174e1f852865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208743BBA30>]}
[0m16:14:53.515342 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m16:14:53.544301 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m16:14:53.544301 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m16:14:53.780151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b03f740c-1d2e-47ea-a64c-174e1f852865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208745884F0>]}
[0m16:14:53.795784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b03f740c-1d2e-47ea-a64c-174e1f852865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020874588580>]}
[0m16:14:53.795784 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:14:53.795784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b03f740c-1d2e-47ea-a64c-174e1f852865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020874497910>]}
[0m16:14:53.795784 [info ] [MainThread]: 
[0m16:14:53.795784 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:14:53.795784 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:14:53.835724 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:14:53.835724 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:14:53.844846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:57.800612 [debug] [ThreadPool]: SQL status: SUCCESS in 4.0 seconds
[0m16:14:57.809168 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:14:57.816197 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:14:57.817388 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:14:57.817388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:58.253099 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:14:58.257580 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:14:58.262110 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:14:58.264641 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:14:58.264641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:58.800822 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:14:58.803687 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:14:58.805276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_gold)
[0m16:14:58.805276 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "gold"
"
[0m16:14:58.816036 [debug] [ThreadPool]: Using trino connection "create_lakehouse_gold"
[0m16:14:58.816036 [debug] [ThreadPool]: On create_lakehouse_gold: create schema if not exists lakehouse.gold
[0m16:14:58.816036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:59.529573 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230607_141458_00003_ht42y
[0m16:14:59.529573 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/gold.db, failed to create database gold", query_id=20230607_141458_00003_ht42y)
[0m16:14:59.531327 [debug] [ThreadPool]: On create_lakehouse_gold: ROLLBACK
[0m16:14:59.531327 [debug] [ThreadPool]: On create_lakehouse_gold: Close
[0m16:14:59.531327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:59.537338 [debug] [MainThread]: Connection 'create_lakehouse_gold' was properly closed.
[0m16:14:59.537338 [info ] [MainThread]: 
[0m16:14:59.537338 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m16:14:59.541384 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/gold.db, failed to create database gold", query_id=20230607_141458_00003_ht42y)
[0m16:14:59.541384 [debug] [MainThread]: Command `dbt run` failed at 16:14:59.541384 after 8.67 seconds
[0m16:14:59.541384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208717F75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020874372AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020874373040>]}
[0m16:14:59.541384 [debug] [MainThread]: Flushing usage events
[0m16:15:43.001945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD221575E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24A26530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24A262F0>]}


============================== 16:15:43.008561 | 5c58fb6b-0d53-4d75-ba3a-18e240483ee9 ==============================
[0m16:15:43.008561 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:15:43.011395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:15:43.195937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c58fb6b-0d53-4d75-ba3a-18e240483ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24A26620>]}
[0m16:15:43.276452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c58fb6b-0d53-4d75-ba3a-18e240483ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24D26BC0>]}
[0m16:15:43.290364 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m16:15:43.315739 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:15:43.315739 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c
[0m16:15:43.320510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c58fb6b-0d53-4d75-ba3a-18e240483ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24D65E70>]}
[0m16:15:44.174000 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m16:15:44.189883 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m16:15:44.189883 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m16:15:44.321559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c58fb6b-0d53-4d75-ba3a-18e240483ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1E125030>]}
[0m16:15:44.336743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c58fb6b-0d53-4d75-ba3a-18e240483ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1E124A90>]}
[0m16:15:44.336743 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:15:44.340534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c58fb6b-0d53-4d75-ba3a-18e240483ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24E77100>]}
[0m16:15:44.342630 [info ] [MainThread]: 
[0m16:15:44.348697 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:15:44.348697 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:15:44.374765 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:15:44.376827 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:15:44.377886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:44.681082 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:44.681082 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:15:44.689132 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:15:44.689132 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:15:44.689132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:44.866859 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:44.871438 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:15:44.875993 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:15:44.875993 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:15:44.879308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:45.046768 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:15:45.049321 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:15:45.050367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_gold)
[0m16:15:45.050367 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "gold"
"
[0m16:15:45.057915 [debug] [ThreadPool]: Using trino connection "create_lakehouse_gold"
[0m16:15:45.057915 [debug] [ThreadPool]: On create_lakehouse_gold: create schema if not exists lakehouse.gold
[0m16:15:45.057915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:45.152827 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230607_141545_00007_ht42y
[0m16:15:45.152827 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/gold.db, failed to create database gold", query_id=20230607_141545_00007_ht42y)
[0m16:15:45.152827 [debug] [ThreadPool]: On create_lakehouse_gold: ROLLBACK
[0m16:15:45.152827 [debug] [ThreadPool]: On create_lakehouse_gold: Close
[0m16:15:45.152827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:45.152827 [debug] [MainThread]: Connection 'create_lakehouse_gold' was properly closed.
[0m16:15:45.157836 [info ] [MainThread]: 
[0m16:15:45.157836 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m16:15:45.159613 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/gold.db, failed to create database gold", query_id=20230607_141545_00007_ht42y)
[0m16:15:45.159613 [debug] [MainThread]: Command `dbt run` failed at 16:15:45.159613 after 2.19 seconds
[0m16:15:45.159613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD221575E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24D26200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24D25C30>]}
[0m16:15:45.159613 [debug] [MainThread]: Flushing usage events
[0m16:16:47.095132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289731A75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975A4A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975A4A350>]}


============================== 16:16:47.101648 | 0dea70da-f0f2-4b63-8d9e-5923a7355cb3 ==============================
[0m16:16:47.101648 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:16:47.101648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:16:47.315499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dea70da-f0f2-4b63-8d9e-5923a7355cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975A4A680>]}
[0m16:16:47.331571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dea70da-f0f2-4b63-8d9e-5923a7355cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975D4B9D0>]}
[0m16:16:47.347621 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m16:16:47.428731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:47.428731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:47.436771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dea70da-f0f2-4b63-8d9e-5923a7355cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975F4D930>]}
[0m16:16:47.444800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dea70da-f0f2-4b63-8d9e-5923a7355cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975F15F90>]}
[0m16:16:47.444800 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:16:47.444800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dea70da-f0f2-4b63-8d9e-5923a7355cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975F161D0>]}
[0m16:16:47.444800 [info ] [MainThread]: 
[0m16:16:47.452814 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:16:47.452814 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:16:47.471076 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:16:47.472223 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:16:47.472223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:47.643916 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:47.643916 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:16:47.652518 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:16:47.652518 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:16:47.655038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:47.860591 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:47.860591 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:16:47.870617 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m16:16:47.877390 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m16:16:47.877390 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m16:16:47.887402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:49.042906 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:16:49.042906 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m16:16:49.042906 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m16:16:49.049426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m16:16:49.061601 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m16:16:49.062115 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m16:16:49.062115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:49.574619 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:16:49.576157 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m16:16:49.576157 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m16:16:49.576157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_gold)
[0m16:16:49.584202 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m16:16:49.584202 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m16:16:49.584202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:49.926972 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:16:49.929490 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m16:16:49.929490 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m16:16:49.931556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dea70da-f0f2-4b63-8d9e-5923a7355cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975F76FE0>]}
[0m16:16:49.931556 [debug] [MainThread]: On master: COMMIT
[0m16:16:49.931556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:16:49.931556 [info ] [MainThread]: 
[0m16:16:49.951746 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m16:16:49.954758 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m16:16:49.954758 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m16:16:49.959892 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m16:16:49.959892 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m16:16:49.967458 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 16:16:49.959892 => 16:16:49.967458
[0m16:16:49.967458 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m16:16:50.032422 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m16:16:50.041447 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:16:50.041447 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m16:16:50.043471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:17:01.086717 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m16:17:01.099313 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:17:01.099313 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m16:17:01.391136 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:01.391136 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:17:01.391136 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m16:17:01.665760 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:01.674863 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:17:01.680886 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m16:17:02.339505 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:17:02.375922 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 16:16:49.967458 => 16:17:02.375922
[0m16:17:02.375922 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m16:17:02.375922 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m16:17:02.382036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dea70da-f0f2-4b63-8d9e-5923a7355cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028976006920>]}
[0m16:17:02.383053 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 12.42s]
[0m16:17:02.386273 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m16:17:02.388687 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m16:17:02.389796 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m16:17:02.394872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m16:17:02.395825 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m16:17:02.406556 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m16:17:02.410541 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 16:17:02.398087 => 16:17:02.409599
[0m16:17:02.411961 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m16:17:02.422546 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m16:17:02.430737 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m16:17:02.434751 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m16:17:02.434751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:03.971177 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m16:17:03.979207 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m16:17:03.979207 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m16:17:04.268115 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:04.279142 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m16:17:04.280666 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m16:17:04.532067 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:04.543096 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m16:17:04.543096 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m16:17:04.924845 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:17:04.929091 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 16:17:02.411961 => 16:17:04.929091
[0m16:17:04.929091 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m16:17:04.929091 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m16:17:04.932625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dea70da-f0f2-4b63-8d9e-5923a7355cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002897608BC70>]}
[0m16:17:04.932625 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.54s]
[0m16:17:04.938138 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m16:17:04.943441 [debug] [MainThread]: On master: COMMIT
[0m16:17:04.946460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:04.946460 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m16:17:04.949040 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m16:17:04.949040 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m16:17:04.949040 [info ] [MainThread]: 
[0m16:17:04.962758 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 17.50 seconds (17.50s).
[0m16:17:04.962758 [debug] [MainThread]: Command end result
[0m16:17:04.987466 [info ] [MainThread]: 
[0m16:17:04.989744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:04.989744 [info ] [MainThread]: 
[0m16:17:04.997781 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:17:04.999198 [debug] [MainThread]: Command `dbt run` succeeded at 16:17:04.999198 after 17.94 seconds
[0m16:17:05.004732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289731A75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028975D4B9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002897608B700>]}
[0m16:17:05.004732 [debug] [MainThread]: Flushing usage events
[0m16:26:32.314134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6218F75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B624136620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6241363E0>]}


============================== 16:26:32.319652 | 5c0539c8-4483-40e5-8e55-d08dcf2b9afc ==============================
[0m16:26:32.319652 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:26:32.325166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:26:32.597127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c0539c8-4483-40e5-8e55-d08dcf2b9afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B624136710>]}
[0m16:26:32.621107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c0539c8-4483-40e5-8e55-d08dcf2b9afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62443B5E0>]}
[0m16:26:32.659853 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m16:26:32.689668 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:26:32.689668 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m16:26:32.689668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c0539c8-4483-40e5-8e55-d08dcf2b9afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62447ADD0>]}
[0m16:26:34.610544 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m16:26:34.626651 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m16:26:34.626651 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m16:26:34.769188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c0539c8-4483-40e5-8e55-d08dcf2b9afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6211810C0>]}
[0m16:26:34.778407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c0539c8-4483-40e5-8e55-d08dcf2b9afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B621180E80>]}
[0m16:26:34.778407 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:26:34.779505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c0539c8-4483-40e5-8e55-d08dcf2b9afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62455A080>]}
[0m16:26:34.780556 [info ] [MainThread]: 
[0m16:26:34.781696 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:26:34.783828 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m16:26:34.797875 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m16:26:34.799008 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m16:26:34.799008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:35.456466 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:26:35.459901 [debug] [ThreadPool]: On list_clickhouse: Close
[0m16:26:35.465492 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_bronze'
[0m16:26:35.481626 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m16:26:35.482171 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m16:26:35.482171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:35.839592 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:26:35.839592 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m16:26:35.844615 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m16:26:35.844615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m16:26:35.854045 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m16:26:35.854045 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m16:26:35.856561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:36.083232 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:26:36.083232 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m16:26:36.087758 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m16:26:36.090781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_silver)
[0m16:26:36.095877 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m16:26:36.099899 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m16:26:36.099899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:36.349985 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:26:36.355037 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m16:26:36.355037 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m16:26:36.355037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c0539c8-4483-40e5-8e55-d08dcf2b9afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6232460B0>]}
[0m16:26:36.360067 [debug] [MainThread]: On master: COMMIT
[0m16:26:36.360597 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m16:26:36.360597 [info ] [MainThread]: 
[0m16:26:36.371168 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m16:26:36.374726 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m16:26:36.374726 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m16:26:36.374726 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m16:26:36.377749 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m16:26:36.382283 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 16:26:36.377749 => 16:26:36.382283
[0m16:26:36.383004 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m16:26:36.427603 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m16:26:36.433617 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m16:26:36.433617 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m16:26:36.433617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:26:36.975388 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:26:36.987833 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m16:26:36.990371 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m16:26:37.051524 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:26:37.062633 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m16:26:37.062633 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m16:26:37.170250 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:26:37.181333 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m16:26:37.186855 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m16:26:37.255798 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:26:37.291436 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 16:26:36.383004 => 16:26:37.287333
[0m16:26:37.292468 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m16:26:37.292468 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m16:26:37.295754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c0539c8-4483-40e5-8e55-d08dcf2b9afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62444BD60>]}
[0m16:26:37.295754 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 0.92s]
[0m16:26:37.295754 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m16:26:37.295754 [debug] [MainThread]: On master: COMMIT
[0m16:26:37.295754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:37.295754 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m16:26:37.295754 [debug] [MainThread]: Connection 'list_clickhouse_silver' was properly closed.
[0m16:26:37.295754 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m16:26:37.305273 [info ] [MainThread]: 
[0m16:26:37.305273 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m16:26:37.309030 [debug] [MainThread]: Command end result
[0m16:26:37.315653 [info ] [MainThread]: 
[0m16:26:37.323702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:37.323702 [info ] [MainThread]: 
[0m16:26:37.323702 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:26:37.328220 [debug] [MainThread]: Command `dbt run` succeeded at 16:26:37.328220 after 5.25 seconds
[0m16:26:37.328220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62452C880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62444BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62444BC40>]}
[0m16:26:37.331070 [debug] [MainThread]: Flushing usage events
[0m11:14:06.234076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB55B75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7E26650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7E26320>]}


============================== 11:14:06.255679 | 692fe74a-b0a9-4274-bf70-eab798f80461 ==============================
[0m11:14:06.255679 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:14:06.259670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:14:06.586982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '692fe74a-b0a9-4274-bf70-eab798f80461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7E265F0>]}
[0m11:14:06.606529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '692fe74a-b0a9-4274-bf70-eab798f80461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB813B580>]}
[0m11:14:06.628624 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m11:14:06.649207 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:14:06.651294 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m11:14:06.652209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '692fe74a-b0a9-4274-bf70-eab798f80461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB817BA30>]}
[0m11:14:08.605837 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m11:14:08.626224 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m11:14:08.634222 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m11:14:08.788157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '692fe74a-b0a9-4274-bf70-eab798f80461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB4E40D00>]}
[0m11:14:08.796676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '692fe74a-b0a9-4274-bf70-eab798f80461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB8344580>]}
[0m11:14:08.797676 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:14:08.798676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '692fe74a-b0a9-4274-bf70-eab798f80461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB82EF940>]}
[0m11:14:08.799675 [info ] [MainThread]: 
[0m11:14:08.800678 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:14:08.802676 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:14:08.816722 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:14:08.817723 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:14:08.818722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:17.883882 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:14:17.886887 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:14:17.886887 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:14:17.887890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:26.661599 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:14:26.666999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:26.668679 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m11:14:26.670850 [info ] [MainThread]: 
[0m11:14:26.674811 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 17.87 seconds (17.87s).
[0m11:14:26.678400 [error] [MainThread]: Encountered an error:
Runtime Error
  HTTPConnectionPool(host='trino', port=8080): Max retries exceeded with url: /v1/statement (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001DBB7187160>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed'))
[0m11:14:26.682251 [debug] [MainThread]: Command `dbt run` failed at 11:14:26.682251 after 20.73 seconds
[0m11:14:26.684801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB55B75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB8233070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB8233250>]}
[0m11:14:26.687801 [debug] [MainThread]: Flushing usage events
[0m11:14:48.998711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6908FF5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B693166650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B693166320>]}


============================== 11:14:49.001712 | ae663a71-06e7-42f6-b7d4-e538725a92a0 ==============================
[0m11:14:49.001712 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:14:49.002709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:14:49.137668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae663a71-06e7-42f6-b7d4-e538725a92a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6931665F0>]}
[0m11:14:49.147291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae663a71-06e7-42f6-b7d4-e538725a92a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B693467580>]}
[0m11:14:49.158801 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m11:14:49.173977 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:14:49.174927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae663a71-06e7-42f6-b7d4-e538725a92a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6934AAE30>]}
[0m11:14:49.681364 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m11:14:49.691915 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m11:14:49.697466 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m11:14:49.832343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae663a71-06e7-42f6-b7d4-e538725a92a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B69017CD00>]}
[0m11:14:49.839858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae663a71-06e7-42f6-b7d4-e538725a92a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6936785B0>]}
[0m11:14:49.840858 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:14:49.840858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae663a71-06e7-42f6-b7d4-e538725a92a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6935F3970>]}
[0m11:14:49.842860 [info ] [MainThread]: 
[0m11:14:49.844364 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:14:49.845372 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:14:49.857935 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:14:49.858913 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:14:49.858913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:50.011053 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:50.012370 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:14:50.015627 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:14:50.016157 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:14:50.016739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:50.094310 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:14:50.095434 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:14:50.097065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_bronze)
[0m11:14:50.098673 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "bronze"
"
[0m11:14:50.102363 [debug] [ThreadPool]: Using trino connection "create_lakehouse_bronze"
[0m11:14:50.103909 [debug] [ThreadPool]: On create_lakehouse_bronze: create schema if not exists lakehouse.bronze
[0m11:14:50.103909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:50.151877 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230608_091450_00012_g8qzs
[0m11:14:50.152476 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/bronze.db, failed to create database bronze", query_id=20230608_091450_00012_g8qzs)
[0m11:14:50.152980 [debug] [ThreadPool]: On create_lakehouse_bronze: ROLLBACK
[0m11:14:50.153495 [debug] [ThreadPool]: On create_lakehouse_bronze: Close
[0m11:14:50.155126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lakehouse_bronze, now create_lakehouse_silver)
[0m11:14:50.155654 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "silver"
"
[0m11:14:50.159376 [debug] [ThreadPool]: Using trino connection "create_lakehouse_silver"
[0m11:14:50.159376 [debug] [ThreadPool]: On create_lakehouse_silver: create schema if not exists lakehouse.silver
[0m11:14:50.160424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:50.210917 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230608_091450_00013_g8qzs
[0m11:14:50.211930 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/silver.db, failed to create database silver", query_id=20230608_091450_00013_g8qzs)
[0m11:14:50.211930 [debug] [ThreadPool]: On create_lakehouse_silver: ROLLBACK
[0m11:14:50.213440 [debug] [ThreadPool]: On create_lakehouse_silver: Close
[0m11:14:50.215450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:50.215450 [debug] [MainThread]: Connection 'create_lakehouse_silver' was properly closed.
[0m11:14:50.216450 [info ] [MainThread]: 
[0m11:14:50.217450 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:14:50.217450 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="Unable to create database path file:/user/hive/warehouse/bronze.db, failed to create database bronze", query_id=20230608_091450_00012_g8qzs)
[0m11:14:50.219451 [debug] [MainThread]: Command `dbt run` failed at 11:14:50.218449 after 1.25 seconds
[0m11:14:50.220452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6908FF5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B693464B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B693465B40>]}
[0m11:14:50.220452 [debug] [MainThread]: Flushing usage events
[0m12:13:03.651474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188627375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018864FE6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018864FE6350>]}


============================== 12:13:03.658195 | 249244c7-4d89-46ce-a1d1-3380c1856561 ==============================
[0m12:13:03.658195 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:13:03.659340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:13:03.891672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '249244c7-4d89-46ce-a1d1-3380c1856561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018864FE6680>]}
[0m12:13:03.908905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '249244c7-4d89-46ce-a1d1-3380c1856561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188652E79D0>]}
[0m12:13:03.944781 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m12:13:03.974625 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:13:03.976616 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m12:13:03.976616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '249244c7-4d89-46ce-a1d1-3380c1856561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001886532F6D0>]}
[0m12:13:05.912476 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:13:05.926072 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:13:05.931596 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:13:06.071929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '249244c7-4d89-46ce-a1d1-3380c1856561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188654F04C0>]}
[0m12:13:06.080969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '249244c7-4d89-46ce-a1d1-3380c1856561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188654F0A90>]}
[0m12:13:06.081967 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:13:06.083478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '249244c7-4d89-46ce-a1d1-3380c1856561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018865487EB0>]}
[0m12:13:06.085491 [info ] [MainThread]: 
[0m12:13:06.086488 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:13:06.087997 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m12:13:06.105526 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:13:06.105526 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:13:06.106526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:06.549992 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:06.553897 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:13:06.562583 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m12:13:06.563542 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m12:13:06.565535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:06.711078 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:06.713962 [debug] [ThreadPool]: On list_lakehouse: Close
[0m12:13:06.717980 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m12:13:06.737947 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m12:13:06.739958 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m12:13:06.741483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:07.638694 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m12:13:07.640697 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m12:13:07.642701 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m12:13:07.645698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m12:13:07.655371 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m12:13:07.656954 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m12:13:07.657965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:07.922241 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:07.925094 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m12:13:07.926189 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m12:13:07.929091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m12:13:07.938739 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m12:13:07.939746 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m12:13:07.941744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:08.241795 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:08.244340 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m12:13:08.245364 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m12:13:08.247873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '249244c7-4d89-46ce-a1d1-3380c1856561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018861FC2BF0>]}
[0m12:13:08.249896 [debug] [MainThread]: On master: COMMIT
[0m12:13:08.251892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:08.253893 [info ] [MainThread]: 
[0m12:13:08.271173 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m12:13:08.272688 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m12:13:08.276249 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m12:13:08.278791 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m12:13:08.289879 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m12:13:08.294930 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 12:13:08.281792 => 12:13:08.293921
[0m12:13:08.296926 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m12:13:08.375917 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m12:13:08.381447 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m12:13:08.381447 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m12:13:08.383979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:13:10.668274 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m12:13:10.681951 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m12:13:10.682961 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m12:13:10.933507 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:10.940559 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m12:13:10.941563 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m12:13:11.121496 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:11.130576 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m12:13:11.131084 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m12:13:11.376487 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:11.402321 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 12:13:08.297924 => 12:13:11.401320
[0m12:13:11.403324 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m12:13:11.403324 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m12:13:11.406628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249244c7-4d89-46ce-a1d1-3380c1856561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018865664820>]}
[0m12:13:11.408981 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 3.13s]
[0m12:13:11.410980 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m12:13:11.411985 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m12:13:11.412981 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m12:13:11.414983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m12:13:11.415981 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m12:13:11.421088 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m12:13:11.423606 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 12:13:11.415981 => 12:13:11.423606
[0m12:13:11.425605 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m12:13:11.431000 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m12:13:11.436005 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m12:13:11.437517 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m12:13:11.439530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:12.730450 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m12:13:12.736294 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m12:13:12.736294 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m12:13:12.944291 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:12.949285 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m12:13:12.950374 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m12:13:12.986092 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:12.989654 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 12:13:11.426602 => 12:13:12.989654
[0m12:13:12.991793 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m12:13:12.992795 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m12:13:12.995789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '249244c7-4d89-46ce-a1d1-3380c1856561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188652FBA60>]}
[0m12:13:12.997789 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.58s]
[0m12:13:12.999873 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m12:13:13.002868 [debug] [MainThread]: On master: COMMIT
[0m12:13:13.004866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:13.006865 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m12:13:13.007870 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m12:13:13.009396 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m12:13:13.010908 [info ] [MainThread]: 
[0m12:13:13.012922 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m12:13:13.016922 [debug] [MainThread]: Command end result
[0m12:13:13.039593 [info ] [MainThread]: 
[0m12:13:13.042605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:13.045603 [info ] [MainThread]: 
[0m12:13:13.047112 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:13:13.048652 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:13.048652 after 9.59 seconds
[0m12:13:13.051655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188627375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188605BD210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188654F05B0>]}
[0m12:13:13.053668 [debug] [MainThread]: Flushing usage events
[0m12:13:42.134092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3B1E75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DA5A5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DA5A380>]}


============================== 12:13:42.140008 | b1e9094f-0e5f-41d5-b06e-8a664642fe86 ==============================
[0m12:13:42.140008 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:13:42.141023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:13:42.346257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e9094f-0e5f-41d5-b06e-8a664642fe86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DA5A6B0>]}
[0m12:13:42.362436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1e9094f-0e5f-41d5-b06e-8a664642fe86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DD5BA60>]}
[0m12:13:42.376504 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m12:13:42.402371 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:13:42.404351 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m12:13:42.405367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1e9094f-0e5f-41d5-b06e-8a664642fe86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DD9BD90>]}
[0m12:13:43.162826 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m12:13:43.176350 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m12:13:43.181955 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m12:13:43.308458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1e9094f-0e5f-41d5-b06e-8a664642fe86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DF645E0>]}
[0m12:13:43.316979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1e9094f-0e5f-41d5-b06e-8a664642fe86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DF64550>]}
[0m12:13:43.317491 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:13:43.318500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e9094f-0e5f-41d5-b06e-8a664642fe86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DE747F0>]}
[0m12:13:43.319504 [info ] [MainThread]: 
[0m12:13:43.321500 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m12:13:43.322502 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m12:13:43.337654 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m12:13:43.338766 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m12:13:43.341243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:43.577989 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:43.579947 [debug] [ThreadPool]: On list_clickhouse: Close
[0m12:13:43.582973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse, now create_clickhouse_gold)
[0m12:13:43.585204 [debug] [ThreadPool]: Creating schema "database: "clickhouse"
schema: "gold"
"
[0m12:13:43.593577 [debug] [ThreadPool]: Using trino connection "create_clickhouse_gold"
[0m12:13:43.594577 [debug] [ThreadPool]: On create_clickhouse_gold: create schema if not exists clickhouse.gold
[0m12:13:43.595580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:43.717898 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:43.719940 [debug] [ThreadPool]: On create_clickhouse_gold: COMMIT
[0m12:13:43.720912 [debug] [ThreadPool]: On create_clickhouse_gold: Close
[0m12:13:43.724488 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_silver'
[0m12:13:43.738643 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m12:13:43.739668 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m12:13:43.740646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:44.062627 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:44.064701 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m12:13:44.065697 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m12:13:44.067643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m12:13:44.078616 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m12:13:44.079617 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m12:13:44.080614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:44.287590 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:44.289843 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m12:13:44.291003 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m12:13:44.293891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m12:13:44.302224 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m12:13:44.302224 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m12:13:44.303227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:44.507612 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:44.509915 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m12:13:44.509915 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m12:13:44.513452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e9094f-0e5f-41d5-b06e-8a664642fe86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3AA670A0>]}
[0m12:13:44.514452 [debug] [MainThread]: On master: COMMIT
[0m12:13:44.517452 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m12:13:44.518981 [info ] [MainThread]: 
[0m12:13:44.530063 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m12:13:44.532063 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m12:13:44.535066 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m12:13:44.536063 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m12:13:44.544595 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m12:13:44.548987 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 12:13:44.538597 => 12:13:44.547602
[0m12:13:44.549999 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m12:13:44.632264 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m12:13:44.636256 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m12:13:44.638787 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m12:13:44.639789 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:13:45.295369 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m12:13:45.307983 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m12:13:45.310005 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m12:13:45.401701 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:45.415366 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m12:13:45.416365 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m12:13:45.479372 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m12:13:45.517706 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 12:13:44.550999 => 12:13:45.516130
[0m12:13:45.518801 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m12:13:45.523350 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m12:13:45.526345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e9094f-0e5f-41d5-b06e-8a664642fe86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DF18C70>]}
[0m12:13:45.528881 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 0.99s]
[0m12:13:45.531874 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m12:13:45.535875 [debug] [MainThread]: On master: COMMIT
[0m12:13:45.539914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:45.541925 [debug] [MainThread]: Connection 'create_clickhouse_gold' was properly closed.
[0m12:13:45.543927 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m12:13:45.545925 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m12:13:45.545925 [info ] [MainThread]: 
[0m12:13:45.549456 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m12:13:45.552458 [debug] [MainThread]: Command end result
[0m12:13:45.565551 [info ] [MainThread]: 
[0m12:13:45.568763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:45.572749 [info ] [MainThread]: 
[0m12:13:45.575746 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:13:45.578886 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:45.578886 after 3.47 seconds
[0m12:13:45.580400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3B1E75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3E04E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B3DF64550>]}
[0m12:13:45.582437 [debug] [MainThread]: Flushing usage events
[0m17:26:10.316873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCEB29AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCE29A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCE29A080>]}


============================== 17:26:10.325795 | 21ea7e3d-46e3-4b64-b287-343043326529 ==============================
[0m17:26:10.325795 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:26:10.325795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:26:10.568477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21ea7e3d-46e3-4b64-b287-343043326529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCE29A3B0>]}
[0m17:26:10.587248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21ea7e3d-46e3-4b64-b287-343043326529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD16739A0>]}
[0m17:26:10.616704 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m17:26:10.632678 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:26:10.635817 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m17:26:10.635817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21ea7e3d-46e3-4b64-b287-343043326529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD16A7C40>]}
[0m17:26:12.470151 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:26:12.517559 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:26:12.521557 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m17:26:12.621414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21ea7e3d-46e3-4b64-b287-343043326529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD16677C0>]}
[0m17:26:12.630941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21ea7e3d-46e3-4b64-b287-343043326529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD1667D30>]}
[0m17:26:12.631945 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:26:12.632938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ea7e3d-46e3-4b64-b287-343043326529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD1889360>]}
[0m17:26:12.633943 [info ] [MainThread]: 
[0m17:26:12.636472 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:26:12.638467 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:26:12.654498 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:26:12.655499 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:26:12.656632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:13.701723 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:26:13.704721 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:26:13.716528 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:26:13.717534 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:26:13.718539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:13.983789 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:13.988837 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:26:13.995888 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m17:26:14.016054 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m17:26:14.018066 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:26:14.019067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:15.814228 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m17:26:15.818784 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m17:26:15.821804 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m17:26:15.826381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_silver)
[0m17:26:15.840470 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m17:26:15.842051 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:26:15.844005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:16.945268 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:26:16.950341 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m17:26:16.953495 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m17:26:16.957565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m17:26:16.977370 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:26:16.980403 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:26:16.980403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:17.763423 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:26:17.766493 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:26:17.767493 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:26:17.772513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ea7e3d-46e3-4b64-b287-343043326529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD1656A10>]}
[0m17:26:17.775505 [debug] [MainThread]: On master: COMMIT
[0m17:26:17.776025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:17.780560 [info ] [MainThread]: 
[0m17:26:17.811487 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:26:17.816021 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:26:17.821680 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:26:17.824711 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:26:17.840928 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:26:17.845519 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:26:17.827262 => 17:26:17.843951
[0m17:26:17.849492 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:26:17.995753 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:26:18.005439 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:26:18.005439 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:26:18.011475 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:30.256347 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m17:26:30.272917 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:26:30.272917 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:26:30.659119 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:30.672292 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:26:30.675804 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:26:31.011629 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:31.038811 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:26:31.040343 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:26:31.775253 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:26:31.815541 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:26:17.850490 => 17:26:31.815541
[0m17:26:31.815541 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:26:31.815541 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:26:31.815541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21ea7e3d-46e3-4b64-b287-343043326529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD1990220>]}
[0m17:26:31.822480 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 14.00s]
[0m17:26:31.822480 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:26:31.827932 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m17:26:31.830441 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m17:26:31.833969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m17:26:31.836015 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m17:26:31.848080 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m17:26:31.851611 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 17:26:31.839026 => 17:26:31.850598
[0m17:26:31.853609 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m17:26:31.863866 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m17:26:31.872392 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:26:31.874393 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:26:31.875392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:33.581378 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m17:26:33.591193 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:26:33.593957 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m17:26:33.936039 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:33.942079 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:26:33.944604 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m17:26:34.235441 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:34.240501 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:26:34.244019 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m17:26:34.605554 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:34.610161 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 17:26:31.854613 => 17:26:34.610161
[0m17:26:34.610161 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m17:26:34.610161 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m17:26:34.610161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21ea7e3d-46e3-4b64-b287-343043326529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD16D9DB0>]}
[0m17:26:34.616963 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.78s]
[0m17:26:34.622342 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m17:26:34.626464 [debug] [MainThread]: On master: COMMIT
[0m17:26:34.628455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:34.630459 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:26:34.630459 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:26:34.632766 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m17:26:34.634341 [info ] [MainThread]: 
[0m17:26:34.636829 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 22.00 seconds (22.00s).
[0m17:26:34.641350 [debug] [MainThread]: Command end result
[0m17:26:34.659219 [info ] [MainThread]: 
[0m17:26:34.662213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:26:34.665214 [info ] [MainThread]: 
[0m17:26:34.668145 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:26:34.671684 [debug] [MainThread]: Command `dbt run` succeeded at 17:26:34.671684 after 24.55 seconds
[0m17:26:34.673679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCEB29AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD184B7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD1890E80>]}
[0m17:26:34.677218 [debug] [MainThread]: Flushing usage events
[0m17:31:27.112773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D90CA9AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D90416410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D904160E0>]}


============================== 17:31:27.123373 | 15ad1ac5-2b7a-4c9a-935b-7e35cd2f965d ==============================
[0m17:31:27.123373 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:31:27.124939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:31:27.389585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15ad1ac5-2b7a-4c9a-935b-7e35cd2f965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D904163B0>]}
[0m17:31:27.419334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15ad1ac5-2b7a-4c9a-935b-7e35cd2f965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D938422C0>]}
[0m17:31:27.434670 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m17:31:27.472798 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:31:27.474352 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m17:31:27.475411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15ad1ac5-2b7a-4c9a-935b-7e35cd2f965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D9387BF70>]}
[0m17:31:28.517307 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:31:28.576673 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:31:28.585479 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m17:31:28.786469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15ad1ac5-2b7a-4c9a-935b-7e35cd2f965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D93837D90>]}
[0m17:31:28.806253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15ad1ac5-2b7a-4c9a-935b-7e35cd2f965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D93837E20>]}
[0m17:31:28.808253 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:31:28.811077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ad1ac5-2b7a-4c9a-935b-7e35cd2f965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D93A58970>]}
[0m17:31:28.815614 [info ] [MainThread]: 
[0m17:31:28.819127 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:31:28.823149 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m17:31:28.854170 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m17:31:28.855736 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m17:31:28.858336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:29.280500 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:29.284044 [debug] [ThreadPool]: On list_clickhouse: Close
[0m17:31:29.289172 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_silver'
[0m17:31:29.315223 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m17:31:29.318224 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:31:29.320243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:29.692207 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:29.695256 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m17:31:29.697255 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m17:31:29.702616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_gold)
[0m17:31:29.714712 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m17:31:29.716937 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:31:29.717937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:30.302176 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:31:30.307452 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m17:31:30.310454 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m17:31:30.316269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_bronze)
[0m17:31:30.332131 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m17:31:30.333289 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:31:30.336852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:30.766453 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:30.771053 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m17:31:30.774589 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m17:31:30.781094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ad1ac5-2b7a-4c9a-935b-7e35cd2f965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D9382AB30>]}
[0m17:31:30.784133 [debug] [MainThread]: On master: COMMIT
[0m17:31:30.787169 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m17:31:30.790665 [info ] [MainThread]: 
[0m17:31:30.812652 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m17:31:30.815721 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m17:31:30.820293 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m17:31:30.823282 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m17:31:30.832394 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m17:31:30.837747 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 17:31:30.825822 => 17:31:30.835957
[0m17:31:30.841914 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m17:31:30.945195 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m17:31:30.956970 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:31:30.959794 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m17:31:30.962261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:31.874816 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:31:31.889554 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:31:31.892516 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m17:31:32.000908 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:32.015710 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:31:32.017232 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m17:31:32.128057 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:32.149155 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:31:32.151174 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m17:31:32.242866 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:32.279253 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 17:31:30.844141 => 17:31:32.279253
[0m17:31:32.279253 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m17:31:32.284324 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m17:31:32.289090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ad1ac5-2b7a-4c9a-935b-7e35cd2f965d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D9387A350>]}
[0m17:31:32.291151 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 1.47s]
[0m17:31:32.295620 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m17:31:32.301714 [debug] [MainThread]: On master: COMMIT
[0m17:31:32.305776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:32.308631 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m17:31:32.309945 [debug] [MainThread]: Connection 'list_clickhouse_bronze' was properly closed.
[0m17:31:32.311150 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m17:31:32.312717 [info ] [MainThread]: 
[0m17:31:32.318450 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m17:31:32.325507 [debug] [MainThread]: Command end result
[0m17:31:32.356117 [info ] [MainThread]: 
[0m17:31:32.361159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:32.364771 [info ] [MainThread]: 
[0m17:31:32.368126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:31:32.371181 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:32.371181 after 5.30 seconds
[0m17:31:32.374268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D90CA9AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D93A83190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D93A60AF0>]}
[0m17:31:32.376240 [debug] [MainThread]: Flushing usage events
[0m17:33:03.359156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CFD69AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CF4DE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CF4DE0B0>]}


============================== 17:33:03.379101 | 64437271-b923-4f9b-ab35-b6098660f81b ==============================
[0m17:33:03.379101 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:33:03.384455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:33:04.234813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64437271-b923-4f9b-ab35-b6098660f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CF4DE3E0>]}
[0m17:33:04.313984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64437271-b923-4f9b-ab35-b6098660f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D2867A00>]}
[0m17:33:04.382786 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m17:33:04.828237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:33:04.831852 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\gold\weathergold.sql
[0m17:33:04.965343 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:33:05.112065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64437271-b923-4f9b-ab35-b6098660f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D2AF00D0>]}
[0m17:33:05.162011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64437271-b923-4f9b-ab35-b6098660f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D2A9B640>]}
[0m17:33:05.166142 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:33:05.172796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64437271-b923-4f9b-ab35-b6098660f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D2A9B4F0>]}
[0m17:33:05.183679 [info ] [MainThread]: 
[0m17:33:05.190881 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:33:05.201713 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m17:33:05.303820 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m17:33:05.307912 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m17:33:05.315722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:05.925821 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:33:05.933622 [debug] [ThreadPool]: On list_clickhouse: Close
[0m17:33:05.949786 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_gold'
[0m17:33:05.998154 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m17:33:06.002696 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:33:06.007108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:06.956593 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:33:06.963756 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m17:33:06.967859 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m17:33:06.974609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_silver)
[0m17:33:07.001180 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m17:33:07.004862 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:33:07.012677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:08.337561 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:33:08.344921 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m17:33:08.347553 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m17:33:08.354243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m17:33:08.378170 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m17:33:08.379213 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:33:08.384901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:09.325665 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:33:09.329202 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m17:33:09.332358 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m17:33:09.333943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64437271-b923-4f9b-ab35-b6098660f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D2A83190>]}
[0m17:33:09.339069 [debug] [MainThread]: On master: COMMIT
[0m17:33:09.344932 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m17:33:09.349132 [info ] [MainThread]: 
[0m17:33:09.380828 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m17:33:09.385369 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m17:33:09.393525 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m17:33:09.397639 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m17:33:09.420028 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m17:33:09.426559 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 17:33:09.401221 => 17:33:09.424537
[0m17:33:09.430641 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m17:33:09.575944 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m17:33:09.589121 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:33:09.594138 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed,
      dt
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m17:33:09.594138 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:33:10.307352 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:33:10.341412 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:33:10.344943 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m17:33:10.510990 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:10.521093 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:33:10.524103 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m17:33:10.656292 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:10.679077 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:33:10.681092 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m17:33:10.797243 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:10.873797 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 17:33:09.434189 => 17:33:10.872206
[0m17:33:10.876754 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m17:33:10.879741 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m17:33:10.883798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64437271-b923-4f9b-ab35-b6098660f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D2B4F550>]}
[0m17:33:10.887833 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 1.49s]
[0m17:33:10.892841 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m17:33:10.898926 [debug] [MainThread]: On master: COMMIT
[0m17:33:10.901476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:10.905023 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m17:33:10.907023 [debug] [MainThread]: Connection 'list_clickhouse_bronze' was properly closed.
[0m17:33:10.909024 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m17:33:10.911039 [info ] [MainThread]: 
[0m17:33:10.914077 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m17:33:10.922325 [debug] [MainThread]: Command end result
[0m17:33:10.964515 [info ] [MainThread]: 
[0m17:33:10.970065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:10.974587 [info ] [MainThread]: 
[0m17:33:10.980370 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:33:10.986934 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:10.985950 after 7.73 seconds
[0m17:33:10.990480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CFD69AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D2B4F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194CFBD0610>]}
[0m17:33:10.997072 [debug] [MainThread]: Flushing usage events
[0m17:34:20.716597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251AA119AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251A988E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251A988E0E0>]}


============================== 17:34:20.723798 | 331c9da9-f191-44a7-865f-28f730089efb ==============================
[0m17:34:20.723798 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:34:20.730401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:34:20.980771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '331c9da9-f191-44a7-865f-28f730089efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251A988E3B0>]}
[0m17:34:21.000767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '331c9da9-f191-44a7-865f-28f730089efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ACC662C0>]}
[0m17:34:21.018550 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m17:34:21.124787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:21.125794 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\gold\weathergold.sql
[0m17:34:21.164836 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:34:21.196794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '331c9da9-f191-44a7-865f-28f730089efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ACEF00D0>]}
[0m17:34:21.206124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '331c9da9-f191-44a7-865f-28f730089efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ACE9BC40>]}
[0m17:34:21.206124 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:34:21.206124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '331c9da9-f191-44a7-865f-28f730089efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ACE9B580>]}
[0m17:34:21.213815 [info ] [MainThread]: 
[0m17:34:21.213815 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:34:21.213815 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m17:34:21.240927 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m17:34:21.242442 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m17:34:21.243456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:21.400464 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:21.402641 [debug] [ThreadPool]: On list_clickhouse: Close
[0m17:34:21.407049 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_silver'
[0m17:34:21.427109 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m17:34:21.429080 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:34:21.431082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:21.664771 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:21.669381 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m17:34:21.671413 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m17:34:21.674958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m17:34:21.684752 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m17:34:21.687318 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:34:21.687845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:21.986952 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:21.990376 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m17:34:21.993412 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m17:34:21.995472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m17:34:22.003546 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m17:34:22.003546 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:34:22.003546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:22.278578 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:22.283633 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m17:34:22.283633 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m17:34:22.287805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '331c9da9-f191-44a7-865f-28f730089efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ACE81030>]}
[0m17:34:22.287805 [debug] [MainThread]: On master: COMMIT
[0m17:34:22.293838 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m17:34:22.294490 [info ] [MainThread]: 
[0m17:34:22.318419 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m17:34:22.320606 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m17:34:22.325702 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m17:34:22.328431 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m17:34:22.342803 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m17:34:22.347374 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 17:34:22.330514 => 17:34:22.346352
[0m17:34:22.350789 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m17:34:22.437595 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m17:34:22.444156 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:34:22.444156 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed,
      dt
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed,
    dt
from silver_data
group by coord_lon, coord_lat
    )
[0m17:34:22.444156 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:34:22.628601 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230609_153422_00040_2kc7c
[0m17:34:22.631173 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=EXPRESSION_NOT_AGGREGATE, message="line 30:5: 'dt' must be an aggregate expression or appear in GROUP BY clause", query_id=20230609_153422_00040_2kc7c)
[0m17:34:22.633712 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 17:34:22.351813 => 17:34:22.633712
[0m17:34:22.636278 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m17:34:22.638373 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m17:34:22.909251 [debug] [Thread-1 (]: Database Error in model weathergold (models\gold\weathergold.sql)
  TrinoUserError(type=USER_ERROR, name=EXPRESSION_NOT_AGGREGATE, message="line 30:5: 'dt' must be an aggregate expression or appear in GROUP BY clause", query_id=20230609_153422_00040_2kc7c)
  compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m17:34:22.910208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '331c9da9-f191-44a7-865f-28f730089efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ACF77AC0>]}
[0m17:34:22.912210 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.weathergold ......................... [[31mERROR[0m in 0.59s]
[0m17:34:22.916824 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m17:34:22.921754 [debug] [MainThread]: On master: COMMIT
[0m17:34:22.923756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:22.925936 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m17:34:22.926941 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m17:34:22.928983 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m17:34:22.931522 [info ] [MainThread]: 
[0m17:34:22.935840 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m17:34:22.939838 [debug] [MainThread]: Command end result
[0m17:34:22.959481 [info ] [MainThread]: 
[0m17:34:22.962645 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:34:22.967259 [info ] [MainThread]: 
[0m17:34:22.969283 [error] [MainThread]: [33mDatabase Error in model weathergold (models\gold\weathergold.sql)[0m
[0m17:34:22.971835 [error] [MainThread]:   TrinoUserError(type=USER_ERROR, name=EXPRESSION_NOT_AGGREGATE, message="line 30:5: 'dt' must be an aggregate expression or appear in GROUP BY clause", query_id=20230609_153422_00040_2kc7c)
[0m17:34:22.974555 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m17:34:22.977580 [info ] [MainThread]: 
[0m17:34:22.981597 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:34:22.986522 [debug] [MainThread]: Command `dbt run` failed at 17:34:22.986522 after 2.30 seconds
[0m17:34:22.988537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251AA119AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ACE9BA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ACE9BC40>]}
[0m17:34:22.990695 [debug] [MainThread]: Flushing usage events
[0m17:34:52.105443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D8109AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D787E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D787E0B0>]}


============================== 17:34:52.113584 | d6e36fed-7981-47e6-bffc-625ba457d2f2 ==============================
[0m17:34:52.113584 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:34:52.113584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:34:52.343836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6e36fed-7981-47e6-bffc-625ba457d2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D787E3E0>]}
[0m17:34:52.363547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6e36fed-7981-47e6-bffc-625ba457d2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DAC27A00>]}
[0m17:34:52.383551 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m17:34:52.473408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:52.473408 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\gold\weathergold.sql
[0m17:34:52.503589 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:34:52.533531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6e36fed-7981-47e6-bffc-625ba457d2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DAEB00D0>]}
[0m17:34:52.543220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6e36fed-7981-47e6-bffc-625ba457d2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DAE5BA00>]}
[0m17:34:52.543220 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:34:52.543220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6e36fed-7981-47e6-bffc-625ba457d2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DAE5B820>]}
[0m17:34:52.550464 [info ] [MainThread]: 
[0m17:34:52.553603 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:34:52.557753 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m17:34:52.581508 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m17:34:52.583346 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m17:34:52.584470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:52.729259 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:52.733455 [debug] [ThreadPool]: On list_clickhouse: Close
[0m17:34:52.738858 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_silver'
[0m17:34:52.753525 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m17:34:52.757057 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:34:52.757057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:53.020086 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:53.026463 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m17:34:53.028534 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m17:34:53.033606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m17:34:53.042577 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m17:34:53.044155 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:34:53.044155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:53.327527 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:53.328569 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m17:34:53.333626 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m17:34:53.334665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m17:34:53.347286 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m17:34:53.347286 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:34:53.347286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:53.623292 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:53.625469 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m17:34:53.626469 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m17:34:53.631007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6e36fed-7981-47e6-bffc-625ba457d2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DAE422F0>]}
[0m17:34:53.633624 [debug] [MainThread]: On master: COMMIT
[0m17:34:53.636159 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m17:34:53.639219 [info ] [MainThread]: 
[0m17:34:53.656295 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m17:34:53.659307 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m17:34:53.665755 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m17:34:53.666748 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m17:34:53.679594 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m17:34:53.683591 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 17:34:53.667746 => 17:34:53.682592
[0m17:34:53.685720 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m17:34:53.763573 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m17:34:53.773298 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:34:53.777340 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed,
      dt
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    dt,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m17:34:53.777340 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:34:53.933672 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230609_153453_00045_2kc7c
[0m17:34:53.933672 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=EXPRESSION_NOT_AGGREGATE, message="line 27:5: 'dt' must be an aggregate expression or appear in GROUP BY clause", query_id=20230609_153453_00045_2kc7c)
[0m17:34:53.933672 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 17:34:53.686725 => 17:34:53.933672
[0m17:34:53.933672 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m17:34:53.940372 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m17:34:53.951480 [debug] [Thread-1 (]: Database Error in model weathergold (models\gold\weathergold.sql)
  TrinoUserError(type=USER_ERROR, name=EXPRESSION_NOT_AGGREGATE, message="line 27:5: 'dt' must be an aggregate expression or appear in GROUP BY clause", query_id=20230609_153453_00045_2kc7c)
  compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m17:34:53.952492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6e36fed-7981-47e6-bffc-625ba457d2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DAF33A90>]}
[0m17:34:53.953521 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.weathergold ......................... [[31mERROR[0m in 0.29s]
[0m17:34:53.953521 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m17:34:53.962040 [debug] [MainThread]: On master: COMMIT
[0m17:34:53.966576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:53.968575 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m17:34:53.969575 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m17:34:53.970575 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m17:34:53.971572 [info ] [MainThread]: 
[0m17:34:53.974703 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m17:34:53.977697 [debug] [MainThread]: Command end result
[0m17:34:53.992301 [info ] [MainThread]: 
[0m17:34:53.994870 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:34:53.999384 [info ] [MainThread]: 
[0m17:34:54.002388 [error] [MainThread]: [33mDatabase Error in model weathergold (models\gold\weathergold.sql)[0m
[0m17:34:54.004543 [error] [MainThread]:   TrinoUserError(type=USER_ERROR, name=EXPRESSION_NOT_AGGREGATE, message="line 27:5: 'dt' must be an aggregate expression or appear in GROUP BY clause", query_id=20230609_153453_00045_2kc7c)
[0m17:34:54.008899 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m17:34:54.014512 [info ] [MainThread]: 
[0m17:34:54.018450 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:34:54.024057 [debug] [MainThread]: Command `dbt run` failed at 17:34:54.023420 after 1.95 seconds
[0m17:34:54.025930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D8109AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DAE5B640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DAE5BA00>]}
[0m17:34:54.028265 [debug] [MainThread]: Flushing usage events
[0m16:38:11.895606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE4C49AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE43BA3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE43BA170>]}


============================== 16:38:11.902216 | b639472e-a44e-4d39-84fe-e3fd78e92f04 ==============================
[0m16:38:11.902216 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:38:11.903226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:38:11.904171 [info ] [MainThread]: dbt version: 1.5.1
[0m16:38:11.906220 [info ] [MainThread]: python version: 3.10.9
[0m16:38:11.909664 [info ] [MainThread]: python path: C:\Users\eho.mbengue\AppData\Local\anaconda3\python.exe
[0m16:38:11.911737 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m16:38:11.914117 [info ] [MainThread]: Using profiles.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\profiles.yml
[0m16:38:11.915115 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\dbt_project.yml
[0m16:38:11.917645 [info ] [MainThread]: Configuration:
[0m16:38:12.095179 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:38:12.124747 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:38:12.126258 [info ] [MainThread]: Required dependencies:
[0m16:38:12.128270 [debug] [MainThread]: Executing "git --help"
[0m16:38:12.171345 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:38:12.172345 [debug] [MainThread]: STDERR: "b''"
[0m16:38:12.173362 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:38:12.175347 [info ] [MainThread]: Connection:
[0m16:38:12.176345 [info ] [MainThread]:   host: localhost
[0m16:38:12.177861 [info ] [MainThread]:   port: 8080
[0m16:38:12.178862 [info ] [MainThread]:   user: Trino
[0m16:38:12.180875 [info ] [MainThread]:   database: lakehouse
[0m16:38:12.182872 [info ] [MainThread]:   schema: bronze
[0m16:38:12.183872 [info ] [MainThread]:   cert: None
[0m16:38:12.184882 [info ] [MainThread]:   prepared_statements_enabled: True
[0m16:38:12.186391 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m16:38:12.188401 [debug] [MainThread]: Using trino connection "debug"
[0m16:38:12.189399 [debug] [MainThread]: On debug: select 1 as id
[0m16:38:12.189399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:15.465173 [debug] [MainThread]: SQL status: SUCCESS in 3.0 seconds
[0m16:38:15.468210 [debug] [MainThread]: On debug: Close
[0m16:38:15.469732 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:38:15.473255 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:38:15.476766 [debug] [MainThread]: Command `dbt debug` succeeded at 16:38:15.476256 after 3.74 seconds
[0m16:38:15.477780 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:38:15.479782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE4C49AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE77A67D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE77A5CF0>]}
[0m16:38:15.482358 [debug] [MainThread]: Flushing usage events
[0m17:07:06.305798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC68D5A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC684C6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC684C5EA0>]}


============================== 17:07:06.329095 | 6f01a959-2dab-4d74-8862-43d8cc3a9ec8 ==============================
[0m17:07:06.329095 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:07:06.335387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:07:06.337936 [info ] [MainThread]: dbt version: 1.5.1
[0m17:07:06.341491 [info ] [MainThread]: python version: 3.10.9
[0m17:07:06.350653 [info ] [MainThread]: python path: C:\Users\eho.mbengue\AppData\Local\anaconda3\python.exe
[0m17:07:06.354233 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m17:07:06.359298 [info ] [MainThread]: Using profiles.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\profiles.yml
[0m17:07:06.369459 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\dbt_project.yml
[0m17:07:06.376056 [info ] [MainThread]: Configuration:
[0m17:07:07.309821 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:07:07.429832 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:07:07.433857 [info ] [MainThread]: Required dependencies:
[0m17:07:07.438961 [debug] [MainThread]: Executing "git --help"
[0m17:07:07.810687 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:07:07.813298 [debug] [MainThread]: STDERR: "b''"
[0m17:07:07.816583 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:07:07.819610 [info ] [MainThread]: Connection:
[0m17:07:07.822152 [info ] [MainThread]:   host: localhost
[0m17:07:07.827700 [info ] [MainThread]:   port: 8080
[0m17:07:07.833391 [info ] [MainThread]:   user: Trino
[0m17:07:07.838461 [info ] [MainThread]:   database: lakehouse
[0m17:07:07.843559 [info ] [MainThread]:   schema: bronze
[0m17:07:07.848634 [info ] [MainThread]:   cert: None
[0m17:07:07.858375 [info ] [MainThread]:   prepared_statements_enabled: True
[0m17:07:07.860428 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m17:07:07.864994 [debug] [MainThread]: Using trino connection "debug"
[0m17:07:07.868546 [debug] [MainThread]: On debug: select 1 as id
[0m17:07:07.871063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:22.168109 [debug] [MainThread]: On debug: Close
[0m17:07:22.170692 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:07:22.176320 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:07:22.189234 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /v1/statement (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001DC6B85F910>: Failed to establish a new connection: [WinError 10061] Aucune connexion n’a pu être établie car l’ordinateur cible l’a expressément refusée'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:07:22.203456 [debug] [MainThread]: Command `dbt debug` failed at 17:07:22.203456 after 16.46 seconds
[0m17:07:22.208007 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:07:22.211569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC68D5A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6B85FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6B85EDD0>]}
[0m17:07:22.221942 [debug] [MainThread]: Flushing usage events
[0m15:21:29.485847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C8DCA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C85322F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C8532020>]}


============================== 15:21:29.485847 | cd138d7b-1b4b-499e-b82e-da247229dab4 ==============================
[0m15:21:29.485847 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:21:29.494952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:21:29.494952 [info ] [MainThread]: dbt version: 1.5.1
[0m15:21:29.494952 [info ] [MainThread]: python version: 3.10.9
[0m15:21:29.494952 [info ] [MainThread]: python path: C:\Users\eho.mbengue\AppData\Local\anaconda3\python.exe
[0m15:21:29.494952 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:21:29.498715 [info ] [MainThread]: Using profiles.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\profiles.yml
[0m15:21:29.498715 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\dbt_project.yml
[0m15:21:29.498715 [info ] [MainThread]: Configuration:
[0m15:21:29.498715 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m15:21:29.510732 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:21:29.510732 [info ] [MainThread]: Required dependencies:
[0m15:21:29.510732 [debug] [MainThread]: Executing "git --help"
[0m15:21:29.558438 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:21:29.558438 [debug] [MainThread]: STDERR: "b''"
[0m15:21:29.558438 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:21:29.558438 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:21:29.558438 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'projet_dbt'


[0m15:21:29.558438 [debug] [MainThread]: Command `dbt debug` failed at 15:21:29.558438 after 0.25 seconds
[0m15:21:29.558438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C8DCA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C8533A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C8533B80>]}
[0m15:21:29.558438 [debug] [MainThread]: Flushing usage events
[0m15:24:51.799574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164F70DA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164F6846410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164F6846140>]}


============================== 15:24:51.799574 | 487cf298-4c8b-4e8b-aaf3-bcead562b8c0 ==============================
[0m15:24:51.799574 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:24:51.799574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:24:51.799574 [info ] [MainThread]: dbt version: 1.5.1
[0m15:24:51.810638 [info ] [MainThread]: python version: 3.10.9
[0m15:24:51.810638 [info ] [MainThread]: python path: C:\Users\eho.mbengue\AppData\Local\anaconda3\python.exe
[0m15:24:51.810638 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:24:51.810638 [info ] [MainThread]: Using profiles.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\profiles.yml
[0m15:24:51.816194 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\dbt_project.yml
[0m15:24:51.816194 [info ] [MainThread]: Configuration:
[0m15:24:51.824152 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m15:24:51.858398 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:24:51.858398 [info ] [MainThread]: Required dependencies:
[0m15:24:51.858398 [debug] [MainThread]: Executing "git --help"
[0m15:24:51.961067 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:24:51.961067 [debug] [MainThread]: STDERR: "b''"
[0m15:24:51.961067 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:24:51.969648 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:24:51.969648 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'projet_dbt'


[0m15:24:51.969648 [debug] [MainThread]: Command `dbt debug` failed at 15:24:51.969648 after 0.22 seconds
[0m15:24:51.969648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164F70DA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164F6847BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164F6847C70>]}
[0m15:24:51.969648 [debug] [MainThread]: Flushing usage events
[0m15:26:05.870634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AC4DFA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AC4566470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AC4566140>]}


============================== 15:26:05.870634 | 32100733-8772-462e-8b62-5071ea732634 ==============================
[0m15:26:05.870634 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:26:05.870634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:26:05.870634 [info ] [MainThread]: dbt version: 1.5.1
[0m15:26:05.879142 [info ] [MainThread]: python version: 3.10.9
[0m15:26:05.879142 [info ] [MainThread]: python path: C:\Users\eho.mbengue\AppData\Local\anaconda3\python.exe
[0m15:26:05.879142 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:26:05.879142 [info ] [MainThread]: Using profiles.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\profiles.yml
[0m15:26:05.879142 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\dbt_project.yml
[0m15:26:05.879142 [info ] [MainThread]: Configuration:
[0m15:26:06.006116 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:26:06.020624 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:26:06.020624 [info ] [MainThread]: Required dependencies:
[0m15:26:06.020624 [debug] [MainThread]: Executing "git --help"
[0m15:26:06.051883 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:26:06.051883 [debug] [MainThread]: STDERR: "b''"
[0m15:26:06.051883 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:26:06.051883 [info ] [MainThread]: Connection:
[0m15:26:06.051883 [info ] [MainThread]:   host: localhost
[0m15:26:06.051883 [info ] [MainThread]:   port: 8080
[0m15:26:06.051883 [info ] [MainThread]:   user: Trino
[0m15:26:06.051883 [info ] [MainThread]:   database: lakehouse
[0m15:26:06.067507 [info ] [MainThread]:   schema: bronze
[0m15:26:06.067507 [info ] [MainThread]:   cert: None
[0m15:26:06.067507 [info ] [MainThread]:   prepared_statements_enabled: True
[0m15:26:06.067507 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m15:26:06.067507 [debug] [MainThread]: Using trino connection "debug"
[0m15:26:06.067507 [debug] [MainThread]: On debug: select 1 as id
[0m15:26:06.067507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:06.739907 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m15:26:06.739907 [debug] [MainThread]: On debug: Close
[0m15:26:06.739907 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:26:06.739907 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:26:06.747918 [debug] [MainThread]: Command `dbt debug` succeeded at 15:26:06.747918 after 0.90 seconds
[0m15:26:06.748934 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:26:06.748934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AC4DFA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AC79C5FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AC79C5690>]}
[0m15:26:06.748934 [debug] [MainThread]: Flushing usage events
[0m16:36:32.156431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC6B1A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC628A4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC628A260>]}


============================== 16:36:32.163412 | 6b49420d-2439-4e28-b2b9-934ee771cb89 ==============================
[0m16:36:32.163412 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:36:32.164411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:36:32.359904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b49420d-2439-4e28-b2b9-934ee771cb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC628A590>]}
[0m16:36:32.376230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b49420d-2439-4e28-b2b9-934ee771cb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC961B910>]}
[0m16:36:32.391247 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m16:36:32.408434 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:36:32.408434 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m16:36:32.408434 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:36:32.408434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b49420d-2439-4e28-b2b9-934ee771cb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9679E70>]}
[0m16:36:34.016479 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m16:36:34.063462 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m16:36:34.063462 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m16:36:34.162409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b49420d-2439-4e28-b2b9-934ee771cb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC96780A0>]}
[0m16:36:34.183593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b49420d-2439-4e28-b2b9-934ee771cb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC9678310>]}
[0m16:36:34.184594 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:36:34.185592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b49420d-2439-4e28-b2b9-934ee771cb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC982B160>]}
[0m16:36:34.187593 [info ] [MainThread]: 
[0m16:36:34.188590 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:36:34.190592 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:36:34.206161 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:36:34.206161 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:36:34.207162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:34.917507 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:36:34.917507 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:36:34.925508 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:36:34.925508 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:36:34.925508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:35.099411 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:36:35.107980 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:36:35.114027 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m16:36:35.125590 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m16:36:35.131619 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m16:36:35.135147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:36.906228 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m16:36:36.909226 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m16:36:36.910228 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m16:36:36.913750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_gold)
[0m16:36:36.922022 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m16:36:36.922022 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m16:36:36.922022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:37.279772 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:36:37.284300 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m16:36:37.286830 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m16:36:37.286830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m16:36:37.295845 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m16:36:37.295845 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m16:36:37.295845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:37.604686 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:36:37.604686 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m16:36:37.608709 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m16:36:37.609731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b49420d-2439-4e28-b2b9-934ee771cb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC967BB20>]}
[0m16:36:37.609731 [debug] [MainThread]: On master: COMMIT
[0m16:36:37.609731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:37.616754 [info ] [MainThread]: 
[0m16:36:37.636462 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m16:36:37.640950 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m16:36:37.644475 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m16:36:37.650243 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m16:36:37.668129 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m16:36:37.674159 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 16:36:37.653220 => 16:36:37.673154
[0m16:36:37.677154 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m16:36:37.764632 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m16:36:37.772256 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:36:37.773793 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m16:36:37.780909 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:44.982235 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m16:36:44.995148 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:36:44.995148 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m16:36:45.232287 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:36:45.232287 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:36:45.232287 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m16:36:45.427873 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:36:45.430455 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:36:45.430455 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m16:36:45.877599 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:36:45.892619 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 16:36:37.679661 => 16:36:45.892619
[0m16:36:45.892619 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m16:36:45.892619 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m16:36:45.892619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b49420d-2439-4e28-b2b9-934ee771cb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC98E4250>]}
[0m16:36:45.908778 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 8.25s]
[0m16:36:45.910795 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m16:36:45.912796 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m16:36:45.913808 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m16:36:45.915810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m16:36:45.916809 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m16:36:45.923818 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m16:36:45.926821 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 16:36:45.917809 => 16:36:45.926821
[0m16:36:45.929001 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m16:36:45.936999 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m16:36:45.946399 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m16:36:45.948404 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m16:36:45.950400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:47.138712 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m16:36:47.143242 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m16:36:47.144260 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m16:36:47.355681 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:36:47.355681 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m16:36:47.355681 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m16:36:47.581106 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:36:47.581106 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m16:36:47.581106 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m16:36:47.836125 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:36:47.836125 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 16:36:45.929001 => 16:36:47.836125
[0m16:36:47.847669 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m16:36:47.847669 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m16:36:47.847669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b49420d-2439-4e28-b2b9-934ee771cb89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC95FA1D0>]}
[0m16:36:47.851716 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.93s]
[0m16:36:47.851716 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m16:36:47.858613 [debug] [MainThread]: On master: COMMIT
[0m16:36:47.861609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:47.862600 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m16:36:47.863603 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m16:36:47.864602 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m16:36:47.865604 [info ] [MainThread]: 
[0m16:36:47.869151 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.68 seconds (13.68s).
[0m16:36:47.872146 [debug] [MainThread]: Command end result
[0m16:36:47.884314 [info ] [MainThread]: 
[0m16:36:47.886345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:47.888348 [info ] [MainThread]: 
[0m16:36:47.891346 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:36:47.894344 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:47.894344 after 15.88 seconds
[0m16:36:47.895344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC6B1A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC97EF7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC99E56C0>]}
[0m16:36:47.896350 [debug] [MainThread]: Flushing usage events
[0m17:26:16.597669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562CEBE830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562C6264D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562C626350>]}


============================== 17:26:16.597669 | e3802762-f125-45a7-970c-de20d57c4dc0 ==============================
[0m17:26:16.597669 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:26:16.597669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:26:16.755171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3802762-f125-45a7-970c-de20d57c4dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562C6264D0>]}
[0m17:26:16.755171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3802762-f125-45a7-970c-de20d57c4dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562FA3B520>]}
[0m17:26:16.787000 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m17:26:17.446494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:17.446494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:17.446494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3802762-f125-45a7-970c-de20d57c4dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562FC65A50>]}
[0m17:26:17.462136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3802762-f125-45a7-970c-de20d57c4dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562FC320B0>]}
[0m17:26:17.462136 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:26:17.462136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3802762-f125-45a7-970c-de20d57c4dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562FC322F0>]}
[0m17:26:17.467664 [info ] [MainThread]: 
[0m17:26:17.467664 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:26:17.467664 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:26:17.479097 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:26:17.479097 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:26:17.479097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:17.856718 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:17.856718 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:26:17.873873 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:26:17.873873 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:26:17.873873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:18.063918 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:18.063918 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:26:18.063918 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m17:26:18.080061 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m17:26:18.080061 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:26:18.080061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:18.369209 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:18.374296 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m17:26:18.374296 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m17:26:18.379320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m17:26:18.383289 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:26:18.383289 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:26:18.383289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:18.611875 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:18.611875 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:26:18.611875 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:26:18.616890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_gold)
[0m17:26:18.623741 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m17:26:18.623741 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:26:18.623741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:18.955243 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:18.955243 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m17:26:18.955243 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m17:26:18.961390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3802762-f125-45a7-970c-de20d57c4dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562FC96EF0>]}
[0m17:26:18.963390 [debug] [MainThread]: On master: COMMIT
[0m17:26:18.963390 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:18.966933 [info ] [MainThread]: 
[0m17:26:18.973461 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:26:18.973461 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:26:18.983000 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:26:18.983000 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:26:18.989529 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:26:18.989529 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:26:18.983000 => 17:26:18.989529
[0m17:26:18.989529 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:26:19.065410 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:26:19.065410 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:26:19.065410 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:26:19.065410 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:20.577301 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m17:26:20.585875 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:26:20.585875 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:26:20.743288 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:20.758967 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:26:20.758967 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:26:20.917333 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:20.927006 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:26:20.927006 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:26:21.172304 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:21.203690 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:26:18.989529 => 17:26:21.203690
[0m17:26:21.203690 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:26:21.203690 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:26:21.203690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3802762-f125-45a7-970c-de20d57c4dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562FD28E80>]}
[0m17:26:21.203690 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.22s]
[0m17:26:21.211044 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:26:21.212891 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m17:26:21.212891 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m17:26:21.212891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m17:26:21.212891 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m17:26:21.221232 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m17:26:21.221232 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 17:26:21.212891 => 17:26:21.221232
[0m17:26:21.223173 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m17:26:21.223173 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m17:26:21.223173 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:26:21.223173 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:26:21.223173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:22.204815 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:26:22.204815 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:26:22.204815 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m17:26:22.355013 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:22.355013 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:26:22.355013 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m17:26:22.555125 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:22.555125 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:26:22.555125 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m17:26:22.783046 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:26:22.789653 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 17:26:21.223173 => 17:26:22.789653
[0m17:26:22.789653 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m17:26:22.792682 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m17:26:22.794887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3802762-f125-45a7-970c-de20d57c4dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562FD480D0>]}
[0m17:26:22.794887 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.58s]
[0m17:26:22.796898 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m17:26:22.796898 [debug] [MainThread]: On master: COMMIT
[0m17:26:22.796898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:22.796898 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:26:22.796898 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m17:26:22.796898 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m17:26:22.796898 [info ] [MainThread]: 
[0m17:26:22.796898 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m17:26:22.808440 [debug] [MainThread]: Command end result
[0m17:26:22.822359 [info ] [MainThread]: 
[0m17:26:22.822359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:26:22.824373 [info ] [MainThread]: 
[0m17:26:22.825143 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:26:22.825143 [debug] [MainThread]: Command `dbt run` succeeded at 17:26:22.825143 after 6.41 seconds
[0m17:26:22.825143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562CEBE830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562FA3B520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562FD9EB00>]}
[0m17:26:22.825143 [debug] [MainThread]: Flushing usage events
[0m15:45:31.443057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B6AEE860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B6256470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B62562F0>]}


============================== 15:45:31.462394 | 0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43 ==============================
[0m15:45:31.462394 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:45:31.462394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:45:31.817974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B6256470>]}
[0m15:45:31.825010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B95FB4C0>]}
[0m15:45:31.874350 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m15:45:31.905291 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:45:31.908090 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m15:45:31.908090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B965F130>]}
[0m15:45:34.468310 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m15:45:34.526872 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m15:45:34.526872 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m15:45:34.668636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B965C0D0>]}
[0m15:45:34.685770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B965C2E0>]}
[0m15:45:34.685770 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:45:34.685770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B9809300>]}
[0m15:45:34.685770 [info ] [MainThread]: 
[0m15:45:34.685770 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:45:34.685770 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m15:45:34.719801 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:45:34.719801 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m15:45:34.719801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:35.718154 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:45:35.722202 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:45:35.734324 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:45:35.734324 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m15:45:35.734324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:36.033192 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:45:36.033192 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:45:36.033192 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m15:45:36.059282 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m15:45:36.062313 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m15:45:36.062313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:37.782196 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m15:45:37.783736 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m15:45:37.783736 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m15:45:37.793298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m15:45:37.804529 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m15:45:37.814571 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m15:45:37.814571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:38.278739 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:45:38.280401 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m15:45:38.285025 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m15:45:38.288052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_gold)
[0m15:45:38.304256 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m15:45:38.304768 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m15:45:38.307533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:39.185252 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:45:39.191191 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m15:45:39.194674 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m15:45:39.200335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B965ECE0>]}
[0m15:45:39.203361 [debug] [MainThread]: On master: COMMIT
[0m15:45:39.204902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:39.208469 [info ] [MainThread]: 
[0m15:45:39.233067 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m15:45:39.233067 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m15:45:39.242239 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m15:45:39.245386 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m15:45:39.262492 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m15:45:39.272188 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 15:45:39.245386 => 15:45:39.272188
[0m15:45:39.275742 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m15:45:39.406534 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m15:45:39.418185 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:45:39.418185 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m15:45:39.418185 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:48.164739 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m15:45:48.182032 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:45:48.187573 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m15:45:48.612147 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:45:48.623209 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:45:48.623209 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m15:45:48.964819 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:45:48.986553 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:45:48.986553 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m15:45:49.674130 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:45:49.713025 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 15:45:39.277333 => 15:45:49.713025
[0m15:45:49.713025 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m15:45:49.718052 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m15:45:49.718052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B98F4250>]}
[0m15:45:49.718052 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 10.48s]
[0m15:45:49.718052 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m15:45:49.718052 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m15:45:49.728083 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m15:45:49.728083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m15:45:49.728083 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m15:45:49.736151 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m15:45:49.736151 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 15:45:49.728083 => 15:45:49.736151
[0m15:45:49.736151 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m15:45:49.752185 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m15:45:49.752185 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:45:49.760207 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m15:45:49.760207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:51.541389 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m15:45:51.549499 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:45:51.559026 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m15:45:51.844142 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:45:51.853089 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:45:51.853089 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m15:45:52.108815 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:45:52.118413 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:45:52.124942 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m15:45:52.475149 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:45:52.487924 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 15:45:49.744168 => 15:45:52.487385
[0m15:45:52.491269 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m15:45:52.494058 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m15:45:52.496636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd07339-56fb-4ddf-bc6a-6d1bc51a7e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B95B6C80>]}
[0m15:45:52.498652 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.77s]
[0m15:45:52.501677 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m15:45:52.509382 [debug] [MainThread]: On master: COMMIT
[0m15:45:52.513150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:52.514832 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m15:45:52.516469 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m15:45:52.518723 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m15:45:52.521083 [info ] [MainThread]: 
[0m15:45:52.523854 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 17.84 seconds (17.84s).
[0m15:45:52.527323 [debug] [MainThread]: Command end result
[0m15:45:52.552249 [info ] [MainThread]: 
[0m15:45:52.555272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:52.557136 [info ] [MainThread]: 
[0m15:45:52.559245 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:45:52.563482 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:52.562901 after 21.38 seconds
[0m15:45:52.565695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B6AEE860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B95FB4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1B99CB370>]}
[0m15:45:52.567788 [debug] [MainThread]: Flushing usage events
[0m15:46:02.046577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBAF9EE830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBAF156500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBAF156320>]}


============================== 15:46:02.064048 | 583025fe-e637-4025-8d44-1b8f1c79075a ==============================
[0m15:46:02.064048 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:46:02.068639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:02.778734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '583025fe-e637-4025-8d44-1b8f1c79075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBAF156500>]}
[0m15:46:02.858554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '583025fe-e637-4025-8d44-1b8f1c79075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBB25174F0>]}
[0m15:46:02.914506 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m15:46:03.003031 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:46:03.006934 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m15:46:03.009342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '583025fe-e637-4025-8d44-1b8f1c79075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBB257A920>]}
[0m15:46:06.328325 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m15:46:06.457148 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m15:46:06.473504 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m15:46:06.765312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '583025fe-e637-4025-8d44-1b8f1c79075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBB25780A0>]}
[0m15:46:06.788653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '583025fe-e637-4025-8d44-1b8f1c79075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBB2578310>]}
[0m15:46:06.792254 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:46:06.794784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '583025fe-e637-4025-8d44-1b8f1c79075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBB2720160>]}
[0m15:46:06.797934 [info ] [MainThread]: 
[0m15:46:06.803966 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:46:06.813840 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m15:46:06.872785 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m15:46:06.876912 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m15:46:06.880504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:07.432450 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:46:07.438629 [debug] [ThreadPool]: On list_clickhouse: Close
[0m15:46:07.452035 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_gold'
[0m15:46:07.493035 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m15:46:07.497619 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m15:46:07.499177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:08.268553 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:46:08.274693 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m15:46:08.278753 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m15:46:08.287035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_bronze)
[0m15:46:08.309232 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m15:46:08.309232 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m15:46:08.318429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:09.154154 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:46:09.161854 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m15:46:09.161854 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m15:46:09.173033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_silver)
[0m15:46:09.195254 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m15:46:09.198849 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m15:46:09.202998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:09.774586 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:46:09.776118 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m15:46:09.776118 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m15:46:09.789251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '583025fe-e637-4025-8d44-1b8f1c79075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBB268F460>]}
[0m15:46:09.791807 [debug] [MainThread]: On master: COMMIT
[0m15:46:09.795268 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m15:46:09.795268 [info ] [MainThread]: 
[0m15:46:09.812397 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m15:46:09.822414 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m15:46:09.823963 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m15:46:09.829577 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m15:46:09.842238 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m15:46:09.842238 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 15:46:09.829577 => 15:46:09.842238
[0m15:46:09.849283 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m15:46:09.986717 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m15:46:09.996523 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m15:46:10.002209 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed,
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m15:46:10.003762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:46:10.046490 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230614_134610_00019_v3ayd
[0m15:46:10.056524 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 19:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20230614_134610_00019_v3ayd)
[0m15:46:10.058560 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 15:46:09.849283 => 15:46:10.058560
[0m15:46:10.062089 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m15:46:10.062089 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m15:46:10.378700 [debug] [Thread-1 (]: Database Error in model weathergold (models\gold\weathergold.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 19:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20230614_134610_00019_v3ayd)
  compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m15:46:10.378700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583025fe-e637-4025-8d44-1b8f1c79075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBB268C8B0>]}
[0m15:46:10.390219 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.weathergold ......................... [[31mERROR[0m in 0.55s]
[0m15:46:10.390219 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m15:46:10.394733 [debug] [MainThread]: On master: COMMIT
[0m15:46:10.394733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:10.394733 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m15:46:10.394733 [debug] [MainThread]: Connection 'list_clickhouse_silver' was properly closed.
[0m15:46:10.394733 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m15:46:10.394733 [info ] [MainThread]: 
[0m15:46:10.394733 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m15:46:10.394733 [debug] [MainThread]: Command end result
[0m15:46:10.417330 [info ] [MainThread]: 
[0m15:46:10.417330 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:46:10.422350 [info ] [MainThread]: 
[0m15:46:10.422350 [error] [MainThread]: [33mDatabase Error in model weathergold (models\gold\weathergold.sql)[0m
[0m15:46:10.425613 [error] [MainThread]:   TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 19:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20230614_134610_00019_v3ayd)
[0m15:46:10.425613 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m15:46:10.425613 [info ] [MainThread]: 
[0m15:46:10.425613 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:46:10.425613 [debug] [MainThread]: Command `dbt run` failed at 15:46:10.425613 after 8.48 seconds
[0m15:46:10.435131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBAF9EE830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBB26EB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBB2649B70>]}
[0m15:46:10.435131 [debug] [MainThread]: Flushing usage events
[0m15:46:59.326760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21BCBA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21B42A4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21B42A260>]}


============================== 15:46:59.334835 | bf907f8a-0007-4169-8afa-b52f9251cce2 ==============================
[0m15:46:59.334835 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:46:59.334835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:59.714173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf907f8a-0007-4169-8afa-b52f9251cce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21B42A590>]}
[0m15:46:59.758427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf907f8a-0007-4169-8afa-b52f9251cce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21E7FF4C0>]}
[0m15:46:59.809180 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m15:47:00.102421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:47:00.104549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:47:00.125936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf907f8a-0007-4169-8afa-b52f9251cce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21EA259F0>]}
[0m15:47:00.153622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf907f8a-0007-4169-8afa-b52f9251cce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21E9FA050>]}
[0m15:47:00.155262 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:47:00.159920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf907f8a-0007-4169-8afa-b52f9251cce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21E9FA290>]}
[0m15:47:00.163954 [info ] [MainThread]: 
[0m15:47:00.169191 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:47:00.178135 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m15:47:00.236033 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m15:47:00.238912 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m15:47:00.241226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:00.986383 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:47:00.993115 [debug] [ThreadPool]: On list_clickhouse: Close
[0m15:47:01.007249 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_bronze'
[0m15:47:01.049847 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m15:47:01.052896 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m15:47:01.054457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:02.477762 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:47:02.483227 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m15:47:02.486032 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m15:47:02.490923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_silver)
[0m15:47:02.513505 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m15:47:02.515552 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m15:47:02.518773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:04.472305 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m15:47:04.481516 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m15:47:04.484251 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m15:47:04.490439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_gold)
[0m15:47:04.511053 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m15:47:04.515620 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m15:47:04.518275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:05.696125 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:47:05.704403 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m15:47:05.706577 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m15:47:05.712264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf907f8a-0007-4169-8afa-b52f9251cce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21EA4E920>]}
[0m15:47:05.717320 [debug] [MainThread]: On master: COMMIT
[0m15:47:05.720459 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m15:47:05.722003 [info ] [MainThread]: 
[0m15:47:05.744616 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m15:47:05.748172 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m15:47:05.755817 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m15:47:05.757872 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m15:47:05.771547 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m15:47:05.778187 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 15:47:05.760485 => 15:47:05.775642
[0m15:47:05.780041 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m15:47:05.976632 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m15:47:06.001933 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m15:47:06.005568 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed,
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m15:47:06.010712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:47:06.092182 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230614_134706_00024_v3ayd
[0m15:47:06.093744 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 19:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20230614_134706_00024_v3ayd)
[0m15:47:06.100950 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 15:47:05.782556 => 15:47:06.097347
[0m15:47:06.103038 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m15:47:06.106748 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m15:47:06.128907 [debug] [Thread-1 (]: Database Error in model weathergold (models\gold\weathergold.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 19:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20230614_134706_00024_v3ayd)
  compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m15:47:06.129964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf907f8a-0007-4169-8afa-b52f9251cce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21EAA4BE0>]}
[0m15:47:06.133503 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.weathergold ......................... [[31mERROR[0m in 0.38s]
[0m15:47:06.141196 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m15:47:06.146841 [debug] [MainThread]: On master: COMMIT
[0m15:47:06.149424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:06.149424 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m15:47:06.154468 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m15:47:06.157035 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m15:47:06.160069 [info ] [MainThread]: 
[0m15:47:06.162670 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m15:47:06.166877 [debug] [MainThread]: Command end result
[0m15:47:06.194547 [info ] [MainThread]: 
[0m15:47:06.199775 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:47:06.200814 [info ] [MainThread]: 
[0m15:47:06.200814 [error] [MainThread]: [33mDatabase Error in model weathergold (models\gold\weathergold.sql)[0m
[0m15:47:06.205372 [error] [MainThread]:   TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 19:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20230614_134706_00024_v3ayd)
[0m15:47:06.205372 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m15:47:06.211520 [info ] [MainThread]: 
[0m15:47:06.217950 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:47:06.223120 [debug] [MainThread]: Command `dbt run` failed at 15:47:06.223120 after 6.94 seconds
[0m15:47:06.223120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21BCBA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21EACD840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A21E85ABF0>]}
[0m15:47:06.229219 [debug] [MainThread]: Flushing usage events
[0m15:48:52.272436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E2ABE800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E22264D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E2226380>]}


============================== 15:48:52.272436 | d5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29 ==============================
[0m15:48:52.272436 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:48:52.272436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:48:52.534333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E22264D0>]}
[0m15:48:52.553004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E566B4F0>]}
[0m15:48:52.573467 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m15:48:52.575487 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:48:52.575487 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m15:48:52.575487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E56CA920>]}
[0m15:48:53.541778 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m15:48:53.595174 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m15:48:53.610885 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m15:48:53.816582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E56C80A0>]}
[0m15:48:53.829276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E56C8310>]}
[0m15:48:53.829276 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:48:53.833816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E5870610>]}
[0m15:48:53.836671 [info ] [MainThread]: 
[0m15:48:53.836671 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:48:53.836671 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m15:48:53.865209 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:48:53.867236 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m15:48:53.869602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:54.032906 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:48:54.033936 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:48:54.044491 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:48:54.044491 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m15:48:54.048068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:54.183964 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:48:54.189017 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:48:54.189017 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m15:48:54.218676 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m15:48:54.218676 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m15:48:54.230304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:54.527958 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:48:54.532568 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m15:48:54.534359 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m15:48:54.534359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_gold)
[0m15:48:54.551003 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m15:48:54.554050 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m15:48:54.554050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:54.820322 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:48:54.828382 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m15:48:54.828382 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m15:48:54.830928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_silver)
[0m15:48:54.844630 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m15:48:54.844630 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m15:48:54.847153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:55.154721 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:48:55.162888 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m15:48:55.162888 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m15:48:55.167203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E564D540>]}
[0m15:48:55.172689 [debug] [MainThread]: On master: COMMIT
[0m15:48:55.172689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:55.172689 [info ] [MainThread]: 
[0m15:48:55.198084 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m15:48:55.198084 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m15:48:55.198084 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m15:48:55.208636 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m15:48:55.217696 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m15:48:55.217696 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 15:48:55.210274 => 15:48:55.217696
[0m15:48:55.225956 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m15:48:55.345272 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m15:48:55.354744 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:48:55.354744 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m15:48:55.354744 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:57.783900 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m15:48:57.811246 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:48:57.811246 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m15:48:58.149660 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:48:58.163973 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:48:58.163973 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m15:48:58.469135 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:48:58.484831 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:48:58.484831 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m15:48:58.835522 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:48:58.863667 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 15:48:55.226972 => 15:48:58.863667
[0m15:48:58.863667 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m15:48:58.863667 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m15:48:58.872702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E5960250>]}
[0m15:48:58.872702 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 3.67s]
[0m15:48:58.872702 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m15:48:58.879575 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m15:48:58.880179 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m15:48:58.880179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m15:48:58.880179 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m15:48:58.880179 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m15:48:58.894697 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 15:48:58.880179 => 15:48:58.880179
[0m15:48:58.896156 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m15:48:58.899941 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m15:48:58.910464 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:48:58.910464 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m15:48:58.915090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:00.628662 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m15:49:00.639796 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:49:00.645387 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m15:49:00.933923 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:00.951522 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:49:00.951522 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m15:49:01.259592 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:01.263647 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:49:01.263647 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m15:49:01.667538 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:01.678287 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 15:48:58.896156 => 15:49:01.678287
[0m15:49:01.679838 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m15:49:01.681909 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m15:49:01.687439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c9e48d-6ebf-4f65-9ae1-d078dd1b5e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E59BC520>]}
[0m15:49:01.689768 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.80s]
[0m15:49:01.691460 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m15:49:01.691460 [debug] [MainThread]: On master: COMMIT
[0m15:49:01.691460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:01.702899 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m15:49:01.705484 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m15:49:01.706313 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m15:49:01.706313 [info ] [MainThread]: 
[0m15:49:01.712672 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.87 seconds (7.87s).
[0m15:49:01.714878 [debug] [MainThread]: Command end result
[0m15:49:01.749186 [info ] [MainThread]: 
[0m15:49:01.752368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:01.754462 [info ] [MainThread]: 
[0m15:49:01.757965 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:49:01.760786 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:01.760786 after 9.52 seconds
[0m15:49:01.760786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E2ABE800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E564D540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114E583B7C0>]}
[0m15:49:01.765534 [debug] [MainThread]: Flushing usage events
[0m15:49:15.932971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334210E860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233418764D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023341876350>]}


============================== 15:49:15.945700 | 2257fd84-c201-4c22-93c3-126de3bcd059 ==============================
[0m15:49:15.945700 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:49:15.948786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:49:16.390412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2257fd84-c201-4c22-93c3-126de3bcd059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233418764D0>]}
[0m15:49:16.430310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2257fd84-c201-4c22-93c3-126de3bcd059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023344C5B4C0>]}
[0m15:49:16.468974 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m15:49:16.524155 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:49:16.526928 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m15:49:16.526928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2257fd84-c201-4c22-93c3-126de3bcd059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023344CBB190>]}
[0m15:49:18.171721 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m15:49:18.237615 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m15:49:18.247646 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m15:49:18.392741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2257fd84-c201-4c22-93c3-126de3bcd059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023344CB80D0>]}
[0m15:49:18.392741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2257fd84-c201-4c22-93c3-126de3bcd059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023344CB82E0>]}
[0m15:49:18.392741 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:49:18.392741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2257fd84-c201-4c22-93c3-126de3bcd059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023344E61180>]}
[0m15:49:18.409076 [info ] [MainThread]: 
[0m15:49:18.409076 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:49:18.409076 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m15:49:18.424091 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m15:49:18.424091 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m15:49:18.424091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:18.576669 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:18.582786 [debug] [ThreadPool]: On list_clickhouse: Close
[0m15:49:18.588688 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_bronze'
[0m15:49:18.614548 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m15:49:18.614548 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m15:49:18.614548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:19.158230 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:49:19.164889 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m15:49:19.168237 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m15:49:19.172787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_silver)
[0m15:49:19.193762 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m15:49:19.194490 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m15:49:19.199121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:19.734858 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:49:19.739436 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m15:49:19.740982 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m15:49:19.748687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_gold)
[0m15:49:19.766534 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m15:49:19.769482 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m15:49:19.771095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:20.393511 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:49:20.400598 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m15:49:20.403485 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m15:49:20.410597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2257fd84-c201-4c22-93c3-126de3bcd059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023344D2ABC0>]}
[0m15:49:20.412327 [debug] [MainThread]: On master: COMMIT
[0m15:49:20.416898 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m15:49:20.421500 [info ] [MainThread]: 
[0m15:49:20.439954 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m15:49:20.447805 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m15:49:20.453821 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m15:49:20.456662 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m15:49:20.471460 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m15:49:20.478758 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 15:49:20.459201 => 15:49:20.477104
[0m15:49:20.481914 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m15:49:20.681462 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m15:49:20.691652 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m15:49:20.693224 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m15:49:20.695774 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:21.458634 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:49:21.485690 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m15:49:21.487287 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m15:49:21.590978 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:21.606900 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m15:49:21.609525 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m15:49:21.697547 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:21.726366 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m15:49:21.726896 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m15:49:21.807169 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:49:21.853130 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 15:49:20.484036 => 15:49:21.853130
[0m15:49:21.853130 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m15:49:21.853130 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m15:49:21.860978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2257fd84-c201-4c22-93c3-126de3bcd059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023344F6EAD0>]}
[0m15:49:21.863939 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 1.41s]
[0m15:49:21.865321 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m15:49:21.870436 [debug] [MainThread]: On master: COMMIT
[0m15:49:21.870436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:21.870436 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m15:49:21.870436 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m15:49:21.870436 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m15:49:21.878909 [info ] [MainThread]: 
[0m15:49:21.878909 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m15:49:21.878909 [debug] [MainThread]: Command end result
[0m15:49:21.893625 [info ] [MainThread]: 
[0m15:49:21.901221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:21.903966 [info ] [MainThread]: 
[0m15:49:21.903966 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:49:21.908037 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:21.908037 after 6.03 seconds
[0m15:49:21.911262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002334210E860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023343DB3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023344D2ABC0>]}
[0m15:49:21.911262 [debug] [MainThread]: Flushing usage events
[0m17:51:28.049919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8F3CE800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8EB36500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8EB36380>]}


============================== 17:51:28.049919 | e280022c-2c89-4f43-882b-66c044eca441 ==============================
[0m17:51:28.049919 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:51:28.049919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:51:28.291161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e280022c-2c89-4f43-882b-66c044eca441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8EB36500>]}
[0m17:51:28.301674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e280022c-2c89-4f43-882b-66c044eca441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B91F9B4F0>]}
[0m17:51:28.333548 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m17:51:28.333548 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:51:28.333548 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m17:51:28.333548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e280022c-2c89-4f43-882b-66c044eca441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B91FFB5E0>]}
[0m17:51:30.255639 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:51:30.313002 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:51:30.314512 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m17:51:30.483510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e280022c-2c89-4f43-882b-66c044eca441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B91F761A0>]}
[0m17:51:30.500204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e280022c-2c89-4f43-882b-66c044eca441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B91F74BE0>]}
[0m17:51:30.502320 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:51:30.502320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e280022c-2c89-4f43-882b-66c044eca441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B921A0460>]}
[0m17:51:30.505367 [info ] [MainThread]: 
[0m17:51:30.509457 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:51:30.512496 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:51:30.534143 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:51:30.534143 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:51:30.534143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:31.888838 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:51:31.888838 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:51:31.900748 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:51:31.900748 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:51:31.900748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:32.148190 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:32.154229 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:51:32.158487 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m17:51:32.186173 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m17:51:32.186173 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:51:32.190194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:32.786627 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:51:32.786627 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m17:51:32.786627 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m17:51:32.796189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_silver)
[0m17:51:32.801768 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m17:51:32.817424 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:51:32.817424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:33.150807 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:33.152973 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m17:51:33.152973 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m17:51:33.152973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m17:51:33.170319 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:51:33.170319 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:51:33.170319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:33.529285 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:33.529285 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:51:33.529285 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:51:33.538816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e280022c-2c89-4f43-882b-66c044eca441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B916A0E50>]}
[0m17:51:33.538816 [debug] [MainThread]: On master: COMMIT
[0m17:51:33.544402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:33.548644 [info ] [MainThread]: 
[0m17:51:33.560711 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:51:33.560711 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:51:33.560711 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:51:33.560711 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:51:33.581922 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:51:33.592455 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:51:33.576366 => 17:51:33.592455
[0m17:51:33.592455 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:51:33.707547 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:51:33.713352 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:51:33.713352 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:51:33.713352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:38.553038 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m17:51:38.574432 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:51:38.574432 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:51:38.871398 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:38.886140 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:51:38.886140 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:51:39.194720 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:39.202798 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:51:39.202798 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:51:39.603375 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:39.628045 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:51:33.596974 => 17:51:39.628045
[0m17:51:39.628045 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:51:39.628045 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:51:39.628045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e280022c-2c89-4f43-882b-66c044eca441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B90FC1D80>]}
[0m17:51:39.628045 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 6.07s]
[0m17:51:39.628045 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:51:39.628045 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m17:51:39.643670 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m17:51:39.643670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m17:51:39.643670 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m17:51:39.643670 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m17:51:39.643670 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 17:51:39.643670 => 17:51:39.643670
[0m17:51:39.643670 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m17:51:39.659295 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m17:51:39.674945 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:51:39.674945 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:51:39.674945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:41.710769 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m17:51:41.715287 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:51:41.715287 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m17:51:41.968596 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:41.980120 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:51:41.980120 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m17:51:42.218227 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:42.233885 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:51:42.233885 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m17:51:42.457966 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:42.478047 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 17:51:39.659295 => 17:51:42.474010
[0m17:51:42.478047 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m17:51:42.481503 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m17:51:42.481503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e280022c-2c89-4f43-882b-66c044eca441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B90FC1D80>]}
[0m17:51:42.481503 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.84s]
[0m17:51:42.488522 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m17:51:42.492539 [debug] [MainThread]: On master: COMMIT
[0m17:51:42.492539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:42.497571 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:51:42.497571 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:51:42.497571 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m17:51:42.497571 [info ] [MainThread]: 
[0m17:51:42.504612 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 11.99 seconds (11.99s).
[0m17:51:42.505627 [debug] [MainThread]: Command end result
[0m17:51:42.521670 [info ] [MainThread]: 
[0m17:51:42.521670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:42.521670 [info ] [MainThread]: 
[0m17:51:42.521670 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:51:42.533215 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:42.531681 after 14.64 seconds
[0m17:51:42.533215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8F3CE800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B90F507F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B92167880>]}
[0m17:51:42.537792 [debug] [MainThread]: Flushing usage events
[0m17:51:47.292452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BB71E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BAE864D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BAE86380>]}


============================== 17:51:47.292452 | acd01f7c-f94b-4863-ae1c-ec5cacacb88c ==============================
[0m17:51:47.292452 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:51:47.292452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:51:47.528440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acd01f7c-f94b-4863-ae1c-ec5cacacb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BAE864D0>]}
[0m17:51:47.559710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acd01f7c-f94b-4863-ae1c-ec5cacacb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BE2AB4F0>]}
[0m17:51:47.575331 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m17:51:47.591534 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:51:47.591534 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m17:51:47.591534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acd01f7c-f94b-4863-ae1c-ec5cacacb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BE3075E0>]}
[0m17:51:48.674459 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:51:48.737395 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:51:48.753111 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m17:51:48.894684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acd01f7c-f94b-4863-ae1c-ec5cacacb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BE3D76A0>]}
[0m17:51:48.894684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acd01f7c-f94b-4863-ae1c-ec5cacacb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BE3D62C0>]}
[0m17:51:48.910333 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:51:48.910333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd01f7c-f94b-4863-ae1c-ec5cacacb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BE4B03A0>]}
[0m17:51:48.910333 [info ] [MainThread]: 
[0m17:51:48.916850 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:51:48.916850 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m17:51:48.942016 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m17:51:48.942016 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m17:51:48.942016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:49.561126 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:51:49.570141 [debug] [ThreadPool]: On list_clickhouse: Close
[0m17:51:49.570141 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_gold'
[0m17:51:49.598125 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m17:51:49.599229 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:51:49.599787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:49.901945 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:49.901945 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m17:51:49.901945 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m17:51:49.913512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_silver)
[0m17:51:49.929820 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m17:51:49.929820 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:51:49.929820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:50.174776 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:50.179325 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m17:51:50.179325 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m17:51:50.184909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m17:51:50.190928 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m17:51:50.190928 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:51:50.199978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:50.476986 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:50.484030 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m17:51:50.485548 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m17:51:50.485548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd01f7c-f94b-4863-ae1c-ec5cacacb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BE3A9F00>]}
[0m17:51:50.485548 [debug] [MainThread]: On master: COMMIT
[0m17:51:50.485548 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m17:51:50.485548 [info ] [MainThread]: 
[0m17:51:50.504263 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m17:51:50.504263 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m17:51:50.504263 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m17:51:50.517294 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m17:51:50.519353 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m17:51:50.533374 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 17:51:50.519353 => 17:51:50.533374
[0m17:51:50.535396 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m17:51:50.629906 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m17:51:50.629906 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:51:50.645017 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m17:51:50.646567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:51.235034 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:51:51.248561 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:51:51.248561 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m17:51:51.343288 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:51.347407 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:51:51.347407 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m17:51:51.438645 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:51.454286 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:51:51.454286 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m17:51:51.519834 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:51:51.549036 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 17:51:50.535396 => 17:51:51.549036
[0m17:51:51.549036 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m17:51:51.549036 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m17:51:51.549036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acd01f7c-f94b-4863-ae1c-ec5cacacb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BE304790>]}
[0m17:51:51.564663 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 1.04s]
[0m17:51:51.564663 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m17:51:51.564663 [debug] [MainThread]: On master: COMMIT
[0m17:51:51.564663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:51.564663 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m17:51:51.564663 [debug] [MainThread]: Connection 'list_clickhouse_bronze' was properly closed.
[0m17:51:51.564663 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m17:51:51.580284 [info ] [MainThread]: 
[0m17:51:51.580284 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m17:51:51.580284 [debug] [MainThread]: Command end result
[0m17:51:51.595905 [info ] [MainThread]: 
[0m17:51:51.595905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:51.595905 [info ] [MainThread]: 
[0m17:51:51.595905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:51:51.611531 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:51.611531 after 4.34 seconds
[0m17:51:51.611531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BB71E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BE2AB4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BE3D68F0>]}
[0m17:51:51.616731 [debug] [MainThread]: Flushing usage events
[0m17:58:35.034381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE6536E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE64AD64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE64AD6350>]}


============================== 17:58:35.034381 | b5e3eb47-3454-4fe9-b590-e1e3083330a7 ==============================
[0m17:58:35.034381 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:58:35.050099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:58:35.275616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5e3eb47-3454-4fe9-b590-e1e3083330a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE64AD64D0>]}
[0m17:58:35.293153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5e3eb47-3454-4fe9-b590-e1e3083330a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE67E6B4C0>]}
[0m17:58:35.321287 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m17:58:35.333312 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:58:35.338348 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m17:58:35.338348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5e3eb47-3454-4fe9-b590-e1e3083330a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE67ECB3A0>]}
[0m17:58:37.281095 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:58:37.332193 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:58:37.343776 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m17:58:37.439208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5e3eb47-3454-4fe9-b590-e1e3083330a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE67E4F160>]}
[0m17:58:37.458179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5e3eb47-3454-4fe9-b590-e1e3083330a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE67E4D360>]}
[0m17:58:37.458179 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:58:37.458179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e3eb47-3454-4fe9-b590-e1e3083330a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE680745E0>]}
[0m17:58:37.466194 [info ] [MainThread]: 
[0m17:58:37.466194 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:58:37.466194 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:58:37.486352 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:58:37.486352 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:58:37.489370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:37.684498 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:37.684498 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:58:37.694047 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:58:37.694047 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:58:37.694047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:37.790467 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:37.790467 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:58:37.802530 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m17:58:37.822159 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m17:58:37.822159 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:58:37.822159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:38.058625 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:38.058625 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m17:58:38.058625 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m17:58:38.066685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m17:58:38.072662 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:58:38.084213 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:58:38.084213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:38.318722 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:38.323248 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:58:38.323248 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:58:38.330308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_gold)
[0m17:58:38.339355 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m17:58:38.339355 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:58:38.350878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:38.537829 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:38.541380 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m17:58:38.543910 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m17:58:38.543910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e3eb47-3454-4fe9-b590-e1e3083330a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE67E4D420>]}
[0m17:58:38.547926 [debug] [MainThread]: On master: COMMIT
[0m17:58:38.547926 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:38.553461 [info ] [MainThread]: 
[0m17:58:38.567415 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:58:38.569449 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:58:38.571472 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:58:38.576000 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:58:38.579014 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:58:38.589086 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:58:38.576000 => 17:58:38.589086
[0m17:58:38.593546 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:58:38.683796 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:58:38.689515 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:58:38.693070 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:58:38.693070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:40.719123 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m17:58:40.744461 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:58:40.744993 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:58:41.050309 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:41.066214 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:58:41.070729 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:58:41.331778 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:41.347511 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:58:41.347511 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:58:41.718753 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:41.761529 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:58:38.593546 => 17:58:41.761529
[0m17:58:41.761529 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:58:41.761529 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:58:41.761529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e3eb47-3454-4fe9-b590-e1e3083330a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE6815C250>]}
[0m17:58:41.761529 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 3.19s]
[0m17:58:41.771548 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:58:41.775105 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m17:58:41.780676 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m17:58:41.783947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m17:58:41.785733 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m17:58:41.793485 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m17:58:41.796009 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 17:58:41.786872 => 17:58:41.796009
[0m17:58:41.796009 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m17:58:41.805551 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m17:58:41.824007 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:58:41.826784 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:58:41.829036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:42.855752 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:58:42.858779 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:58:42.858779 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m17:58:43.047354 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:43.052368 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:58:43.052368 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m17:58:43.239619 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:43.245236 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m17:58:43.245236 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m17:58:43.515178 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:43.515178 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 17:58:41.796009 => 17:58:43.515178
[0m17:58:43.515178 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m17:58:43.515178 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m17:58:43.524699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e3eb47-3454-4fe9-b590-e1e3083330a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE681C04C0>]}
[0m17:58:43.526237 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.74s]
[0m17:58:43.526237 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m17:58:43.526237 [debug] [MainThread]: On master: COMMIT
[0m17:58:43.526237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:43.526237 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:58:43.526237 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m17:58:43.537765 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m17:58:43.537765 [info ] [MainThread]: 
[0m17:58:43.537765 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m17:58:43.543832 [debug] [MainThread]: Command end result
[0m17:58:43.543832 [info ] [MainThread]: 
[0m17:58:43.543832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:43.543832 [info ] [MainThread]: 
[0m17:58:43.557850 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:58:43.557850 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:43.557850 after 8.72 seconds
[0m17:58:43.560365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE6536E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE67E6B4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE67EC9AE0>]}
[0m17:58:43.560365 [debug] [MainThread]: Flushing usage events
[0m17:58:49.148218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAB50E860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAAC764A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAAC76320>]}


============================== 17:58:49.148218 | 55714108-87b2-4200-866b-96d8d023b186 ==============================
[0m17:58:49.148218 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:58:49.148218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:58:49.513953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55714108-87b2-4200-866b-96d8d023b186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAAC764A0>]}
[0m17:58:49.547281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55714108-87b2-4200-866b-96d8d023b186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE0974F0>]}
[0m17:58:49.578663 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m17:58:49.615383 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:58:49.615383 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m17:58:49.615383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55714108-87b2-4200-866b-96d8d023b186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE0F5D20>]}
[0m17:58:50.996274 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:58:51.059243 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m17:58:51.059243 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m17:58:51.203379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55714108-87b2-4200-866b-96d8d023b186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE0F40A0>]}
[0m17:58:51.217401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55714108-87b2-4200-866b-96d8d023b186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE0F4310>]}
[0m17:58:51.217401 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:58:51.217401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55714108-87b2-4200-866b-96d8d023b186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE2A1C90>]}
[0m17:58:51.217401 [info ] [MainThread]: 
[0m17:58:51.217401 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:58:51.233043 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m17:58:51.253549 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m17:58:51.253549 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m17:58:51.253549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:51.394309 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.394309 [debug] [ThreadPool]: On list_clickhouse: Close
[0m17:58:51.407378 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_gold'
[0m17:58:51.425110 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m17:58:51.425110 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m17:58:51.425110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:51.654682 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.660766 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m17:58:51.660766 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m17:58:51.666298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_silver)
[0m17:58:51.680920 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m17:58:51.680920 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m17:58:51.686466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:51.944761 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.950300 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m17:58:51.950300 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m17:58:51.952343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m17:58:51.972556 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m17:58:51.974096 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:58:51.978608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:52.199218 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:52.205255 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m17:58:52.210310 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m17:58:52.212330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55714108-87b2-4200-866b-96d8d023b186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE0F7BB0>]}
[0m17:58:52.212330 [debug] [MainThread]: On master: COMMIT
[0m17:58:52.212330 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m17:58:52.222868 [info ] [MainThread]: 
[0m17:58:52.240010 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m17:58:52.240010 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m17:58:52.242064 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m17:58:52.246582 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m17:58:52.258267 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m17:58:52.258267 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 17:58:52.246582 => 17:58:52.258267
[0m17:58:52.263781 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m17:58:52.400154 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m17:58:52.413801 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:58:52.416116 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m17:58:52.419166 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:53.040436 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:58:53.061250 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:58:53.061250 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m17:58:53.172818 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:53.183494 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:58:53.183494 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m17:58:53.291308 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:53.313976 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m17:58:53.316496 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m17:58:53.401151 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:53.459007 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 17:58:52.263781 => 17:58:53.459007
[0m17:58:53.459007 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m17:58:53.459007 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m17:58:53.470518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55714108-87b2-4200-866b-96d8d023b186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE3638B0>]}
[0m17:58:53.470518 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 1.23s]
[0m17:58:53.470518 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m17:58:53.480401 [debug] [MainThread]: On master: COMMIT
[0m17:58:53.486438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:53.486438 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m17:58:53.486438 [debug] [MainThread]: Connection 'list_clickhouse_bronze' was properly closed.
[0m17:58:53.489957 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m17:58:53.489957 [info ] [MainThread]: 
[0m17:58:53.489957 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m17:58:53.498998 [debug] [MainThread]: Command end result
[0m17:58:53.518151 [info ] [MainThread]: 
[0m17:58:53.526020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:53.526020 [info ] [MainThread]: 
[0m17:58:53.526020 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:58:53.537560 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:53.534040 after 4.41 seconds
[0m17:58:53.538593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAB50E860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE3A2FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCAE26B880>]}
[0m17:58:53.538593 [debug] [MainThread]: Flushing usage events
[0m18:01:01.110432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997DC1E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199007F64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199007F6350>]}


============================== 18:01:01.116434 | aca3dfec-e70f-4c9e-b041-a2c7a5a172e3 ==============================
[0m18:01:01.116434 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:01:01.117429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:01:01.336783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aca3dfec-e70f-4c9e-b041-a2c7a5a172e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199007F64D0>]}
[0m18:01:01.358863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aca3dfec-e70f-4c9e-b041-a2c7a5a172e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990094B4C0>]}
[0m18:01:01.368392 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m18:01:01.384029 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:01:01.387540 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m18:01:01.387540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aca3dfec-e70f-4c9e-b041-a2c7a5a172e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199009AB190>]}
[0m18:01:02.906097 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:01:03.038185 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:01:03.044752 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:01:03.238826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aca3dfec-e70f-4c9e-b041-a2c7a5a172e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199009A80D0>]}
[0m18:01:03.253845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aca3dfec-e70f-4c9e-b041-a2c7a5a172e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199009A82E0>]}
[0m18:01:03.253845 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:01:03.253845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aca3dfec-e70f-4c9e-b041-a2c7a5a172e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019900B50280>]}
[0m18:01:03.253845 [info ] [MainThread]: 
[0m18:01:03.253845 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:01:03.253845 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:01:03.298357 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:01:03.299356 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:01:03.300358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:03.449339 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.453939 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:01:03.463152 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:01:03.465185 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:01:03.465185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:03.553253 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.556295 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:01:03.558326 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m18:01:03.585262 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m18:01:03.585262 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:01:03.585262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:03.741853 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.741853 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m18:01:03.750888 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m18:01:03.755466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m18:01:03.770110 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:01:03.771153 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:01:03.775168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:04.010827 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:04.015854 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:01:04.017987 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:01:04.022011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m18:01:04.038504 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:01:04.041490 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:01:04.043480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:04.284674 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:04.290854 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:01:04.290854 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:01:04.298373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aca3dfec-e70f-4c9e-b041-a2c7a5a172e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001990092D1E0>]}
[0m18:01:04.298373 [debug] [MainThread]: On master: COMMIT
[0m18:01:04.305369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:04.307756 [info ] [MainThread]: 
[0m18:01:04.324000 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:01:04.324000 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:01:04.335494 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:01:04.339736 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:01:04.362183 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:01:04.366714 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:01:04.345259 => 18:01:04.366714
[0m18:01:04.366714 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:01:04.542760 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:01:04.553069 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:04.555771 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:01:04.559291 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:06.345250 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:01:06.367178 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:06.369176 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:01:06.581723 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:06.592669 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:06.595746 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:01:06.822472 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:06.842877 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:01:06.845971 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:01:07.146150 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:07.202937 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:01:04.374736 => 18:01:07.202389
[0m18:01:07.204998 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:01:07.206962 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:01:07.211625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca3dfec-e70f-4c9e-b041-a2c7a5a172e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199008F4A00>]}
[0m18:01:07.213630 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.88s]
[0m18:01:07.217670 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:01:07.220901 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:01:07.222917 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:01:07.226531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:01:07.228888 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:01:07.238979 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:01:07.245167 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:01:07.230905 => 18:01:07.243662
[0m18:01:07.247187 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:01:07.263082 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:01:07.275619 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:07.279623 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:01:07.281620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:08.468614 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:01:08.480602 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:08.481603 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:01:08.715391 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:08.726984 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:08.729987 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:01:09.042034 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:09.055943 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:01:09.059471 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:01:09.482547 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:09.493336 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:01:07.248186 => 18:01:09.491802
[0m18:01:09.495976 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:01:09.499224 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:01:09.503695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aca3dfec-e70f-4c9e-b041-a2c7a5a172e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019900B7EAA0>]}
[0m18:01:09.506687 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.28s]
[0m18:01:09.510234 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:01:09.516094 [debug] [MainThread]: On master: COMMIT
[0m18:01:09.520650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:09.523189 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:01:09.525191 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m18:01:09.526770 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:01:09.529738 [info ] [MainThread]: 
[0m18:01:09.531739 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.27 seconds (6.27s).
[0m18:01:09.537882 [debug] [MainThread]: Command end result
[0m18:01:09.569812 [info ] [MainThread]: 
[0m18:01:09.573064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:09.577997 [info ] [MainThread]: 
[0m18:01:09.581336 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:01:09.586375 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:09.586375 after 8.51 seconds
[0m18:01:09.589504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001997DC1E830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019900B7EAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019900B6EFE0>]}
[0m18:01:09.593357 [debug] [MainThread]: Flushing usage events
[0m18:01:15.546311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BA77E860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B9EE64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B9EE6350>]}


============================== 18:01:15.558965 | 2f40bfbe-605f-42c3-bacc-5c08a1e5ebe2 ==============================
[0m18:01:15.558965 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:01:15.561969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:01:15.907053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f40bfbe-605f-42c3-bacc-5c08a1e5ebe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209B9EE64D0>]}
[0m18:01:15.934989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f40bfbe-605f-42c3-bacc-5c08a1e5ebe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BD28B4C0>]}
[0m18:01:15.959977 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m18:01:15.994050 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:01:15.995992 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m18:01:15.999436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f40bfbe-605f-42c3-bacc-5c08a1e5ebe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BD2EA8F0>]}
[0m18:01:17.109585 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:01:17.177572 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:01:17.184572 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:01:17.352508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f40bfbe-605f-42c3-bacc-5c08a1e5ebe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BD2E80D0>]}
[0m18:01:17.368418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f40bfbe-605f-42c3-bacc-5c08a1e5ebe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BD2E82E0>]}
[0m18:01:17.368939 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:01:17.370956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f40bfbe-605f-42c3-bacc-5c08a1e5ebe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BD4931C0>]}
[0m18:01:17.373960 [info ] [MainThread]: 
[0m18:01:17.375960 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:01:17.377959 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m18:01:17.404929 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m18:01:17.404929 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m18:01:17.404929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:17.522567 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:17.526531 [debug] [ThreadPool]: On list_clickhouse: Close
[0m18:01:17.531053 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_bronze'
[0m18:01:17.548455 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m18:01:17.550457 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:01:17.550457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:17.708356 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:17.713377 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m18:01:17.715377 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m18:01:17.719380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m18:01:17.732232 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m18:01:17.734210 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:01:17.734720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:17.899927 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:17.903971 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m18:01:17.906511 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m18:01:17.911083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_silver)
[0m18:01:17.920671 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m18:01:17.921669 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:01:17.924213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:18.098817 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:18.104366 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m18:01:18.106369 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m18:01:18.109371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f40bfbe-605f-42c3-bacc-5c08a1e5ebe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BD35DAE0>]}
[0m18:01:18.113004 [debug] [MainThread]: On master: COMMIT
[0m18:01:18.115009 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m18:01:18.116010 [info ] [MainThread]: 
[0m18:01:18.132177 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m18:01:18.133178 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m18:01:18.136719 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m18:01:18.139624 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m18:01:18.146953 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m18:01:18.150488 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 18:01:18.141622 => 18:01:18.149485
[0m18:01:18.153605 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m18:01:18.224613 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m18:01:18.224613 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:01:18.224613 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m18:01:18.236437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:18.544769 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:18.553966 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:01:18.561546 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m18:01:18.674770 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:18.674770 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:01:18.690456 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m18:01:18.741265 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:18.767376 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:01:18.767376 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m18:01:18.876544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:18.931333 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 18:01:18.154862 => 18:01:18.930701
[0m18:01:18.933501 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m18:01:18.935330 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m18:01:18.938790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f40bfbe-605f-42c3-bacc-5c08a1e5ebe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BD5F5930>]}
[0m18:01:18.942448 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 0.80s]
[0m18:01:18.945272 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m18:01:18.950257 [debug] [MainThread]: On master: COMMIT
[0m18:01:18.952959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:18.955494 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m18:01:18.957267 [debug] [MainThread]: Connection 'list_clickhouse_silver' was properly closed.
[0m18:01:18.958877 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m18:01:18.960101 [info ] [MainThread]: 
[0m18:01:18.964380 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m18:01:18.964380 [debug] [MainThread]: Command end result
[0m18:01:18.988563 [info ] [MainThread]: 
[0m18:01:18.991737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:18.994609 [info ] [MainThread]: 
[0m18:01:18.997536 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:01:18.999842 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:18.999842 after 3.49 seconds
[0m18:01:18.999842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BA77E860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BC423430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209BD4537C0>]}
[0m18:01:19.004730 [debug] [MainThread]: Flushing usage events
[0m18:23:12.463366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF27DA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF1F46470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF1F46140>]}


============================== 18:23:12.477509 | 798dde74-44b4-4d56-8b32-d19618d8f39c ==============================
[0m18:23:12.477509 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:23:12.489631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:23:12.491653 [info ] [MainThread]: dbt version: 1.5.1
[0m18:23:12.491653 [info ] [MainThread]: python version: 3.10.9
[0m18:23:12.491653 [info ] [MainThread]: python path: C:\Users\eho.mbengue\AppData\Local\anaconda3\python.exe
[0m18:23:12.491653 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m18:23:12.491653 [info ] [MainThread]: Using profiles.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\profiles.yml
[0m18:23:12.491653 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\dbt_project.yml
[0m18:23:12.509624 [info ] [MainThread]: Configuration:
[0m18:23:13.119776 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:23:13.209502 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:23:13.217047 [info ] [MainThread]: Required dependencies:
[0m18:23:13.220132 [debug] [MainThread]: Executing "git --help"
[0m18:23:13.343586 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:23:13.343586 [debug] [MainThread]: STDERR: "b''"
[0m18:23:13.343586 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:23:13.343586 [info ] [MainThread]: Connection:
[0m18:23:13.353151 [info ] [MainThread]:   host: localhost
[0m18:23:13.354693 [info ] [MainThread]:   port: 8080
[0m18:23:13.359242 [info ] [MainThread]:   user: Trino
[0m18:23:13.359242 [info ] [MainThread]:   database: lakehouse
[0m18:23:13.364825 [info ] [MainThread]:   schema: bronze
[0m18:23:13.367871 [info ] [MainThread]:   cert: None
[0m18:23:13.370431 [info ] [MainThread]:   prepared_statements_enabled: True
[0m18:23:13.371803 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m18:23:13.376843 [debug] [MainThread]: Using trino connection "debug"
[0m18:23:13.376843 [debug] [MainThread]: On debug: select 1 as id
[0m18:23:13.376843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:26.730994 [debug] [MainThread]: On debug: Close
[0m18:23:26.730994 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:23:26.730994 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:23:26.730994 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /v1/statement (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000020DF54098D0>: Failed to establish a new connection: [WinError 10061] Aucune connexion n’a pu être établie car l’ordinateur cible l’a expressément refusée'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:23:26.730994 [debug] [MainThread]: Command `dbt debug` failed at 18:23:26.730994 after 14.62 seconds
[0m18:23:26.730994 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:23:26.746679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF27DA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF5409300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF5409C90>]}
[0m18:23:26.748734 [debug] [MainThread]: Flushing usage events
[0m18:36:03.918139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C629A39B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6291A64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6291A6350>]}


============================== 18:36:03.933722 | ed174b6f-af53-4cb6-a6db-8f7a31ee79d3 ==============================
[0m18:36:03.933722 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:36:03.933722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:36:04.137512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed174b6f-af53-4cb6-a6db-8f7a31ee79d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6291A64D0>]}
[0m18:36:04.153167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed174b6f-af53-4cb6-a6db-8f7a31ee79d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C5A6470>]}
[0m18:36:04.184408 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m18:36:04.215656 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:36:04.215656 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m18:36:04.215656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed174b6f-af53-4cb6-a6db-8f7a31ee79d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C61AF20>]}
[0m18:36:05.952581 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:36:05.999312 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:36:05.999312 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:36:06.108727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed174b6f-af53-4cb6-a6db-8f7a31ee79d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C6180D0>]}
[0m18:36:06.108727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed174b6f-af53-4cb6-a6db-8f7a31ee79d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C618070>]}
[0m18:36:06.108727 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:36:06.108727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed174b6f-af53-4cb6-a6db-8f7a31ee79d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C7CB880>]}
[0m18:36:06.108727 [info ] [MainThread]: 
[0m18:36:06.108727 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:36:06.124366 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:36:06.140050 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:36:06.140050 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:36:06.140050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:09.149873 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m18:36:09.152439 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:36:09.159474 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:36:09.159474 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:36:09.168363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:09.447661 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:09.451694 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:36:09.459162 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:36:09.485639 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:36:09.489058 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:36:09.490845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:10.960599 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:36:10.960599 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:36:10.967648 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:36:10.973208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_gold)
[0m18:36:10.976961 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m18:36:10.989028 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:36:10.989028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:11.414981 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:11.420002 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m18:36:11.420002 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m18:36:11.425552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_silver)
[0m18:36:11.440891 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:36:11.440891 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:36:11.446914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:12.033084 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:36:12.033084 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:36:12.033084 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:36:12.033084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed174b6f-af53-4cb6-a6db-8f7a31ee79d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C618B20>]}
[0m18:36:12.045170 [debug] [MainThread]: On master: COMMIT
[0m18:36:12.045170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:36:12.045170 [info ] [MainThread]: 
[0m18:36:12.062837 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:36:12.062837 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:36:12.062837 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:36:12.062837 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:36:12.080425 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:36:12.080425 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:36:12.076903 => 18:36:12.080425
[0m18:36:12.080425 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:36:12.204847 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:36:12.219368 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:36:12.221885 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:36:12.221885 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:36:25.444016 [debug] [Thread-1 (]: SQL status: SUCCESS in 13.0 seconds
[0m18:36:25.481518 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:36:25.481518 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:36:25.948505 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:25.962260 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:36:25.962260 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:36:26.359430 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:26.385696 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:36:26.387623 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:36:27.014179 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:36:27.040044 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:36:12.094626 => 18:36:27.040044
[0m18:36:27.053058 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:36:27.053058 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:36:27.053058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed174b6f-af53-4cb6-a6db-8f7a31ee79d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C8B4250>]}
[0m18:36:27.053058 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 14.99s]
[0m18:36:27.061259 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:36:27.061259 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:36:27.061259 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:36:27.068782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:36:27.069071 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:36:27.069071 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:36:27.080598 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:36:27.069071 => 18:36:27.080598
[0m18:36:27.080598 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:36:27.098351 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:36:27.101858 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:36:27.101858 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:36:27.101858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:29.456061 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:36:29.461088 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:36:29.461088 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:36:29.729331 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:29.733375 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:36:29.733375 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:36:29.951390 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:29.962192 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:36:29.962192 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:36:30.256957 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:30.262907 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:36:27.080598 => 18:36:30.262907
[0m18:36:30.266423 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:36:30.266423 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:36:30.270749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed174b6f-af53-4cb6-a6db-8f7a31ee79d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C573BE0>]}
[0m18:36:30.270749 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 3.21s]
[0m18:36:30.275269 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:36:30.277805 [debug] [MainThread]: On master: COMMIT
[0m18:36:30.283686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:30.283686 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:36:30.283686 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m18:36:30.283686 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:36:30.283686 [info ] [MainThread]: 
[0m18:36:30.283686 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 24.17 seconds (24.17s).
[0m18:36:30.295703 [debug] [MainThread]: Command end result
[0m18:36:30.313040 [info ] [MainThread]: 
[0m18:36:30.314056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:30.314056 [info ] [MainThread]: 
[0m18:36:30.314056 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:36:30.314056 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:30.314056 after 26.60 seconds
[0m18:36:30.314056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C629A39B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C78B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C62C984D60>]}
[0m18:36:30.314056 [debug] [MainThread]: Flushing usage events
[0m18:36:43.038185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022449A59AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224491C6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224491C6380>]}


============================== 18:36:43.038185 | e71aa486-faa7-4afc-8b67-55e0c83af9ec ==============================
[0m18:36:43.038185 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:36:43.053802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:36:43.448907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e71aa486-faa7-4afc-8b67-55e0c83af9ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224491C6530>]}
[0m18:36:43.492405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e71aa486-faa7-4afc-8b67-55e0c83af9ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244C5F4850>]}
[0m18:36:43.540131 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m18:36:43.572027 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:36:43.572027 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m18:36:43.572027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e71aa486-faa7-4afc-8b67-55e0c83af9ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244C66AE00>]}
[0m18:36:46.097341 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:36:46.166393 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:36:46.166393 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:36:46.334645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e71aa486-faa7-4afc-8b67-55e0c83af9ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244C668100>]}
[0m18:36:46.350337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e71aa486-faa7-4afc-8b67-55e0c83af9ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244C668310>]}
[0m18:36:46.350337 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:36:46.366933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e71aa486-faa7-4afc-8b67-55e0c83af9ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244C818B80>]}
[0m18:36:46.366933 [info ] [MainThread]: 
[0m18:36:46.366933 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:36:46.366933 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m18:36:46.404943 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m18:36:46.404943 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m18:36:46.404943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:47.177808 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:36:47.181869 [debug] [ThreadPool]: On list_clickhouse: Close
[0m18:36:47.186441 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_bronze'
[0m18:36:47.207500 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m18:36:47.217623 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:36:47.217623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:47.615710 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:47.622856 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m18:36:47.622856 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m18:36:47.629910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m18:36:47.642191 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m18:36:47.642191 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:36:47.642191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:48.065042 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:48.069763 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m18:36:48.074173 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m18:36:48.078184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_silver)
[0m18:36:48.101974 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m18:36:48.104127 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:36:48.107032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:48.639817 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:36:48.645539 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m18:36:48.647598 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m18:36:48.648645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e71aa486-faa7-4afc-8b67-55e0c83af9ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244C613970>]}
[0m18:36:48.648645 [debug] [MainThread]: On master: COMMIT
[0m18:36:48.655662 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m18:36:48.655662 [info ] [MainThread]: 
[0m18:36:48.679348 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m18:36:48.681924 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m18:36:48.683484 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m18:36:48.688539 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m18:36:48.701957 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m18:36:48.708749 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 18:36:48.692097 => 18:36:48.701957
[0m18:36:48.708749 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m18:36:48.902345 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m18:36:48.916253 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:36:48.917308 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m18:36:48.917308 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:36:49.869272 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:36:49.887711 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:36:49.898256 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m18:36:50.015689 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:50.024264 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:36:50.034503 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m18:36:50.115146 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:50.134835 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:36:50.143856 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m18:36:50.261940 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:36:50.314132 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 18:36:48.712899 => 18:36:50.314132
[0m18:36:50.314132 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m18:36:50.314132 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m18:36:50.314132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e71aa486-faa7-4afc-8b67-55e0c83af9ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244C91EB60>]}
[0m18:36:50.325172 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 1.63s]
[0m18:36:50.325172 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m18:36:50.331739 [debug] [MainThread]: On master: COMMIT
[0m18:36:50.331739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:50.331739 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m18:36:50.331739 [debug] [MainThread]: Connection 'list_clickhouse_silver' was properly closed.
[0m18:36:50.341309 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m18:36:50.341309 [info ] [MainThread]: 
[0m18:36:50.341309 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m18:36:50.348328 [debug] [MainThread]: Command end result
[0m18:36:50.366458 [info ] [MainThread]: 
[0m18:36:50.366458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:50.366458 [info ] [MainThread]: 
[0m18:36:50.366458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:36:50.373524 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:50.373524 after 7.58 seconds
[0m18:36:50.373524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022449A59AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244C613970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244C820D00>]}
[0m18:36:50.373524 [debug] [MainThread]: Flushing usage events
[0m18:37:58.642946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E14E589BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E14DCF6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E14DCF6200>]}


============================== 18:37:58.642946 | fb172bb6-e3cb-472f-8696-d011b27475b2 ==============================
[0m18:37:58.642946 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:37:58.642946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:37:58.814918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb172bb6-e3cb-472f-8696-d011b27475b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E14DCF64D0>]}
[0m18:37:58.830482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb172bb6-e3cb-472f-8696-d011b27475b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1510DF460>]}
[0m18:37:58.846112 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m18:37:58.924210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:58.924210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:58.924210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb172bb6-e3cb-472f-8696-d011b27475b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E151305990>]}
[0m18:37:58.939896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb172bb6-e3cb-472f-8696-d011b27475b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1512D1FF0>]}
[0m18:37:58.939896 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:37:58.939896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb172bb6-e3cb-472f-8696-d011b27475b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1512D2230>]}
[0m18:37:58.939896 [info ] [MainThread]: 
[0m18:37:58.939896 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:37:58.939896 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m18:37:58.955606 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m18:37:58.955606 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m18:37:58.955606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:59.112478 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:37:59.114528 [debug] [ThreadPool]: On list_clickhouse: Close
[0m18:37:59.119780 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_gold'
[0m18:37:59.135649 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m18:37:59.135649 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:37:59.135649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:59.421439 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:37:59.429036 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m18:37:59.429036 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m18:37:59.436557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_silver)
[0m18:37:59.444986 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m18:37:59.444986 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:37:59.444986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:59.738515 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:37:59.738515 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m18:37:59.738515 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m18:37:59.743566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m18:37:59.759685 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m18:37:59.759685 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:37:59.759685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:00.058748 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:00.061079 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m18:38:00.061079 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m18:38:00.070403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb172bb6-e3cb-472f-8696-d011b27475b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E151374370>]}
[0m18:38:00.071427 [debug] [MainThread]: On master: COMMIT
[0m18:38:00.074456 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m18:38:00.076991 [info ] [MainThread]: 
[0m18:38:00.086268 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m18:38:00.090330 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m18:38:00.091629 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m18:38:00.095305 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m18:38:00.095305 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m18:38:00.106424 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 18:38:00.095305 => 18:38:00.106424
[0m18:38:00.106424 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m18:38:00.201570 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m18:38:00.201570 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:38:00.201570 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m18:38:00.201570 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:00.726876 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:38:00.747615 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:38:00.753330 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m18:38:00.904858 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:00.914511 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:38:00.915607 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m18:38:01.006991 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:01.013241 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:38:01.013241 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m18:38:01.089907 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:01.122151 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 18:38:00.111473 => 18:38:01.122151
[0m18:38:01.122151 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m18:38:01.122151 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m18:38:01.122151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb172bb6-e3cb-472f-8696-d011b27475b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1513AC4C0>]}
[0m18:38:01.122151 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 1.03s]
[0m18:38:01.122151 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m18:38:01.137804 [debug] [MainThread]: On master: COMMIT
[0m18:38:01.137804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:01.137804 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m18:38:01.137804 [debug] [MainThread]: Connection 'list_clickhouse_bronze' was properly closed.
[0m18:38:01.137804 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m18:38:01.137804 [info ] [MainThread]: 
[0m18:38:01.137804 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m18:38:01.146554 [debug] [MainThread]: Command end result
[0m18:38:01.153571 [info ] [MainThread]: 
[0m18:38:01.153571 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:01.153571 [info ] [MainThread]: 
[0m18:38:01.153571 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:38:01.153571 [debug] [MainThread]: Command `dbt run` succeeded at 18:38:01.153571 after 2.54 seconds
[0m18:38:01.153571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E14E589BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1510DF460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1513AC0D0>]}
[0m18:38:01.153571 [debug] [MainThread]: Flushing usage events
[0m18:38:23.297666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AD7DAA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AD7516470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AD7516140>]}


============================== 18:38:23.313316 | f98a2883-9d45-42ba-a85f-42dce452a83b ==============================
[0m18:38:23.313316 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:38:23.313316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:38:23.485167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f98a2883-9d45-42ba-a85f-42dce452a83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AD7516410>]}
[0m18:38:23.500791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f98a2883-9d45-42ba-a85f-42dce452a83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADA96F400>]}
[0m18:38:23.516417 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m18:38:23.516417 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:38:23.516417 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m18:38:23.516417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f98a2883-9d45-42ba-a85f-42dce452a83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADA9C9810>]}
[0m18:38:24.219954 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:38:24.282900 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:38:24.282900 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:38:24.377055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f98a2883-9d45-42ba-a85f-42dce452a83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADA9C80D0>]}
[0m18:38:24.392680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f98a2883-9d45-42ba-a85f-42dce452a83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADA9C82E0>]}
[0m18:38:24.392680 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:38:24.392680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f98a2883-9d45-42ba-a85f-42dce452a83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADAB792A0>]}
[0m18:38:24.392680 [info ] [MainThread]: 
[0m18:38:24.392680 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:38:24.392680 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:38:24.408304 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:38:24.408304 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:38:24.408304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:24.517162 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:24.519192 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:38:24.528806 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:38:24.528806 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:38:24.531064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:24.637131 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:24.637131 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:38:24.646708 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m18:38:24.664815 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:38:24.664815 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:38:24.664815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:24.916876 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:24.930994 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:38:24.931934 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:38:24.931934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_gold)
[0m18:38:24.946551 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m18:38:24.946551 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:38:24.946551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:25.221494 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:25.221494 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m18:38:25.221494 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m18:38:25.232588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m18:38:25.248260 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:38:25.248260 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:38:25.248260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:25.566492 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:25.571531 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:38:25.571531 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:38:25.575097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f98a2883-9d45-42ba-a85f-42dce452a83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADA9C8CA0>]}
[0m18:38:25.579778 [debug] [MainThread]: On master: COMMIT
[0m18:38:25.581684 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:25.581684 [info ] [MainThread]: 
[0m18:38:25.596766 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:38:25.596766 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:38:25.596766 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:38:25.596766 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:38:25.613322 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:38:25.627856 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:38:25.611783 => 18:38:25.613322
[0m18:38:25.630421 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:38:25.719783 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:38:25.723416 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:38:25.725431 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:38:25.725431 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:27.755766 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:38:27.770408 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:38:27.770408 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:38:28.008061 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:28.013677 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:38:28.014709 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:38:28.156815 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:28.166329 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:38:28.166329 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:38:28.387377 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:28.435027 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:38:25.630421 => 18:38:28.427001
[0m18:38:28.435027 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:38:28.435027 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:38:28.439050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f98a2883-9d45-42ba-a85f-42dce452a83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADACE1F60>]}
[0m18:38:28.442090 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.84s]
[0m18:38:28.442090 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:38:28.442090 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:38:28.451110 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:38:28.451110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:38:28.451110 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:38:28.458132 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:38:28.467152 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:38:28.451110 => 18:38:28.467152
[0m18:38:28.467152 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:38:28.477672 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:38:28.485065 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:38:28.485065 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:38:28.485065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:29.663118 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:38:29.676642 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:38:29.676642 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:38:29.864239 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:29.873805 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:38:29.873805 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:38:30.079148 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:30.090700 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:38:30.090700 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:38:30.357112 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:30.358137 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:38:28.467152 => 18:38:30.358137
[0m18:38:30.358137 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:38:30.358137 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:38:30.369250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f98a2883-9d45-42ba-a85f-42dce452a83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADABD3D90>]}
[0m18:38:30.373810 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.92s]
[0m18:38:30.377481 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:38:30.377481 [debug] [MainThread]: On master: COMMIT
[0m18:38:30.377481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:30.377481 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:38:30.377481 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m18:38:30.377481 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:38:30.389008 [info ] [MainThread]: 
[0m18:38:30.389008 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m18:38:30.389008 [debug] [MainThread]: Command end result
[0m18:38:30.405763 [info ] [MainThread]: 
[0m18:38:30.405763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:30.405763 [info ] [MainThread]: 
[0m18:38:30.420783 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:38:30.421809 [debug] [MainThread]: Command `dbt run` succeeded at 18:38:30.421809 after 7.14 seconds
[0m18:38:30.421809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AD7DAA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADAB37850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ADAB93FD0>]}
[0m18:38:30.421809 [debug] [MainThread]: Flushing usage events
[0m18:38:48.059668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001748F1B9B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001748E92A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001748E92A380>]}


============================== 18:38:48.059668 | 982bdb87-413d-4d67-9abc-d9c0e6b2c2f6 ==============================
[0m18:38:48.059668 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:38:48.075296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:38:48.278520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '982bdb87-413d-4d67-9abc-d9c0e6b2c2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001748E92A500>]}
[0m18:38:48.309675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '982bdb87-413d-4d67-9abc-d9c0e6b2c2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017491D66470>]}
[0m18:38:48.309675 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m18:38:48.392427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:48.392427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:48.403537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '982bdb87-413d-4d67-9abc-d9c0e6b2c2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017491FA9A80>]}
[0m18:38:48.403537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '982bdb87-413d-4d67-9abc-d9c0e6b2c2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017491F760E0>]}
[0m18:38:48.403537 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:38:48.403537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '982bdb87-413d-4d67-9abc-d9c0e6b2c2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017491F76320>]}
[0m18:38:48.403537 [info ] [MainThread]: 
[0m18:38:48.403537 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:38:48.419176 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:38:48.434894 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:38:48.434894 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:38:48.434894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:48.527525 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:48.529312 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:38:48.532130 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:38:48.532130 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:38:48.532130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:48.640371 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:48.647890 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:38:48.647890 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m18:38:48.664930 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:38:48.664930 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:38:48.664930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:48.846837 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:48.856872 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:38:48.856872 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:38:48.856872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m18:38:48.866470 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:38:48.866470 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:38:48.866470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:49.039867 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:49.039867 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:38:49.039867 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:38:49.039867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_gold)
[0m18:38:49.056408 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m18:38:49.056408 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:38:49.056408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:49.246543 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:49.246543 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m18:38:49.246543 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m18:38:49.246543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '982bdb87-413d-4d67-9abc-d9c0e6b2c2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017491FD2D70>]}
[0m18:38:49.258068 [debug] [MainThread]: On master: COMMIT
[0m18:38:49.258068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:49.258068 [info ] [MainThread]: 
[0m18:38:49.258068 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:38:49.258068 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:38:49.275237 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:38:49.275237 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:38:49.275237 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:38:49.289753 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:38:49.275237 => 18:38:49.275237
[0m18:38:49.289753 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:38:49.370485 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:38:49.387047 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:38:49.387047 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:38:49.387047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:51.098940 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:38:51.111512 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:38:51.111512 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:38:51.291037 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:51.297550 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:38:51.297550 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:38:51.435928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:51.447463 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:38:51.447463 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:38:51.697400 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:51.732860 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:38:49.294271 => 18:38:51.732860
[0m18:38:51.732860 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:38:51.732860 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:38:51.732860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '982bdb87-413d-4d67-9abc-d9c0e6b2c2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017492068EB0>]}
[0m18:38:51.732860 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.46s]
[0m18:38:51.732860 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:38:51.732860 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:38:51.732860 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:38:51.732860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:38:51.732860 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:38:51.750037 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:38:51.750037 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:38:51.732860 => 18:38:51.750037
[0m18:38:51.750037 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:38:51.750037 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:38:51.764551 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:38:51.764551 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:38:51.764551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:52.746727 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:38:52.757747 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:38:52.757747 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:38:52.922943 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:52.927341 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:38:52.927341 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:38:53.068173 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:53.081189 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:38:53.081189 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:38:53.285641 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:53.285641 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:38:51.750037 => 18:38:53.285641
[0m18:38:53.285641 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:38:53.285641 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:38:53.301279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '982bdb87-413d-4d67-9abc-d9c0e6b2c2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017492025ED0>]}
[0m18:38:53.301279 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.57s]
[0m18:38:53.301279 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:38:53.301279 [debug] [MainThread]: On master: COMMIT
[0m18:38:53.301279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:53.301279 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:38:53.301279 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m18:38:53.317001 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:38:53.317001 [info ] [MainThread]: 
[0m18:38:53.317001 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m18:38:53.317001 [debug] [MainThread]: Command end result
[0m18:38:53.348256 [info ] [MainThread]: 
[0m18:38:53.348256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:53.348256 [info ] [MainThread]: 
[0m18:38:53.348256 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:38:53.363788 [debug] [MainThread]: Command `dbt run` succeeded at 18:38:53.363788 after 5.32 seconds
[0m18:38:53.363788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001748F1B9B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017491D66470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174920E3070>]}
[0m18:38:53.363788 [debug] [MainThread]: Flushing usage events
[0m18:38:57.494867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5F6C9B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5EE264D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5EE26320>]}


============================== 18:38:57.507379 | c734691a-f97c-4ad4-acba-1ad5a85042dd ==============================
[0m18:38:57.507379 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:38:57.507379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:38:57.710522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c734691a-f97c-4ad4-acba-1ad5a85042dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5EE264D0>]}
[0m18:38:57.741769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c734691a-f97c-4ad4-acba-1ad5a85042dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62244850>]}
[0m18:38:57.757397 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m18:38:57.757397 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:38:57.757397 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m18:38:57.757397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c734691a-f97c-4ad4-acba-1ad5a85042dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F622BAD10>]}
[0m18:38:58.539373 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:38:58.586254 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:38:58.601789 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:38:58.695534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c734691a-f97c-4ad4-acba-1ad5a85042dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F622B8100>]}
[0m18:38:58.711163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c734691a-f97c-4ad4-acba-1ad5a85042dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F622B83D0>]}
[0m18:38:58.711163 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:38:58.711163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c734691a-f97c-4ad4-acba-1ad5a85042dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6246B7F0>]}
[0m18:38:58.711163 [info ] [MainThread]: 
[0m18:38:58.711163 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:38:58.711163 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m18:38:58.726876 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m18:38:58.726876 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m18:38:58.726876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:58.839567 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:58.839567 [debug] [ThreadPool]: On list_clickhouse: Close
[0m18:38:58.839567 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_gold'
[0m18:38:58.859549 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m18:38:58.860880 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:38:58.862200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:59.022474 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:59.024002 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m18:38:59.026538 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m18:38:59.026538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_bronze)
[0m18:38:59.032561 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m18:38:59.032561 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:38:59.032561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:59.219179 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:59.221205 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m18:38:59.221205 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m18:38:59.221205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_silver)
[0m18:38:59.232762 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m18:38:59.232762 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:38:59.232762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:59.429421 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:59.429421 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m18:38:59.434455 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m18:38:59.436983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c734691a-f97c-4ad4-acba-1ad5a85042dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62378640>]}
[0m18:38:59.436983 [debug] [MainThread]: On master: COMMIT
[0m18:38:59.436983 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m18:38:59.436983 [info ] [MainThread]: 
[0m18:38:59.452634 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m18:38:59.453652 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m18:38:59.453652 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m18:38:59.453652 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m18:38:59.453652 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m18:38:59.453652 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 18:38:59.453652 => 18:38:59.453652
[0m18:38:59.453652 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m18:38:59.531908 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m18:38:59.537173 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:38:59.540188 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m18:38:59.540188 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:59.896438 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:38:59.908053 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:38:59.912574 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m18:39:00.043559 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:39:00.043559 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:39:00.054077 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m18:39:00.113495 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:39:00.119515 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:39:00.119515 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m18:39:00.167155 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:39:00.198849 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 18:38:59.453652 => 18:39:00.198849
[0m18:39:00.198849 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m18:39:00.214490 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m18:39:00.214490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c734691a-f97c-4ad4-acba-1ad5a85042dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62255CF0>]}
[0m18:39:00.214490 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 0.76s]
[0m18:39:00.214490 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m18:39:00.214490 [debug] [MainThread]: On master: COMMIT
[0m18:39:00.214490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:00.214490 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m18:39:00.214490 [debug] [MainThread]: Connection 'list_clickhouse_silver' was properly closed.
[0m18:39:00.214490 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m18:39:00.214490 [info ] [MainThread]: 
[0m18:39:00.214490 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m18:39:00.214490 [debug] [MainThread]: Command end result
[0m18:39:00.230115 [info ] [MainThread]: 
[0m18:39:00.230115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:39:00.230115 [info ] [MainThread]: 
[0m18:39:00.230115 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:39:00.230115 [debug] [MainThread]: Command `dbt run` succeeded at 18:39:00.230115 after 2.76 seconds
[0m18:39:00.230115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5F6C9B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62469150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F624277C0>]}
[0m18:39:00.230115 [debug] [MainThread]: Flushing usage events
[0m18:41:24.837773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD683C9B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD67B3A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD67B3A320>]}


============================== 18:41:24.837773 | a752dbdf-2e4b-4b24-b29e-a63b2a29c972 ==============================
[0m18:41:24.837773 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:41:24.853383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:41:24.994063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a752dbdf-2e4b-4b24-b29e-a63b2a29c972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD67B3A500>]}
[0m18:41:24.994063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a752dbdf-2e4b-4b24-b29e-a63b2a29c972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6AF25C90>]}
[0m18:41:25.009625 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m18:41:25.025251 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:41:25.025251 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m18:41:25.025251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a752dbdf-2e4b-4b24-b29e-a63b2a29c972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6AF9B160>]}
[0m18:41:25.796595 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:41:25.853256 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:41:25.856507 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:41:25.966787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a752dbdf-2e4b-4b24-b29e-a63b2a29c972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6AF98100>]}
[0m18:41:25.977835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a752dbdf-2e4b-4b24-b29e-a63b2a29c972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6AF983D0>]}
[0m18:41:25.977835 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:41:25.977835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a752dbdf-2e4b-4b24-b29e-a63b2a29c972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B14B7F0>]}
[0m18:41:25.983566 [info ] [MainThread]: 
[0m18:41:25.983566 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:41:25.983566 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:41:26.001607 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:41:26.001607 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:41:26.001607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:26.124010 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:26.127074 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:41:26.132487 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:41:26.132487 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:41:26.132487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:26.246357 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:26.252031 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:41:26.255848 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m18:41:26.270439 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:41:26.272342 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:41:26.272342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:26.478674 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:26.482205 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:41:26.484748 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:41:26.484748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m18:41:26.491711 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:41:26.502748 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:41:26.502748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:26.730600 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:26.733844 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:41:26.735165 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:41:26.738241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_gold)
[0m18:41:26.751350 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m18:41:26.752679 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:41:26.753913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:27.013056 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:27.018148 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m18:41:27.018148 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m18:41:27.022988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a752dbdf-2e4b-4b24-b29e-a63b2a29c972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6AF34C70>]}
[0m18:41:27.022988 [debug] [MainThread]: On master: COMMIT
[0m18:41:27.022988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:27.022988 [info ] [MainThread]: 
[0m18:41:27.043163 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:41:27.044184 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:41:27.048773 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:41:27.051232 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:41:27.068394 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:41:27.069991 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:41:27.051232 => 18:41:27.069991
[0m18:41:27.075763 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:41:27.183280 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:41:27.186326 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:41:27.191149 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:41:27.191149 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:29.258882 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:41:29.288344 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:41:29.288344 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:41:29.528553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:29.544654 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:41:29.544654 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:41:29.786759 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:29.802196 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:41:29.804910 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:41:30.137994 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:30.200398 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:41:27.077963 => 18:41:30.200398
[0m18:41:30.200398 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:41:30.204512 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:41:30.208551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a752dbdf-2e4b-4b24-b29e-a63b2a29c972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6AF36BF0>]}
[0m18:41:30.208551 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 3.16s]
[0m18:41:30.215123 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:41:30.217755 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:41:30.217755 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:41:30.224468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:41:30.224468 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:41:30.236580 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:41:30.239207 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:41:30.224468 => 18:41:30.239207
[0m18:41:30.239207 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:41:30.255468 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:41:30.270717 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:41:30.273277 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:41:30.273277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:31.487105 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:41:31.499235 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:41:31.501276 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:41:31.730500 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:31.739535 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:41:31.739535 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:41:31.977954 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:31.992231 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:41:31.995293 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:41:32.444997 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:32.453433 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:41:30.239207 => 18:41:32.452890
[0m18:41:32.454005 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:41:32.458128 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:41:32.458128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a752dbdf-2e4b-4b24-b29e-a63b2a29c972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B0A1CF0>]}
[0m18:41:32.463593 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.24s]
[0m18:41:32.468114 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:41:32.468114 [debug] [MainThread]: On master: COMMIT
[0m18:41:32.477758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:32.479804 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:41:32.479916 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m18:41:32.479916 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:41:32.479916 [info ] [MainThread]: 
[0m18:41:32.486448 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.50 seconds (6.50s).
[0m18:41:32.487753 [debug] [MainThread]: Command end result
[0m18:41:32.515420 [info ] [MainThread]: 
[0m18:41:32.517249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:32.518006 [info ] [MainThread]: 
[0m18:41:32.518006 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:41:32.518006 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:32.518006 after 7.70 seconds
[0m18:41:32.518006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD683C9B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6A5DE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B1077C0>]}
[0m18:41:32.527565 [debug] [MainThread]: Flushing usage events
[0m18:41:38.037559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3459B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C2BBA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C2BBA380>]}


============================== 18:41:38.037559 | 714ebd28-f24b-4d1a-b7ad-9e16ee5f05c0 ==============================
[0m18:41:38.037559 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:41:38.037559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:41:38.290215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '714ebd28-f24b-4d1a-b7ad-9e16ee5f05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C2BBA500>]}
[0m18:41:38.305235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '714ebd28-f24b-4d1a-b7ad-9e16ee5f05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C5F463B0>]}
[0m18:41:38.320884 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m18:41:38.352159 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:41:38.352159 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m18:41:38.352159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '714ebd28-f24b-4d1a-b7ad-9e16ee5f05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C5FBADA0>]}
[0m18:41:39.103379 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:41:39.150255 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:41:39.150255 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:41:39.244007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '714ebd28-f24b-4d1a-b7ad-9e16ee5f05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C5FB8100>]}
[0m18:41:39.259589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '714ebd28-f24b-4d1a-b7ad-9e16ee5f05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C5FB83D0>]}
[0m18:41:39.259589 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:41:39.259589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714ebd28-f24b-4d1a-b7ad-9e16ee5f05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C616B7F0>]}
[0m18:41:39.259589 [info ] [MainThread]: 
[0m18:41:39.259589 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:41:39.259589 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m18:41:39.275215 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m18:41:39.275215 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m18:41:39.275215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:39.395062 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:39.398124 [debug] [ThreadPool]: On list_clickhouse: Close
[0m18:41:39.402034 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_bronze'
[0m18:41:39.410510 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m18:41:39.410510 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:41:39.417109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:39.592617 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:39.596138 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m18:41:39.596138 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m18:41:39.596138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m18:41:39.608525 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m18:41:39.608525 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:41:39.614045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:39.799105 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:39.803241 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m18:41:39.803241 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m18:41:39.814295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_silver)
[0m18:41:39.823183 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m18:41:39.823183 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:41:39.823183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:40.029388 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:40.031954 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m18:41:40.035470 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m18:41:40.037946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714ebd28-f24b-4d1a-b7ad-9e16ee5f05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C6078640>]}
[0m18:41:40.037946 [debug] [MainThread]: On master: COMMIT
[0m18:41:40.037946 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m18:41:40.037946 [info ] [MainThread]: 
[0m18:41:40.055924 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m18:41:40.055924 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m18:41:40.055924 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m18:41:40.067533 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m18:41:40.074698 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m18:41:40.083220 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 18:41:40.067533 => 18:41:40.074698
[0m18:41:40.085242 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m18:41:40.146624 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m18:41:40.146624 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:41:40.146624 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m18:41:40.146624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:40.496267 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:40.515277 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:41:40.515277 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m18:41:40.585587 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:40.590304 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:41:40.590304 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m18:41:40.685964 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:40.700619 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:41:40.700619 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m18:41:40.817099 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:41:40.844264 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 18:41:40.085242 => 18:41:40.844264
[0m18:41:40.844264 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m18:41:40.844264 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m18:41:40.844264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '714ebd28-f24b-4d1a-b7ad-9e16ee5f05c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C6260550>]}
[0m18:41:40.844264 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 0.79s]
[0m18:41:40.844264 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m18:41:40.844264 [debug] [MainThread]: On master: COMMIT
[0m18:41:40.859681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:40.859681 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m18:41:40.861092 [debug] [MainThread]: Connection 'list_clickhouse_silver' was properly closed.
[0m18:41:40.861092 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m18:41:40.861092 [info ] [MainThread]: 
[0m18:41:40.861092 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m18:41:40.861092 [debug] [MainThread]: Command end result
[0m18:41:40.861092 [info ] [MainThread]: 
[0m18:41:40.861092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:40.875847 [info ] [MainThread]: 
[0m18:41:40.876672 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:41:40.876672 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:40.876672 after 2.87 seconds
[0m18:41:40.876672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3459B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C6078640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C61C3970>]}
[0m18:41:40.876672 [debug] [MainThread]: Flushing usage events
[0m18:52:07.507391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021604649BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021603DB6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021603DB62F0>]}


============================== 18:52:07.519480 | c3280bed-cad5-4394-86ed-5487a897a416 ==============================
[0m18:52:07.519480 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:52:07.519990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:52:07.748282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3280bed-cad5-4394-86ed-5487a897a416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021603DB6440>]}
[0m18:52:07.763903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3280bed-cad5-4394-86ed-5487a897a416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216071AE3B0>]}
[0m18:52:07.795196 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m18:52:07.826448 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:52:07.826448 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m18:52:07.826448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3280bed-cad5-4394-86ed-5487a897a416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002160720ADD0>]}
[0m18:52:09.718284 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:52:09.753179 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:52:09.768758 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:52:09.864618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3280bed-cad5-4394-86ed-5487a897a416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021607208100>]}
[0m18:52:09.878278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3280bed-cad5-4394-86ed-5487a897a416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021607208220>]}
[0m18:52:09.878278 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:52:09.878278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3280bed-cad5-4394-86ed-5487a897a416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216073B9D80>]}
[0m18:52:09.878278 [info ] [MainThread]: 
[0m18:52:09.878278 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:52:09.878278 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m18:52:09.893976 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:52:09.893976 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:52:09.893976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:10.019308 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:10.019308 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:52:10.019308 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m18:52:10.019308 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m18:52:10.019308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:10.105748 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:10.105748 [debug] [ThreadPool]: On list_lakehouse: Close
[0m18:52:10.105748 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m18:52:10.123578 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m18:52:10.123578 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:52:10.123578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:10.308305 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:10.308305 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m18:52:10.308305 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m18:52:10.314857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m18:52:10.327065 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m18:52:10.330171 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:52:10.330171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:10.567865 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:10.575381 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m18:52:10.579489 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m18:52:10.584031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m18:52:10.596262 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m18:52:10.596262 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:52:10.596262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:10.845910 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:10.845910 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m18:52:10.845910 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m18:52:10.851037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3280bed-cad5-4394-86ed-5487a897a416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021607160C40>]}
[0m18:52:10.851037 [debug] [MainThread]: On master: COMMIT
[0m18:52:10.851037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:10.851037 [info ] [MainThread]: 
[0m18:52:10.870188 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m18:52:10.870188 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m18:52:10.880307 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m18:52:10.880307 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m18:52:10.894385 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m18:52:10.895517 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 18:52:10.880307 => 18:52:10.895517
[0m18:52:10.895517 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m18:52:11.024835 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m18:52:11.030388 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:52:11.030388 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:52:11.030388 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:12.757580 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:52:12.773670 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:52:12.782232 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:52:12.935086 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:12.949223 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:52:12.953662 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m18:52:13.126319 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:13.144967 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m18:52:13.144967 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m18:52:13.445665 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:13.487539 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 18:52:10.895517 => 18:52:13.487539
[0m18:52:13.487539 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m18:52:13.487539 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m18:52:13.503182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3280bed-cad5-4394-86ed-5487a897a416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021607161C60>]}
[0m18:52:13.503182 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.62s]
[0m18:52:13.503182 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m18:52:13.503182 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m18:52:13.503182 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m18:52:13.503182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m18:52:13.520867 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m18:52:13.520867 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m18:52:13.534887 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 18:52:13.520867 => 18:52:13.534887
[0m18:52:13.534887 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m18:52:13.550540 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m18:52:13.566228 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:52:13.566228 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m18:52:13.566228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:14.759250 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:52:14.774384 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:52:14.776387 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m18:52:15.010795 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:15.024968 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:52:15.026971 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m18:52:15.240828 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:15.252428 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m18:52:15.254492 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m18:52:15.503014 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:15.511030 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 18:52:13.534887 => 18:52:15.510028
[0m18:52:15.512544 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m18:52:15.514559 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m18:52:15.517147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3280bed-cad5-4394-86ed-5487a897a416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216005472E0>]}
[0m18:52:15.519685 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.01s]
[0m18:52:15.522704 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m18:52:15.527702 [debug] [MainThread]: On master: COMMIT
[0m18:52:15.530412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:15.531430 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m18:52:15.533473 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m18:52:15.534426 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m18:52:15.536553 [info ] [MainThread]: 
[0m18:52:15.540430 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m18:52:15.543962 [debug] [MainThread]: Command end result
[0m18:52:15.565662 [info ] [MainThread]: 
[0m18:52:15.568663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:15.570667 [info ] [MainThread]: 
[0m18:52:15.572669 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:52:15.576675 [debug] [MainThread]: Command `dbt run` succeeded at 18:52:15.575664 after 8.30 seconds
[0m18:52:15.578197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021604649BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216073777F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002160683E890>]}
[0m18:52:15.583242 [debug] [MainThread]: Flushing usage events
[0m18:52:21.402581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6820D9BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B681866470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B681866320>]}


============================== 18:52:21.402581 | 210223ce-98eb-444f-a3fe-117c45ca7b48 ==============================
[0m18:52:21.402581 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:52:21.402581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:52:21.567030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '210223ce-98eb-444f-a3fe-117c45ca7b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B681866470>]}
[0m18:52:21.582725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '210223ce-98eb-444f-a3fe-117c45ca7b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B684C623B0>]}
[0m18:52:21.598350 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m18:52:21.629482 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:52:21.629482 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m18:52:21.629482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '210223ce-98eb-444f-a3fe-117c45ca7b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B684CBAE00>]}
[0m18:52:22.439148 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m18:52:22.486019 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m18:52:22.486019 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m18:52:22.579772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '210223ce-98eb-444f-a3fe-117c45ca7b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B684CB80D0>]}
[0m18:52:22.579772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '210223ce-98eb-444f-a3fe-117c45ca7b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B684CB8070>]}
[0m18:52:22.579772 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:52:22.579772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '210223ce-98eb-444f-a3fe-117c45ca7b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B684E6B790>]}
[0m18:52:22.579772 [info ] [MainThread]: 
[0m18:52:22.595392 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m18:52:22.595991 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m18:52:22.611615 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m18:52:22.612150 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m18:52:22.612150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:22.702524 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:22.702524 [debug] [ThreadPool]: On list_clickhouse: Close
[0m18:52:22.706537 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_silver'
[0m18:52:22.722341 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m18:52:22.722341 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m18:52:22.722341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:22.865227 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:22.869744 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m18:52:22.869744 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m18:52:22.873622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_gold)
[0m18:52:22.881141 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m18:52:22.885219 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m18:52:22.885219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:23.088305 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:23.088305 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m18:52:23.088305 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m18:52:23.088305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_gold, now list_clickhouse_bronze)
[0m18:52:23.110733 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m18:52:23.112411 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m18:52:23.113659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:23.296765 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:23.296765 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m18:52:23.296765 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m18:52:23.296765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '210223ce-98eb-444f-a3fe-117c45ca7b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B684C04520>]}
[0m18:52:23.307388 [debug] [MainThread]: On master: COMMIT
[0m18:52:23.307388 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m18:52:23.312096 [info ] [MainThread]: 
[0m18:52:23.325212 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m18:52:23.327145 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m18:52:23.328950 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m18:52:23.328950 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m18:52:23.328950 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m18:52:23.328950 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 18:52:23.328950 => 18:52:23.328950
[0m18:52:23.340017 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m18:52:23.410797 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m18:52:23.415926 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:52:23.417189 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m18:52:23.417797 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:23.741397 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:23.753501 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:52:23.753501 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m18:52:23.832976 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:23.841496 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:52:23.841496 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m18:52:23.900606 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:23.912676 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m18:52:23.912676 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m18:52:23.960496 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:52:23.992299 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 18:52:23.340017 => 18:52:23.992299
[0m18:52:23.992299 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m18:52:23.992299 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m18:52:23.992299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210223ce-98eb-444f-a3fe-117c45ca7b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B684E839A0>]}
[0m18:52:23.992299 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 0.66s]
[0m18:52:23.992299 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m18:52:23.992299 [debug] [MainThread]: On master: COMMIT
[0m18:52:23.992299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:23.992299 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m18:52:24.007936 [debug] [MainThread]: Connection 'list_clickhouse_bronze' was properly closed.
[0m18:52:24.007936 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m18:52:24.007936 [info ] [MainThread]: 
[0m18:52:24.007936 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m18:52:24.007936 [debug] [MainThread]: Command end result
[0m18:52:24.007936 [info ] [MainThread]: 
[0m18:52:24.007936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:24.023546 [info ] [MainThread]: 
[0m18:52:24.023546 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:52:24.023546 [debug] [MainThread]: Command `dbt run` succeeded at 18:52:24.023546 after 2.64 seconds
[0m18:52:24.023546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6820D9BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B684E839A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B684E27880>]}
[0m18:52:24.023546 [debug] [MainThread]: Flushing usage events
[0m22:33:57.932644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527E6DA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527DE465C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527DE46290>]}


============================== 22:33:57.950778 | 591e4aac-9b0a-4c70-a3fd-66601cc5c3e0 ==============================
[0m22:33:57.950778 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:33:57.954913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:33:58.310273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '591e4aac-9b0a-4c70-a3fd-66601cc5c3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527DE46560>]}
[0m22:33:58.334573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '591e4aac-9b0a-4c70-a3fd-66601cc5c3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520131F4F0>]}
[0m22:33:58.391535 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m22:33:58.428721 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:33:58.428721 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m22:33:58.432690 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:33:58.440160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '591e4aac-9b0a-4c70-a3fd-66601cc5c3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520137AE90>]}
[0m22:34:00.956511 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m22:34:01.013349 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m22:34:01.022696 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m22:34:01.185870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '591e4aac-9b0a-4c70-a3fd-66601cc5c3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152013780A0>]}
[0m22:34:01.198612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '591e4aac-9b0a-4c70-a3fd-66601cc5c3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015201378040>]}
[0m22:34:01.199693 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m22:34:01.201847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '591e4aac-9b0a-4c70-a3fd-66601cc5c3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520152B7F0>]}
[0m22:34:01.203449 [info ] [MainThread]: 
[0m22:34:01.207161 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m22:34:01.209484 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m22:34:01.236386 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m22:34:01.236386 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m22:34:01.239401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:01.417427 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:34:01.419477 [debug] [ThreadPool]: On list_lakehouse: Close
[0m22:34:01.427525 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m22:34:01.429066 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m22:34:01.429066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:01.539488 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:34:01.541584 [debug] [ThreadPool]: On list_lakehouse: Close
[0m22:34:01.546861 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m22:34:01.570451 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m22:34:01.570451 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m22:34:01.570451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:01.771833 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:34:01.773353 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m22:34:01.773353 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m22:34:01.778395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m22:34:01.789349 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m22:34:01.789349 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m22:34:01.791562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:01.979636 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:34:01.979636 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m22:34:01.984658 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m22:34:01.988002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_gold)
[0m22:34:01.995945 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m22:34:02.000880 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m22:34:02.000880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:02.185323 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:34:02.189023 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m22:34:02.190095 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m22:34:02.193194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '591e4aac-9b0a-4c70-a3fd-66601cc5c3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520137A770>]}
[0m22:34:02.195511 [debug] [MainThread]: On master: COMMIT
[0m22:34:02.196534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:34:02.199028 [info ] [MainThread]: 
[0m22:34:02.258506 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m22:34:02.258506 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m22:34:02.267125 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m22:34:02.268349 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m22:34:02.276436 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m22:34:02.283047 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 22:34:02.270531 => 22:34:02.282456
[0m22:34:02.283047 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m22:34:02.347663 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m22:34:02.347663 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists "lakehouse"."bronze"."weatheronepoint__dbt_tmp"
[0m22:34:02.347663 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:34:02.677508 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:34:02.719067 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m22:34:02.724998 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m22:34:02.728042 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m22:34:06.547780 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m22:34:06.579352 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m22:34:06.579352 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m22:34:06.716329 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230615_203406_00091_qv3zc
[0m22:34:06.718761 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weatheronepoint", query_id=20230615_203406_00091_qv3zc)
[0m22:34:06.720389 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 22:34:02.285859 => 22:34:06.720389
[0m22:34:06.723517 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m22:34:06.726387 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m22:34:06.991667 [debug] [Thread-1 (]: Database Error in model weatheronepoint (models\bronze\weatheronepoint.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weatheronepoint", query_id=20230615_203406_00091_qv3zc)
  compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m22:34:06.991667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '591e4aac-9b0a-4c70-a3fd-66601cc5c3e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152016687C0>]}
[0m22:34:06.991667 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model bronze.weatheronepoint ................... [[31mERROR[0m in 4.73s]
[0m22:34:06.999196 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m22:34:07.000732 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m22:34:07.002769 [info ] [Thread-1 (]: 2 of 2 SKIP relation silver.weathersil ......................................... [[33mSKIP[0m]
[0m22:34:07.007643 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m22:34:07.018803 [debug] [MainThread]: On master: COMMIT
[0m22:34:07.019477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:07.021989 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m22:34:07.021989 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m22:34:07.024041 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m22:34:07.024041 [info ] [MainThread]: 
[0m22:34:07.024041 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m22:34:07.032886 [debug] [MainThread]: Command end result
[0m22:34:07.051063 [info ] [MainThread]: 
[0m22:34:07.054948 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:34:07.054948 [info ] [MainThread]: 
[0m22:34:07.059282 [error] [MainThread]: [33mDatabase Error in model weatheronepoint (models\bronze\weatheronepoint.sql)[0m
[0m22:34:07.059282 [error] [MainThread]:   TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weatheronepoint", query_id=20230615_203406_00091_qv3zc)
[0m22:34:07.064328 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m22:34:07.070928 [info ] [MainThread]: 
[0m22:34:07.073611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m22:34:07.073611 [debug] [MainThread]: Command `dbt run` failed at 22:34:07.073611 after 9.39 seconds
[0m22:34:07.073611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527E6DA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015201420130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152015839A0>]}
[0m22:34:07.073611 [debug] [MainThread]: Flushing usage events
[0m22:38:32.849557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC866A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC7DDA440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC7DDA200>]}


============================== 22:38:32.856269 | 4f1a3047-cc70-45fe-a70d-be4e2aac440c ==============================
[0m22:38:32.856269 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:38:32.856269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:38:33.203456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f1a3047-cc70-45fe-a70d-be4e2aac440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC7DDA530>]}
[0m22:38:33.234720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f1a3047-cc70-45fe-a70d-be4e2aac440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCB193460>]}
[0m22:38:33.267283 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m22:38:33.409701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:38:33.409701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:38:33.424678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f1a3047-cc70-45fe-a70d-be4e2aac440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCB3B5840>]}
[0m22:38:33.440557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f1a3047-cc70-45fe-a70d-be4e2aac440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCB2E1EA0>]}
[0m22:38:33.440557 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m22:38:33.448086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f1a3047-cc70-45fe-a70d-be4e2aac440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCB2E20E0>]}
[0m22:38:33.454416 [info ] [MainThread]: 
[0m22:38:33.458111 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m22:38:33.462379 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m22:38:33.488133 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m22:38:33.489397 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m22:38:33.489397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:33.643394 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:33.647572 [debug] [ThreadPool]: On list_lakehouse: Close
[0m22:38:33.657536 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m22:38:33.657536 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m22:38:33.662582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:33.774012 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:33.777562 [debug] [ThreadPool]: On list_lakehouse: Close
[0m22:38:33.792294 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m22:38:33.817644 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m22:38:33.819707 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m22:38:33.820761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:34.055721 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:34.067810 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m22:38:34.069328 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m22:38:34.072904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m22:38:34.091578 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m22:38:34.091578 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m22:38:34.091578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:34.313438 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:34.313438 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m22:38:34.313438 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m22:38:34.322844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_gold)
[0m22:38:34.332429 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m22:38:34.332429 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m22:38:34.332429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:34.541367 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:34.543402 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m22:38:34.543402 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m22:38:34.546414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f1a3047-cc70-45fe-a70d-be4e2aac440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCB3E2F20>]}
[0m22:38:34.549135 [debug] [MainThread]: On master: COMMIT
[0m22:38:34.550349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:34.550349 [info ] [MainThread]: 
[0m22:38:34.629535 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m22:38:34.630560 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m22:38:34.633081 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m22:38:34.633081 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m22:38:34.638050 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m22:38:34.638050 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 22:38:34.633081 => 22:38:34.638050
[0m22:38:34.638050 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m22:38:34.695902 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m22:38:34.695902 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists "lakehouse"."bronze"."weatheronepoint__dbt_tmp"
[0m22:38:34.695902 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:34.887142 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:34.913811 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m22:38:34.917836 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m22:38:34.922860 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m22:38:36.674176 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:38:36.687828 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m22:38:36.689047 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m22:38:36.856282 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:36.862417 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m22:38:36.866325 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m22:38:36.893745 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:36.939634 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 22:38:34.638050 => 22:38:36.939634
[0m22:38:36.939634 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m22:38:36.944722 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m22:38:36.950530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1a3047-cc70-45fe-a70d-be4e2aac440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCB4BDB40>]}
[0m22:38:36.953795 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.32s]
[0m22:38:36.959495 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m22:38:36.962249 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m22:38:36.964890 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m22:38:36.964890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m22:38:36.964890 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m22:38:36.975551 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m22:38:36.979076 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 22:38:36.970838 => 22:38:36.979076
[0m22:38:36.983574 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m22:38:36.995158 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m22:38:37.005790 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m22:38:37.007315 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
  json_extract_scalar(_airbyte_data, '$.dt') AS dt
  FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m22:38:37.008931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:38.437500 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:38:38.451111 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m22:38:38.454457 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m22:38:38.860512 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:38.864217 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m22:38:38.864217 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m22:38:38.917082 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:38:38.931159 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 22:38:36.986333 => 22:38:38.930146
[0m22:38:38.933700 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m22:38:38.937383 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m22:38:38.942350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f1a3047-cc70-45fe-a70d-be4e2aac440c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCB4EB8B0>]}
[0m22:38:38.942350 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.98s]
[0m22:38:38.947147 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m22:38:38.955197 [debug] [MainThread]: On master: COMMIT
[0m22:38:38.956127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:38.957580 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m22:38:38.957580 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m22:38:38.957580 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m22:38:38.957580 [info ] [MainThread]: 
[0m22:38:38.962502 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m22:38:38.964673 [debug] [MainThread]: Command end result
[0m22:38:38.979351 [info ] [MainThread]: 
[0m22:38:38.981257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:38:38.982524 [info ] [MainThread]: 
[0m22:38:38.984537 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:38:38.993083 [debug] [MainThread]: Command `dbt run` succeeded at 22:38:38.987565 after 6.19 seconds
[0m22:38:38.995928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC866A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCB193460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCB2E1A50>]}
[0m22:38:38.995928 [debug] [MainThread]: Flushing usage events
[0m22:38:58.726049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD609CA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD601365F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD601362C0>]}


============================== 22:38:58.732094 | bc1e2d21-25ff-47c4-a216-fe558996e697 ==============================
[0m22:38:58.732094 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:38:58.732094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:38:59.001927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc1e2d21-25ff-47c4-a216-fe558996e697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD60136590>]}
[0m22:38:59.022082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc1e2d21-25ff-47c4-a216-fe558996e697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD634E3520>]}
[0m22:38:59.034257 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m22:38:59.050574 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:38:59.054463 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m22:38:59.054463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc1e2d21-25ff-47c4-a216-fe558996e697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD6356AA70>]}
[0m22:39:00.001219 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m22:39:00.068935 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m22:39:00.078232 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m22:39:00.222235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc1e2d21-25ff-47c4-a216-fe558996e697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD635680D0>]}
[0m22:39:00.232997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc1e2d21-25ff-47c4-a216-fe558996e697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD635682E0>]}
[0m22:39:00.232997 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m22:39:00.237009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc1e2d21-25ff-47c4-a216-fe558996e697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD63718490>]}
[0m22:39:00.238279 [info ] [MainThread]: 
[0m22:39:00.241999 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m22:39:00.251022 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m22:39:00.275026 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m22:39:00.275026 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m22:39:00.282941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:00.409260 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:00.410801 [debug] [ThreadPool]: On list_clickhouse: Close
[0m22:39:00.415372 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_silver'
[0m22:39:00.422423 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m22:39:00.422423 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m22:39:00.430448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:00.646293 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:00.647843 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m22:39:00.649371 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m22:39:00.651453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m22:39:00.651453 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m22:39:00.658964 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m22:39:00.659983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:39:00.825778 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:00.827296 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m22:39:00.829339 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m22:39:00.830362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m22:39:00.836849 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m22:39:00.840866 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m22:39:00.840866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:39:00.996597 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:00.996597 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m22:39:01.000619 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m22:39:01.004331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc1e2d21-25ff-47c4-a216-fe558996e697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD60D44B50>]}
[0m22:39:01.005022 [debug] [MainThread]: On master: COMMIT
[0m22:39:01.007194 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m22:39:01.008203 [info ] [MainThread]: 
[0m22:39:01.016288 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m22:39:01.016288 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m22:39:01.021578 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m22:39:01.021578 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m22:39:01.028533 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m22:39:01.030115 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 22:39:01.021578 => 22:39:01.030115
[0m22:39:01.032136 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m22:39:01.095649 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m22:39:01.105680 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m22:39:01.109445 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      coord_lon,
      coord_lat,
      CAST(main_temp AS DOUBLE) AS main_temp,
      CAST(main_humidity AS DOUBLE) AS main_humidity,
      CAST(wind_speed AS DOUBLE) AS wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    coord_lon,
    coord_lat,
    AVG(main_temp) AS avg_temp,
    AVG(main_humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed
from silver_data
group by coord_lon, coord_lat
    )
[0m22:39:01.109445 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:39:01.411607 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:01.426800 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m22:39:01.426800 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table "clickhouse"."gold"."weathergold" rename to clickhouse.gold.weathergold__dbt_backup
[0m22:39:01.475496 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:01.484698 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m22:39:01.484698 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m22:39:01.533317 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:01.542879 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m22:39:01.542879 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m22:39:01.713369 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:01.729431 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 22:39:01.034078 => 22:39:01.729431
[0m22:39:01.729431 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m22:39:01.735939 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m22:39:01.735939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1e2d21-25ff-47c4-a216-fe558996e697', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD636E6E90>]}
[0m22:39:01.735939 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 0.72s]
[0m22:39:01.735939 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m22:39:01.745457 [debug] [MainThread]: On master: COMMIT
[0m22:39:01.745457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:01.745457 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m22:39:01.745457 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m22:39:01.745457 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m22:39:01.745457 [info ] [MainThread]: 
[0m22:39:01.752970 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m22:39:01.752970 [debug] [MainThread]: Command end result
[0m22:39:01.767597 [info ] [MainThread]: 
[0m22:39:01.771132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:39:01.777328 [info ] [MainThread]: 
[0m22:39:01.779476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:39:01.782642 [debug] [MainThread]: Command `dbt run` succeeded at 22:39:01.782642 after 3.09 seconds
[0m22:39:01.784067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD609CA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD60D44B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD636D7820>]}
[0m22:39:01.784067 [debug] [MainThread]: Flushing usage events
[0m15:57:20.937218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016139DBA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613952A4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613952A230>]}


============================== 15:57:20.951957 | 27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6 ==============================
[0m15:57:20.951957 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:57:20.953455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:57:21.191410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613952A560>]}
[0m15:57:21.207061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613C983490>]}
[0m15:57:21.231795 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m15:57:21.253663 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:57:21.255638 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m15:57:21.255638 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:57:21.256681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613C9DB5B0>]}
[0m15:57:23.040727 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m15:57:23.093911 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m15:57:23.097080 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m15:57:23.216753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613C95ABF0>]}
[0m15:57:23.226969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613C95A650>]}
[0m15:57:23.226969 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:57:23.226969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613BA63430>]}
[0m15:57:23.226969 [info ] [MainThread]: 
[0m15:57:23.226969 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:57:23.226969 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m15:57:23.253884 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:57:23.254252 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m15:57:23.255270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:23.968043 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:57:23.971676 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:57:23.976755 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:57:23.976755 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m15:57:23.976755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:24.160159 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:57:24.162890 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:57:24.169992 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m15:57:24.194485 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m15:57:24.195066 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m15:57:24.196581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:25.669552 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:57:25.672096 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m15:57:25.672096 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m15:57:25.672096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m15:57:25.681908 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m15:57:25.681908 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m15:57:25.686715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:26.139842 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:57:26.144175 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m15:57:26.146431 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m15:57:26.146969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m15:57:26.161701 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m15:57:26.164237 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m15:57:26.164237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:26.610612 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:57:26.615142 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m15:57:26.617371 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m15:57:26.621980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613CB65AE0>]}
[0m15:57:26.621980 [debug] [MainThread]: On master: COMMIT
[0m15:57:26.621980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:26.627021 [info ] [MainThread]: 
[0m15:57:26.649103 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m15:57:26.653220 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m15:57:26.658737 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m15:57:26.660736 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m15:57:26.676918 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m15:57:26.683085 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 15:57:26.661738 => 15:57:26.680996
[0m15:57:26.686552 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m15:57:26.768019 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m15:57:26.772537 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:57:26.774567 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m15:57:26.776562 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:31.583797 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m15:57:31.591708 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:57:31.591708 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m15:57:31.742212 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:57:31.747285 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:57:31.748491 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m15:57:31.931818 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:57:31.942719 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:57:31.943719 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m15:57:32.254008 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:57:32.287892 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 15:57:26.689139 => 15:57:32.287892
[0m15:57:32.287892 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m15:57:32.287892 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m15:57:32.287892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613CC6FC10>]}
[0m15:57:32.294354 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 5.63s]
[0m15:57:32.296885 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m15:57:32.296885 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m15:57:32.296885 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m15:57:32.296885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m15:57:32.303831 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m15:57:32.306891 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m15:57:32.311948 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 15:57:32.303831 => 15:57:32.306891
[0m15:57:32.312463 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m15:57:32.320992 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m15:57:32.332540 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:57:32.334537 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
--   json_extract_scalar(_airbyte_data, '$.main.sea_level') AS sea_level,
--   json_extract_scalar(_airbyte_data, '$.main.grnd_level') AS grnd_level,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
--   json_extract_scalar(_airbyte_data, '$.wind.gust') AS wind_gust,
--   json_extract_scalar(_airbyte_data, '$.rain.1h') AS rain_1h,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
 cast(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE)) at time zone 'Europe/Paris' as timestamp(6) with time zone) AS dt,
 cast(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS DOUBLE)) at time zone 'Europe/Paris' as timestamp(6) with time zone) AS sunrise,
 cast(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.sys.sunset') AS DOUBLE)) at time zone 'Europe/Paris' as timestamp(6) with time zone) AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m15:57:32.338065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:34.355664 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m15:57:34.361862 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:57:34.361862 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m15:57:34.584040 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:57:34.591894 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:57:34.597058 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m15:57:34.809009 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:57:34.811541 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:57:34.816575 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m15:57:35.195785 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:57:35.204778 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 15:57:32.312463 => 15:57:35.203694
[0m15:57:35.206648 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m15:57:35.206648 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m15:57:35.212369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27a8d3ed-d5fc-4c6a-923a-9d0f04409bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613CA77C10>]}
[0m15:57:35.216882 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.92s]
[0m15:57:35.221589 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m15:57:35.227550 [debug] [MainThread]: On master: COMMIT
[0m15:57:35.230573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:35.232444 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m15:57:35.233101 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m15:57:35.234101 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m15:57:35.235100 [info ] [MainThread]: 
[0m15:57:35.237663 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 12.01 seconds (12.01s).
[0m15:57:35.243634 [debug] [MainThread]: Command end result
[0m15:57:35.268593 [info ] [MainThread]: 
[0m15:57:35.274640 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:35.278223 [info ] [MainThread]: 
[0m15:57:35.282489 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:57:35.286781 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:35.285782 after 14.53 seconds
[0m15:57:35.290309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016139DBA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613CA77C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001613CB8B850>]}
[0m15:57:35.293366 [debug] [MainThread]: Flushing usage events
[0m15:58:40.926595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D662A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D5D9A5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D5D9A290>]}


============================== 15:58:40.930545 | 9286b3d7-1baa-4ee7-a88c-ef14f9d3de75 ==============================
[0m15:58:40.930545 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:58:40.931569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:58:41.087466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9286b3d7-1baa-4ee7-a88c-ef14f9d3de75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D5D9A560>]}
[0m15:58:41.106418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9286b3d7-1baa-4ee7-a88c-ef14f9d3de75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D91334F0>]}
[0m15:58:41.120682 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m15:58:41.187121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:41.187121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:41.203674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9286b3d7-1baa-4ee7-a88c-ef14f9d3de75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9355A20>]}
[0m15:58:41.206212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9286b3d7-1baa-4ee7-a88c-ef14f9d3de75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9286080>]}
[0m15:58:41.206212 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:58:41.215115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9286b3d7-1baa-4ee7-a88c-ef14f9d3de75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D92862C0>]}
[0m15:58:41.217633 [info ] [MainThread]: 
[0m15:58:41.219633 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m15:58:41.222635 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m15:58:41.241259 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:58:41.242226 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m15:58:41.243237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:41.401795 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:41.404812 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:58:41.411517 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m15:58:41.411517 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m15:58:41.411517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:41.558779 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:41.561517 [debug] [ThreadPool]: On list_lakehouse: Close
[0m15:58:41.565267 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m15:58:41.579130 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m15:58:41.579130 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m15:58:41.581646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:41.790732 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:41.793043 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m15:58:41.793619 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m15:58:41.795887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m15:58:41.803866 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m15:58:41.806379 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m15:58:41.807498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:42.018896 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:42.021284 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m15:58:42.022498 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m15:58:42.025391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m15:58:42.031276 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m15:58:42.031276 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m15:58:42.036667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:42.317668 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:42.320573 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m15:58:42.321650 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m15:58:42.323773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9286b3d7-1baa-4ee7-a88c-ef14f9d3de75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9383130>]}
[0m15:58:42.326322 [debug] [MainThread]: On master: COMMIT
[0m15:58:42.326322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:42.331350 [info ] [MainThread]: 
[0m15:58:42.348406 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m15:58:42.350403 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m15:58:42.355473 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m15:58:42.358577 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m15:58:42.370313 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m15:58:42.376407 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 15:58:42.360568 => 15:58:42.374556
[0m15:58:42.378943 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m15:58:42.466459 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m15:58:42.471975 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:58:42.473487 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m15:58:42.473487 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:58:43.923689 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m15:58:43.942577 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:58:43.947152 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m15:58:44.228224 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:44.235193 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:58:44.237538 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m15:58:44.440409 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:44.454040 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m15:58:44.454040 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m15:58:44.781613 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:44.821728 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 15:58:42.380515 => 15:58:44.821728
[0m15:58:44.821728 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m15:58:44.821728 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m15:58:44.826240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9286b3d7-1baa-4ee7-a88c-ef14f9d3de75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9461FC0>]}
[0m15:58:44.826240 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.47s]
[0m15:58:44.831777 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m15:58:44.837523 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m15:58:44.839522 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m15:58:44.846632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m15:58:44.849179 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m15:58:44.863343 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m15:58:44.871561 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 15:58:44.852271 => 15:58:44.870037
[0m15:58:44.875589 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m15:58:44.885181 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m15:58:44.901506 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:58:44.903038 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
--   json_extract_scalar(_airbyte_data, '$.main.sea_level') AS sea_level,
--   json_extract_scalar(_airbyte_data, '$.main.grnd_level') AS grnd_level,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
--   json_extract_scalar(_airbyte_data, '$.wind.gust') AS wind_gust,
--   json_extract_scalar(_airbyte_data, '$.rain.1h') AS rain_1h,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
 cast(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE)) at time zone 'Europe/Paris' as timestamp(6) with time zone) AS dt,
 cast(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS DOUBLE)) at time zone 'Europe/Paris' as timestamp(6) with time zone) AS sunrise,
 cast(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.sys.sunset') AS DOUBLE)) at time zone 'Europe/Paris' as timestamp(6) with time zone) AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m15:58:44.906553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:46.423489 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m15:58:46.431391 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:58:46.437180 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m15:58:46.664264 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:46.672370 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:58:46.673573 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m15:58:46.868780 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:46.875809 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m15:58:46.876944 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m15:58:47.184640 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m15:58:47.193731 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 15:58:44.876579 => 15:58:47.192584
[0m15:58:47.194300 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m15:58:47.194300 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m15:58:47.196420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9286b3d7-1baa-4ee7-a88c-ef14f9d3de75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9462C20>]}
[0m15:58:47.201430 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.35s]
[0m15:58:47.206376 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m15:58:47.210883 [debug] [MainThread]: On master: COMMIT
[0m15:58:47.213410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:47.215409 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m15:58:47.217778 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m15:58:47.219298 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m15:58:47.222318 [info ] [MainThread]: 
[0m15:58:47.228470 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m15:58:47.232995 [debug] [MainThread]: Command end result
[0m15:58:47.262722 [info ] [MainThread]: 
[0m15:58:47.264721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:47.268266 [info ] [MainThread]: 
[0m15:58:47.274318 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:58:47.279373 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:47.278379 after 6.37 seconds
[0m15:58:47.280903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D662A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D91334F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D9489330>]}
[0m15:58:47.282140 [debug] [MainThread]: Flushing usage events
[0m16:44:23.803999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162EA2AA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162E9A1A560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162E9A1A230>]}


============================== 16:44:23.810544 | 85cb9312-9d2f-42d6-9533-ca5c4f99741f ==============================
[0m16:44:23.810544 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:44:23.811540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:44:24.029846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85cb9312-9d2f-42d6-9533-ca5c4f99741f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162E9A1A500>]}
[0m16:44:24.044378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85cb9312-9d2f-42d6-9533-ca5c4f99741f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162ECDD3490>]}
[0m16:44:24.074463 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m16:44:25.249247 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m16:44:25.250244 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\silver\weathersil.sql
[0m16:44:25.280337 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m16:44:25.300044 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m16:44:25.316639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85cb9312-9d2f-42d6-9533-ca5c4f99741f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162ED03C0D0>]}
[0m16:44:25.329164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85cb9312-9d2f-42d6-9533-ca5c4f99741f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162ED0080A0>]}
[0m16:44:25.330175 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:44:25.331178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85cb9312-9d2f-42d6-9533-ca5c4f99741f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162ED00AD70>]}
[0m16:44:25.335761 [info ] [MainThread]: 
[0m16:44:25.339713 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:44:25.343727 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:44:25.371812 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:44:25.373812 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:44:25.374814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:27.156753 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m16:44:27.159517 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:44:27.167046 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:44:27.167770 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:44:27.167770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:27.448962 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:44:27.451948 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:44:27.455843 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m16:44:27.476212 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m16:44:27.476212 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m16:44:27.480827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:28.664757 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:28.667551 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m16:44:28.668058 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m16:44:28.671248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_silver)
[0m16:44:28.679863 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m16:44:28.680867 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m16:44:28.680867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:29.277463 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m16:44:29.282076 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m16:44:29.284687 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m16:44:29.290922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m16:44:29.306112 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m16:44:29.306112 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m16:44:29.311818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:29.730356 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:44:29.733827 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m16:44:29.735458 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m16:44:29.737928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85cb9312-9d2f-42d6-9533-ca5c4f99741f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162ECFEC490>]}
[0m16:44:29.739608 [debug] [MainThread]: On master: COMMIT
[0m16:44:29.741675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:29.741675 [info ] [MainThread]: 
[0m16:44:29.760436 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m16:44:29.761371 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m16:44:29.767066 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m16:44:29.769471 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m16:44:29.777028 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m16:44:29.782124 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 16:44:29.770493 => 16:44:29.781224
[0m16:44:29.785675 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m16:44:29.870738 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m16:44:29.876074 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:44:29.876074 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m16:44:29.881204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:30.079419 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230616_144429_00012_ihiga
[0m16:44:30.080496 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 18:11: Table 'source.weather.weather' does not exist", query_id=20230616_144429_00012_ihiga)
[0m16:44:30.081948 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 16:44:29.788048 => 16:44:30.081185
[0m16:44:30.082581 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m16:44:30.084493 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m16:44:30.261173 [debug] [Thread-1 (]: Database Error in model weatheronepoint (models\bronze\weatheronepoint.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 18:11: Table 'source.weather.weather' does not exist", query_id=20230616_144429_00012_ihiga)
  compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m16:44:30.261173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85cb9312-9d2f-42d6-9533-ca5c4f99741f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162ED0A7190>]}
[0m16:44:30.261173 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model bronze.weatheronepoint ................... [[31mERROR[0m in 0.50s]
[0m16:44:30.265884 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m16:44:30.265884 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m16:44:30.265884 [info ] [Thread-1 (]: 2 of 2 SKIP relation silver.weathersil ......................................... [[33mSKIP[0m]
[0m16:44:30.265884 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m16:44:30.273796 [debug] [MainThread]: On master: COMMIT
[0m16:44:30.275812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:30.275812 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m16:44:30.275812 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m16:44:30.280904 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m16:44:30.281416 [info ] [MainThread]: 
[0m16:44:30.283783 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m16:44:30.285873 [debug] [MainThread]: Command end result
[0m16:44:30.298990 [info ] [MainThread]: 
[0m16:44:30.301993 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:44:30.305087 [info ] [MainThread]: 
[0m16:44:30.307303 [error] [MainThread]: [33mDatabase Error in model weatheronepoint (models\bronze\weatheronepoint.sql)[0m
[0m16:44:30.309305 [error] [MainThread]:   TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 18:11: Table 'source.weather.weather' does not exist", query_id=20230616_144429_00012_ihiga)
[0m16:44:30.311838 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m16:44:30.314842 [info ] [MainThread]: 
[0m16:44:30.320107 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:44:30.323604 [debug] [MainThread]: Command `dbt run` failed at 16:44:30.323604 after 6.71 seconds
[0m16:44:30.325621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162EA2AA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162ED0D04C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162ED0D3BB0>]}
[0m16:44:30.327724 [debug] [MainThread]: Flushing usage events
[0m16:50:35.184448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68528A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6849FA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6849FA200>]}


============================== 16:50:35.189557 | 64c1ac89-7f65-437f-84a1-2363a2f522f4 ==============================
[0m16:50:35.189557 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:50:35.189557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:50:35.354798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64c1ac89-7f65-437f-84a1-2363a2f522f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6849FA4D0>]}
[0m16:50:35.367073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64c1ac89-7f65-437f-84a1-2363a2f522f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C687E67490>]}
[0m16:50:35.383632 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m16:50:35.454663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:35.454663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:35.454663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64c1ac89-7f65-437f-84a1-2363a2f522f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68807FF10>]}
[0m16:50:35.467060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64c1ac89-7f65-437f-84a1-2363a2f522f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68803CE80>]}
[0m16:50:35.467060 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:50:35.467060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64c1ac89-7f65-437f-84a1-2363a2f522f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68803D0C0>]}
[0m16:50:35.467060 [info ] [MainThread]: 
[0m16:50:35.474574 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:50:35.477883 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m16:50:35.499509 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:50:35.500509 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:50:35.501510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:35.638205 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:50:35.639969 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:50:35.644314 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m16:50:35.644314 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m16:50:35.644314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:35.766710 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:50:35.767351 [debug] [ThreadPool]: On list_lakehouse: Close
[0m16:50:35.767351 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m16:50:35.786470 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m16:50:35.786470 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m16:50:35.786470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:36.068122 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:50:36.070358 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m16:50:36.071494 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m16:50:36.074662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_gold)
[0m16:50:36.083331 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m16:50:36.084359 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m16:50:36.084359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:36.363985 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:50:36.366303 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m16:50:36.367432 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m16:50:36.369495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m16:50:36.379377 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m16:50:36.379377 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m16:50:36.379377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:36.723632 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:50:36.726065 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m16:50:36.727265 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m16:50:36.729715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64c1ac89-7f65-437f-84a1-2363a2f522f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6880E44F0>]}
[0m16:50:36.730228 [debug] [MainThread]: On master: COMMIT
[0m16:50:36.732771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:36.735590 [info ] [MainThread]: 
[0m16:50:36.751960 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m16:50:36.752947 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m16:50:36.757480 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m16:50:36.759484 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m16:50:36.769571 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m16:50:36.772126 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 16:50:36.761030 => 16:50:36.771126
[0m16:50:36.773124 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m16:50:36.854782 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m16:50:36.867490 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m16:50:36.868522 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m16:50:36.869847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:50:38.070580 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230616_145036_00020_ihiga
[0m16:50:38.075248 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_BAD_DATA, message="Malformed ORC file. File has no columns [s3a://source/weather/weather/2023_06_16_1686927002629_0.csv]", query_id=20230616_145036_00020_ihiga)
[0m16:50:38.079009 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 16:50:36.774645 => 16:50:38.077480
[0m16:50:38.081124 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m16:50:38.083427 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m16:50:38.101294 [debug] [Thread-1 (]: Database Error in model weatheronepoint (models\bronze\weatheronepoint.sql)
  TrinoExternalError(type=EXTERNAL, name=HIVE_BAD_DATA, message="Malformed ORC file. File has no columns [s3a://source/weather/weather/2023_06_16_1686927002629_0.csv]", query_id=20230616_145036_00020_ihiga)
  compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m16:50:38.101294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64c1ac89-7f65-437f-84a1-2363a2f522f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6880EAE90>]}
[0m16:50:38.105932 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model bronze.weatheronepoint ................... [[31mERROR[0m in 1.34s]
[0m16:50:38.110309 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m16:50:38.115431 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m16:50:38.119669 [info ] [Thread-1 (]: 2 of 2 SKIP relation silver.weathersil ......................................... [[33mSKIP[0m]
[0m16:50:38.123701 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m16:50:38.129361 [debug] [MainThread]: On master: COMMIT
[0m16:50:38.132958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:38.135533 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m16:50:38.139057 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m16:50:38.140876 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m16:50:38.142358 [info ] [MainThread]: 
[0m16:50:38.146592 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m16:50:38.154276 [debug] [MainThread]: Command end result
[0m16:50:38.190594 [info ] [MainThread]: 
[0m16:50:38.193621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:38.197752 [info ] [MainThread]: 
[0m16:50:38.201687 [error] [MainThread]: [33mDatabase Error in model weatheronepoint (models\bronze\weatheronepoint.sql)[0m
[0m16:50:38.207234 [error] [MainThread]:   TrinoExternalError(type=EXTERNAL, name=HIVE_BAD_DATA, message="Malformed ORC file. File has no columns [s3a://source/weather/weather/2023_06_16_1686927002629_0.csv]", query_id=20230616_145036_00020_ihiga)
[0m16:50:38.213166 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m16:50:38.219904 [info ] [MainThread]: 
[0m16:50:38.224596 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:50:38.233582 [debug] [MainThread]: Command `dbt run` failed at 16:50:38.232330 after 3.07 seconds
[0m16:50:38.236725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68528A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6880E91E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68803D030>]}
[0m16:50:38.239085 [debug] [MainThread]: Flushing usage events
[0m23:17:54.411975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF73CEA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF73456560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF73456230>]}


============================== 23:17:54.427642 | efc1a32d-1724-4a6f-8e47-ca90ef1dff71 ==============================
[0m23:17:54.427642 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:17:54.427642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:17:54.615223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efc1a32d-1724-4a6f-8e47-ca90ef1dff71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF73456500>]}
[0m23:17:54.631509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efc1a32d-1724-4a6f-8e47-ca90ef1dff71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7683F4F0>]}
[0m23:17:54.646603 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m23:17:54.662365 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:17:54.662365 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m23:17:54.662365 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:17:54.677910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efc1a32d-1724-4a6f-8e47-ca90ef1dff71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7689AF20>]}
[0m23:17:56.728582 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m23:17:56.775474 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m23:17:56.791083 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m23:17:56.931999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efc1a32d-1724-4a6f-8e47-ca90ef1dff71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF768980A0>]}
[0m23:17:56.931999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efc1a32d-1724-4a6f-8e47-ca90ef1dff71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF76898040>]}
[0m23:17:56.931999 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:17:56.947685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc1a32d-1724-4a6f-8e47-ca90ef1dff71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF76A4B790>]}
[0m23:17:56.949123 [info ] [MainThread]: 
[0m23:17:56.949123 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:17:56.949123 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:17:56.963646 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:17:56.963646 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:17:56.963646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:58.770206 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m23:17:58.773891 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:17:58.785570 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:17:58.785570 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:17:58.785570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:17:59.004756 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:17:59.009141 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:17:59.014245 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m23:17:59.038093 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m23:17:59.038093 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m23:17:59.038093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:00.984988 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m23:18:00.988577 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m23:18:00.992090 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m23:18:00.992090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_gold)
[0m23:18:01.008706 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m23:18:01.008706 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m23:18:01.008706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:01.356614 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:01.358342 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m23:18:01.361903 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m23:18:01.361903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m23:18:01.379840 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m23:18:01.379840 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m23:18:01.379840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:01.814706 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:01.818566 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m23:18:01.818566 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m23:18:01.824408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc1a32d-1724-4a6f-8e47-ca90ef1dff71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF767F32B0>]}
[0m23:18:01.824408 [debug] [MainThread]: On master: COMMIT
[0m23:18:01.824408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:01.829933 [info ] [MainThread]: 
[0m23:18:01.846004 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m23:18:01.846004 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m23:18:01.853567 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m23:18:01.853567 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m23:18:01.862495 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m23:18:01.873009 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 23:18:01.853567 => 23:18:01.873009
[0m23:18:01.873009 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m23:18:01.972734 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m23:18:01.988382 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:18:01.988382 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:18:01.988382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:18:05.319905 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m23:18:05.338409 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:18:05.338409 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m23:18:05.631438 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:05.641083 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:18:05.641083 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:18:05.693422 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:05.734816 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 23:18:01.873009 => 23:18:05.734816
[0m23:18:05.741830 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m23:18:05.744147 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m23:18:05.744147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efc1a32d-1724-4a6f-8e47-ca90ef1dff71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF767F3D30>]}
[0m23:18:05.751133 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 3.89s]
[0m23:18:05.751133 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m23:18:05.751133 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m23:18:05.751133 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m23:18:05.751133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m23:18:05.761645 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m23:18:05.769416 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m23:18:05.773045 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 23:18:05.761645 => 23:18:05.771947
[0m23:18:05.774100 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m23:18:05.781843 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m23:18:05.797937 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:18:05.797937 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
--   json_extract_scalar(_airbyte_data, '$.main.sea_level') AS sea_level,
--   json_extract_scalar(_airbyte_data, '$.main.grnd_level') AS grnd_level,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
--   json_extract_scalar(_airbyte_data, '$.wind.gust') AS wind_gust,
--   json_extract_scalar(_airbyte_data, '$.rain.1h') AS rain_1h,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
  format('%sT%sZ', date(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))), from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))) AS dt,
  json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS sunrise,
  json_extract_scalar(_airbyte_data, '$.sys.sunset') AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:18:05.797937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:07.838780 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m23:18:07.846913 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:18:07.846913 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m23:18:08.078182 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:08.087342 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:18:08.087871 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m23:18:08.134359 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:08.140410 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 23:18:05.775450 => 23:18:08.139708
[0m23:18:08.142788 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m23:18:08.143299 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m23:18:08.147344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efc1a32d-1724-4a6f-8e47-ca90ef1dff71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF76B90130>]}
[0m23:18:08.147344 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.40s]
[0m23:18:08.147344 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m23:18:08.147344 [debug] [MainThread]: On master: COMMIT
[0m23:18:08.156875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:08.156875 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m23:18:08.156875 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m23:18:08.162387 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m23:18:08.162387 [info ] [MainThread]: 
[0m23:18:08.162387 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 11.21 seconds (11.21s).
[0m23:18:08.162387 [debug] [MainThread]: Command end result
[0m23:18:08.185510 [info ] [MainThread]: 
[0m23:18:08.185510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:08.185510 [info ] [MainThread]: 
[0m23:18:08.185510 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:18:08.194023 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:08.194023 after 13.96 seconds
[0m23:18:08.194023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF73CEA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF76A4A4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF76BEC610>]}
[0m23:18:08.194023 [debug] [MainThread]: Flushing usage events
[0m23:18:26.276239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A3620A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A3597A470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A3597A200>]}


============================== 23:18:26.291961 | da70d628-82af-4ff7-b8d0-538aea62ed36 ==============================
[0m23:18:26.291961 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:18:26.291961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:18:26.401509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da70d628-82af-4ff7-b8d0-538aea62ed36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A3597A530>]}
[0m23:18:26.417135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da70d628-82af-4ff7-b8d0-538aea62ed36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A38D83460>]}
[0m23:18:26.432759 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m23:18:26.495288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:18:26.495288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:18:26.495288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da70d628-82af-4ff7-b8d0-538aea62ed36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A38FA5990>]}
[0m23:18:26.510885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da70d628-82af-4ff7-b8d0-538aea62ed36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A38F75FF0>]}
[0m23:18:26.510885 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:18:26.510885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da70d628-82af-4ff7-b8d0-538aea62ed36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A38F76230>]}
[0m23:18:26.510885 [info ] [MainThread]: 
[0m23:18:26.510885 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:18:26.510885 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:18:26.526510 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:18:26.526510 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:18:26.526510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:26.641897 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:26.641897 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:18:26.641897 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:18:26.641897 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:18:26.641897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:26.756208 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:26.758391 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:18:26.761645 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m23:18:26.773810 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m23:18:26.773810 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m23:18:26.773810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:27.027303 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:27.028867 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m23:18:27.028867 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m23:18:27.028867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m23:18:27.034877 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m23:18:27.034877 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m23:18:27.034877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:27.421228 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:27.425654 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m23:18:27.427873 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m23:18:27.432140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_gold)
[0m23:18:27.432140 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m23:18:27.446655 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m23:18:27.446655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:27.972408 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:18:27.975452 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m23:18:27.975985 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m23:18:27.980485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da70d628-82af-4ff7-b8d0-538aea62ed36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A38FD3040>]}
[0m23:18:27.981488 [debug] [MainThread]: On master: COMMIT
[0m23:18:27.983163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:27.984927 [info ] [MainThread]: 
[0m23:18:28.001384 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m23:18:28.001384 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m23:18:28.001384 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m23:18:28.001384 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m23:18:28.019754 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m23:18:28.019754 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 23:18:28.001384 => 23:18:28.019754
[0m23:18:28.019754 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m23:18:28.108725 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m23:18:28.118250 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:18:28.118250 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:18:28.118250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:18:29.376093 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m23:18:29.389160 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:18:29.390159 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:18:29.654136 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:29.655180 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:18:29.663308 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m23:18:29.952991 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:29.967675 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:18:29.967675 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:18:30.576579 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m23:18:30.590958 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 23:18:28.019754 => 23:18:30.590958
[0m23:18:30.590958 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m23:18:30.606603 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m23:18:30.606603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da70d628-82af-4ff7-b8d0-538aea62ed36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A390753C0>]}
[0m23:18:30.606603 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.61s]
[0m23:18:30.606603 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m23:18:30.606603 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m23:18:30.606603 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m23:18:30.606603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m23:18:30.606603 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m23:18:30.626210 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m23:18:30.626210 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 23:18:30.606603 => 23:18:30.626210
[0m23:18:30.626210 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m23:18:30.638222 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m23:18:30.646235 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:18:30.646235 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
--   json_extract_scalar(_airbyte_data, '$.main.sea_level') AS sea_level,
--   json_extract_scalar(_airbyte_data, '$.main.grnd_level') AS grnd_level,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
--   json_extract_scalar(_airbyte_data, '$.wind.gust') AS wind_gust,
--   json_extract_scalar(_airbyte_data, '$.rain.1h') AS rain_1h,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
  format('%sT%sZ', date(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))), from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))) AS dt,
  json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS sunrise,
  json_extract_scalar(_airbyte_data, '$.sys.sunset') AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:18:30.646235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:32.126272 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m23:18:32.136598 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:18:32.140626 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m23:18:32.413840 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:32.423737 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:18:32.423737 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m23:18:32.681650 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:32.692773 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:18:32.695811 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m23:18:33.125166 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:18:33.132893 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 23:18:30.626210 => 23:18:33.131824
[0m23:18:33.135228 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m23:18:33.135228 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m23:18:33.139331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da70d628-82af-4ff7-b8d0-538aea62ed36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A39076200>]}
[0m23:18:33.139331 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.53s]
[0m23:18:33.145843 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m23:18:33.150364 [debug] [MainThread]: On master: COMMIT
[0m23:18:33.150364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:33.150364 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m23:18:33.150364 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m23:18:33.150364 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m23:18:33.150364 [info ] [MainThread]: 
[0m23:18:33.161881 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.64 seconds (6.64s).
[0m23:18:33.161881 [debug] [MainThread]: Command end result
[0m23:18:33.177917 [info ] [MainThread]: 
[0m23:18:33.193560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:33.193560 [info ] [MainThread]: 
[0m23:18:33.193560 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:18:33.193560 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:33.193560 after 6.93 seconds
[0m23:18:33.193560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A3620A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A38D83460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010A390D66E0>]}
[0m23:18:33.209184 [debug] [MainThread]: Flushing usage events
[0m23:24:07.959312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B110A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B086A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B086A1D0>]}


============================== 23:24:07.959312 | 35f8c3f1-0709-4d39-9b47-44e926cbf2c7 ==============================
[0m23:24:07.959312 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:24:07.959312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:24:08.084580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35f8c3f1-0709-4d39-9b47-44e926cbf2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B086A4A0>]}
[0m23:24:08.100236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35f8c3f1-0709-4d39-9b47-44e926cbf2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B3C97430>]}
[0m23:24:08.116518 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m23:24:08.602466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:24:08.602466 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://macros\generate_schema_name.sql
[0m23:24:08.618096 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m23:24:09.087779 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m23:24:09.103361 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m23:24:09.103361 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m23:24:09.166259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35f8c3f1-0709-4d39-9b47-44e926cbf2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B3DE6BC0>]}
[0m23:24:09.181761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35f8c3f1-0709-4d39-9b47-44e926cbf2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B3F40040>]}
[0m23:24:09.181761 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:24:09.186523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35f8c3f1-0709-4d39-9b47-44e926cbf2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B3F40FD0>]}
[0m23:24:09.187727 [info ] [MainThread]: 
[0m23:24:09.187727 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:24:09.189824 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:24:09.197547 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:24:09.197547 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:24:09.197547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:09.312155 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:24:09.313347 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:24:09.316074 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m23:24:09.323117 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m23:24:09.323117 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m23:24:09.323117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:09.480515 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:24:09.481730 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m23:24:09.482963 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m23:24:09.485174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35f8c3f1-0709-4d39-9b47-44e926cbf2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B3E7C310>]}
[0m23:24:09.485704 [debug] [MainThread]: On master: COMMIT
[0m23:24:09.486822 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:24:09.487901 [info ] [MainThread]: 
[0m23:24:09.494101 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m23:24:09.494101 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m23:24:09.494101 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m23:24:09.497613 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m23:24:09.501885 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m23:24:09.501885 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 23:24:09.497613 => 23:24:09.501885
[0m23:24:09.501885 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m23:24:09.546898 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m23:24:09.546898 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:24:09.546898 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:24:09.546898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:24:10.364999 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m23:24:10.382406 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:24:10.388047 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:24:10.500139 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230618_212410_00033_7fwhm
[0m23:24:10.500139 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weatheronepoint", query_id=20230618_212410_00033_7fwhm)
[0m23:24:10.504196 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 23:24:09.507024 => 23:24:10.504196
[0m23:24:10.505707 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m23:24:10.508257 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m23:24:10.736709 [debug] [Thread-1 (]: Database Error in model weatheronepoint (models\bronze\weatheronepoint.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weatheronepoint", query_id=20230618_212410_00033_7fwhm)
  compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m23:24:10.736709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35f8c3f1-0709-4d39-9b47-44e926cbf2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B3DE6290>]}
[0m23:24:10.736709 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model bronze.weatheronepoint ................... [[31mERROR[0m in 1.24s]
[0m23:24:10.736709 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m23:24:10.736709 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m23:24:10.748349 [info ] [Thread-1 (]: 2 of 2 SKIP relation bronze.weathersil ......................................... [[33mSKIP[0m]
[0m23:24:10.748349 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m23:24:10.753560 [debug] [MainThread]: On master: COMMIT
[0m23:24:10.754975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:10.754975 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m23:24:10.758825 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m23:24:10.760323 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m23:24:10.761674 [info ] [MainThread]: 
[0m23:24:10.763317 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m23:24:10.765645 [debug] [MainThread]: Command end result
[0m23:24:10.769962 [info ] [MainThread]: 
[0m23:24:10.783973 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:24:10.786587 [info ] [MainThread]: 
[0m23:24:10.788577 [error] [MainThread]: [33mDatabase Error in model weatheronepoint (models\bronze\weatheronepoint.sql)[0m
[0m23:24:10.788577 [error] [MainThread]:   TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weatheronepoint", query_id=20230618_212410_00033_7fwhm)
[0m23:24:10.792038 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m23:24:10.793520 [info ] [MainThread]: 
[0m23:24:10.797491 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:24:10.799018 [debug] [MainThread]: Command `dbt run` failed at 23:24:10.799018 after 2.93 seconds
[0m23:24:10.800029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B110A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B3EBB610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214B3FE7400>]}
[0m23:24:10.801752 [debug] [MainThread]: Flushing usage events
[0m23:24:52.565139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDEBAA8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDE3064D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDE3061A0>]}


============================== 23:24:52.565139 | 0fb69920-d2d7-4f32-bc3e-8b1b7316c8f7 ==============================
[0m23:24:52.565139 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:24:52.565139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:24:52.675224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fb69920-d2d7-4f32-bc3e-8b1b7316c8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDE306470>]}
[0m23:24:52.690838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fb69920-d2d7-4f32-bc3e-8b1b7316c8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE16B2E90>]}
[0m23:24:52.706421 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m23:24:52.753389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:24:52.753389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:24:52.765286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fb69920-d2d7-4f32-bc3e-8b1b7316c8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE1905930>]}
[0m23:24:52.769303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fb69920-d2d7-4f32-bc3e-8b1b7316c8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE1835F90>]}
[0m23:24:52.769303 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:24:52.769303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb69920-d2d7-4f32-bc3e-8b1b7316c8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE18361D0>]}
[0m23:24:52.774605 [info ] [MainThread]: 
[0m23:24:52.774605 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:24:52.776210 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:24:52.785680 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:24:52.787465 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:24:52.787465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:52.855290 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:24:52.856343 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:24:52.858963 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m23:24:52.868050 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m23:24:52.868050 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m23:24:52.868050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:52.982921 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:24:52.982921 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m23:24:52.982921 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m23:24:52.988462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb69920-d2d7-4f32-bc3e-8b1b7316c8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE1936E00>]}
[0m23:24:52.989075 [debug] [MainThread]: On master: COMMIT
[0m23:24:52.990589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:24:52.993366 [info ] [MainThread]: 
[0m23:24:52.997345 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m23:24:52.997345 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m23:24:52.997345 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m23:24:53.001994 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m23:24:53.005506 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m23:24:53.007632 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 23:24:53.001994 => 23:24:53.006518
[0m23:24:53.007632 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m23:24:53.024089 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:24:53.024089 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists "lakehouse"."bronze"."weatheronepoint__dbt_tmp"
[0m23:24:53.024089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:24:53.182788 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:24:53.193593 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m23:24:53.194111 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:24:53.196409 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:24:53.623908 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:24:53.629916 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:24:53.630528 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:24:53.667307 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230618_212453_00038_7fwhm
[0m23:24:53.667893 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weatheronepoint", query_id=20230618_212453_00038_7fwhm)
[0m23:24:53.668520 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 23:24:53.008671 => 23:24:53.668520
[0m23:24:53.669031 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m23:24:53.669620 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m23:24:53.673274 [debug] [Thread-1 (]: Database Error in model weatheronepoint (models\bronze\weatheronepoint.sql)
  TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weatheronepoint", query_id=20230618_212453_00038_7fwhm)
  compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m23:24:53.673794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb69920-d2d7-4f32-bc3e-8b1b7316c8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE18345E0>]}
[0m23:24:53.674873 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model bronze.weatheronepoint ................... [[31mERROR[0m in 0.68s]
[0m23:24:53.675398 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m23:24:53.676488 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m23:24:53.677011 [info ] [Thread-1 (]: 2 of 2 SKIP relation bronze.weathersil ......................................... [[33mSKIP[0m]
[0m23:24:53.677542 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m23:24:53.677542 [debug] [MainThread]: On master: COMMIT
[0m23:24:53.680174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:53.680174 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m23:24:53.680174 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m23:24:53.680174 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m23:24:53.680174 [info ] [MainThread]: 
[0m23:24:53.680174 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m23:24:53.682135 [debug] [MainThread]: Command end result
[0m23:24:53.688028 [info ] [MainThread]: 
[0m23:24:53.688785 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:24:53.689562 [info ] [MainThread]: 
[0m23:24:53.690762 [error] [MainThread]: [33mDatabase Error in model weatheronepoint (models\bronze\weatheronepoint.sql)[0m
[0m23:24:53.690762 [error] [MainThread]:   TrinoExternalError(type=EXTERNAL, name=ICEBERG_MISSING_METADATA, message="Metadata not found in metadata location for table bronze.weatheronepoint", query_id=20230618_212453_00038_7fwhm)
[0m23:24:53.690762 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\bronze\weatheronepoint.sql
[0m23:24:53.692195 [info ] [MainThread]: 
[0m23:24:53.692195 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:24:53.694041 [debug] [MainThread]: Command `dbt run` failed at 23:24:53.694041 after 1.14 seconds
[0m23:24:53.694041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDEBAA8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE19EACB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BE1932D40>]}
[0m23:24:53.694041 [debug] [MainThread]: Flushing usage events
[0m23:31:02.285280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59964A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D598DBA560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D598DBA230>]}


============================== 23:31:02.285280 | 2b43ffdb-2fbe-43b4-88ee-3746c7de26d3 ==============================
[0m23:31:02.285280 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:31:02.285280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:31:02.426945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b43ffdb-2fbe-43b4-88ee-3746c7de26d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D598DBA500>]}
[0m23:31:02.442632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b43ffdb-2fbe-43b4-88ee-3746c7de26d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C20B8E0>]}
[0m23:31:02.458148 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m23:31:02.458148 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:31:02.458148 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m23:31:02.458148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b43ffdb-2fbe-43b4-88ee-3746c7de26d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C25B610>]}
[0m23:31:03.210358 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m23:31:03.257227 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m23:31:03.273361 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m23:31:03.367067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b43ffdb-2fbe-43b4-88ee-3746c7de26d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C258250>]}
[0m23:31:03.382689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b43ffdb-2fbe-43b4-88ee-3746c7de26d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C2581F0>]}
[0m23:31:03.382689 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:31:03.382689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b43ffdb-2fbe-43b4-88ee-3746c7de26d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C40ACB0>]}
[0m23:31:03.382689 [info ] [MainThread]: 
[0m23:31:03.382689 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:31:03.382689 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:31:03.413936 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:31:03.413936 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:31:03.413936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:04.745334 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:31:04.747993 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:31:04.750355 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m23:31:04.762404 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m23:31:04.772432 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m23:31:04.772432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:05.895689 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:31:05.897875 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m23:31:05.899022 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m23:31:05.901320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b43ffdb-2fbe-43b4-88ee-3746c7de26d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C34B160>]}
[0m23:31:05.903659 [debug] [MainThread]: On master: COMMIT
[0m23:31:05.905850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:31:05.906946 [info ] [MainThread]: 
[0m23:31:05.914382 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m23:31:05.925030 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m23:31:05.925030 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m23:31:05.925030 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m23:31:05.930570 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m23:31:05.930570 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 23:31:05.925030 => 23:31:05.930570
[0m23:31:05.930570 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m23:31:05.993540 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m23:31:05.993540 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:31:05.993540 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:31:05.993540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:31:07.626515 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m23:31:07.642604 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:31:07.651680 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m23:31:08.050820 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:31:08.063712 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:31:08.070766 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:31:08.128694 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:31:08.181673 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 23:31:05.930570 => 23:31:08.181673
[0m23:31:08.181673 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m23:31:08.181673 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m23:31:08.189824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b43ffdb-2fbe-43b4-88ee-3746c7de26d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C572E00>]}
[0m23:31:08.190959 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.26s]
[0m23:31:08.190959 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m23:31:08.198224 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m23:31:08.200739 [info ] [Thread-1 (]: 2 of 2 START sql table model bronze.weathersil ................................. [RUN]
[0m23:31:08.200739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m23:31:08.206443 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m23:31:08.219220 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m23:31:08.222845 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 23:31:08.206443 => 23:31:08.219944
[0m23:31:08.224139 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m23:31:08.231264 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m23:31:08.260139 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:31:08.260139 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.bronze.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
--   json_extract_scalar(_airbyte_data, '$.main.sea_level') AS sea_level,
--   json_extract_scalar(_airbyte_data, '$.main.grnd_level') AS grnd_level,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
--   json_extract_scalar(_airbyte_data, '$.wind.gust') AS wind_gust,
--   json_extract_scalar(_airbyte_data, '$.rain.1h') AS rain_1h,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
  format('%sT%sZ', date(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))), from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))) AS dt,
  json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS sunrise,
  json_extract_scalar(_airbyte_data, '$.sys.sunset') AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:31:08.260139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:10.038860 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m23:31:10.050419 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:31:10.050419 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.bronze.weathersil__dbt_tmp rename to lakehouse.bronze.weathersil
[0m23:31:10.327579 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:31:10.337625 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:31:10.337625 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.bronze.weathersil__dbt_backup
[0m23:31:10.388101 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:31:10.395240 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 23:31:08.225811 => 23:31:10.394669
[0m23:31:10.396325 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m23:31:10.399428 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m23:31:10.402036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b43ffdb-2fbe-43b4-88ee-3746c7de26d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C55D6F0>]}
[0m23:31:10.402036 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bronze.weathersil ............................ [[32mSUCCESS[0m in 2.20s]
[0m23:31:10.402036 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m23:31:10.410553 [debug] [MainThread]: On master: COMMIT
[0m23:31:10.415070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:10.415070 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m23:31:10.415070 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m23:31:10.415070 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m23:31:10.415070 [info ] [MainThread]: 
[0m23:31:10.415070 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m23:31:10.430717 [debug] [MainThread]: Command end result
[0m23:31:10.452461 [info ] [MainThread]: 
[0m23:31:10.456605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:10.456605 [info ] [MainThread]: 
[0m23:31:10.456605 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:31:10.462135 [debug] [MainThread]: Command `dbt run` succeeded at 23:31:10.462135 after 8.19 seconds
[0m23:31:10.462135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59964A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C3CB850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D59C1ADF90>]}
[0m23:31:10.467063 [debug] [MainThread]: Flushing usage events
[0m23:33:05.674744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E20DD7A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E20D4EA5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E20D4EA290>]}


============================== 23:33:05.690380 | f38d377b-4d68-479e-9e34-31d2434fcb0f ==============================
[0m23:33:05.690380 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:33:05.690380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:33:05.800543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f38d377b-4d68-479e-9e34-31d2434fcb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E20D4EA560>]}
[0m23:33:05.816193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f38d377b-4d68-479e-9e34-31d2434fcb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2109434F0>]}
[0m23:33:05.832404 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m23:33:05.879180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:33:05.879180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:33:05.879180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f38d377b-4d68-479e-9e34-31d2434fcb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E210B65A20>]}
[0m23:33:05.895278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f38d377b-4d68-479e-9e34-31d2434fcb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E210A96080>]}
[0m23:33:05.895278 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:33:05.895278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f38d377b-4d68-479e-9e34-31d2434fcb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E210A962C0>]}
[0m23:33:05.895278 [info ] [MainThread]: 
[0m23:33:05.895278 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:33:05.895278 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:33:05.912007 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:33:05.912007 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:33:05.912007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:06.030288 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:33:06.031892 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:33:06.034048 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m23:33:06.040090 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m23:33:06.040090 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m23:33:06.040090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:06.243110 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:33:06.245254 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m23:33:06.246322 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m23:33:06.248003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f38d377b-4d68-479e-9e34-31d2434fcb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E210B906A0>]}
[0m23:33:06.248003 [debug] [MainThread]: On master: COMMIT
[0m23:33:06.248003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:33:06.248003 [info ] [MainThread]: 
[0m23:33:06.257770 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m23:33:06.260495 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m23:33:06.262150 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m23:33:06.263815 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m23:33:06.268860 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m23:33:06.272833 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 23:33:06.263815 => 23:33:06.268860
[0m23:33:06.273841 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m23:33:06.315154 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m23:33:06.322315 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:33:06.322315 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:33:06.322315 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:33:07.291031 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m23:33:07.296970 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:33:07.297557 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:33:07.443187 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:33:07.445916 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:33:07.446522 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m23:33:07.571042 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:33:07.576873 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:33:07.577487 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:33:07.788382 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:33:07.799234 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 23:33:06.273841 => 23:33:07.799234
[0m23:33:07.799234 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m23:33:07.799234 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m23:33:07.799234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f38d377b-4d68-479e-9e34-31d2434fcb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E210C1FFA0>]}
[0m23:33:07.799234 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 1.54s]
[0m23:33:07.799234 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m23:33:07.799234 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m23:33:07.799234 [info ] [Thread-1 (]: 2 of 2 START sql table model bronze.weathersil ................................. [RUN]
[0m23:33:07.799234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m23:33:07.799234 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m23:33:07.812499 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m23:33:07.812499 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 23:33:07.799234 => 23:33:07.812499
[0m23:33:07.812499 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m23:33:07.812499 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m23:33:07.812499 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:33:07.812499 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.bronze.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
--   json_extract_scalar(_airbyte_data, '$.main.sea_level') AS sea_level,
--   json_extract_scalar(_airbyte_data, '$.main.grnd_level') AS grnd_level,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
--   json_extract_scalar(_airbyte_data, '$.wind.gust') AS wind_gust,
--   json_extract_scalar(_airbyte_data, '$.rain.1h') AS rain_1h,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
  format('%sT%sZ', date(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))), from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))) AS dt,
  json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS sunrise,
  json_extract_scalar(_airbyte_data, '$.sys.sunset') AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:33:07.824256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:08.685756 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m23:33:08.689308 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:33:08.689308 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."bronze"."weathersil" rename to lakehouse.bronze.weathersil__dbt_backup
[0m23:33:08.856587 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:33:08.861501 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:33:08.863108 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.bronze.weathersil__dbt_tmp rename to lakehouse.bronze.weathersil
[0m23:33:09.051200 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:33:09.056296 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:33:09.056805 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.bronze.weathersil__dbt_backup
[0m23:33:09.326399 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:33:09.331026 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 23:33:07.812499 => 23:33:09.330358
[0m23:33:09.332102 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m23:33:09.333224 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m23:33:09.335494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f38d377b-4d68-479e-9e34-31d2434fcb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E210C9B5B0>]}
[0m23:33:09.337110 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bronze.weathersil ............................ [[32mSUCCESS[0m in 1.54s]
[0m23:33:09.337110 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m23:33:09.343866 [debug] [MainThread]: On master: COMMIT
[0m23:33:09.346058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:09.346058 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m23:33:09.346058 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m23:33:09.346058 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m23:33:09.349574 [info ] [MainThread]: 
[0m23:33:09.352077 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m23:33:09.354683 [debug] [MainThread]: Command end result
[0m23:33:09.369543 [info ] [MainThread]: 
[0m23:33:09.369543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:09.369543 [info ] [MainThread]: 
[0m23:33:09.369543 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:33:09.376681 [debug] [MainThread]: Command `dbt run` succeeded at 23:33:09.376681 after 3.71 seconds
[0m23:33:09.376681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E20DD7A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E210C36230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E210C1FFA0>]}
[0m23:33:09.376681 [debug] [MainThread]: Flushing usage events
[0m23:39:45.620050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B523A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B49AA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B49AA290>]}


============================== 23:39:45.620050 | a3924d70-e7b2-49b6-98e7-e033335b2b2d ==============================
[0m23:39:45.620050 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:39:45.620050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:39:45.743891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3924d70-e7b2-49b6-98e7-e033335b2b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B49AA5C0>]}
[0m23:39:45.758948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3924d70-e7b2-49b6-98e7-e033335b2b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B7D93940>]}
[0m23:39:45.775553 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m23:39:45.790669 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:39:45.790669 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m23:39:45.790669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3924d70-e7b2-49b6-98e7-e033335b2b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B7DEB670>]}
[0m23:39:47.183348 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m23:39:47.230207 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m23:39:47.230207 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m23:39:47.362268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3924d70-e7b2-49b6-98e7-e033335b2b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B10E5210>]}
[0m23:39:47.371519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3924d70-e7b2-49b6-98e7-e033335b2b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B7F988B0>]}
[0m23:39:47.373727 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:39:47.373727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3924d70-e7b2-49b6-98e7-e033335b2b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B10E5210>]}
[0m23:39:47.373727 [info ] [MainThread]: 
[0m23:39:47.373727 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:39:47.373727 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:39:47.402903 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:39:47.402903 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:39:47.402903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:48.139573 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:39:48.139573 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:39:48.139573 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m23:39:48.149061 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m23:39:48.149061 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m23:39:48.149061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:48.676563 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:39:48.676563 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m23:39:48.676563 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m23:39:48.676563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3924d70-e7b2-49b6-98e7-e033335b2b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B7D3DB40>]}
[0m23:39:48.676563 [debug] [MainThread]: On master: COMMIT
[0m23:39:48.681269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:39:48.682102 [info ] [MainThread]: 
[0m23:39:48.688817 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m23:39:48.688817 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m23:39:48.691512 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m23:39:48.691512 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m23:39:48.694368 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m23:39:48.694368 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 23:39:48.692603 => 23:39:48.694368
[0m23:39:48.699085 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m23:39:48.739909 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m23:39:48.739909 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:39:48.749919 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:39:48.750824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:39:50.477657 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m23:39:50.487792 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:39:50.487792 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m23:39:50.651179 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:39:50.658336 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:39:50.658336 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:39:50.686984 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:39:50.702176 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 23:39:48.699085 => 23:39:50.702176
[0m23:39:50.702176 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m23:39:50.702176 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m23:39:50.702176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3924d70-e7b2-49b6-98e7-e033335b2b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B8106E60>]}
[0m23:39:50.714391 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.01s]
[0m23:39:50.714391 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m23:39:50.716996 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m23:39:50.716996 [info ] [Thread-1 (]: 2 of 2 START sql table model bronze.weathersil ................................. [RUN]
[0m23:39:50.716996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m23:39:50.720005 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m23:39:50.721351 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m23:39:50.721351 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 23:39:50.720717 => 23:39:50.721351
[0m23:39:50.727032 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m23:39:50.732057 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m23:39:50.738535 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:39:50.738535 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.bronze.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
--   json_extract_scalar(_airbyte_data, '$.main.sea_level') AS sea_level,
--   json_extract_scalar(_airbyte_data, '$.main.grnd_level') AS grnd_level,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
--   json_extract_scalar(_airbyte_data, '$.wind.gust') AS wind_gust,
--   json_extract_scalar(_airbyte_data, '$.rain.1h') AS rain_1h,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
  format('%sT%sZ', date(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))), from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))) AS dt,
  json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS sunrise,
  json_extract_scalar(_airbyte_data, '$.sys.sunset') AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:39:50.742082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:52.248014 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m23:39:52.259664 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:39:52.266107 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.bronze.weathersil__dbt_tmp rename to lakehouse.bronze.weathersil
[0m23:39:52.508459 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:39:52.511479 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:39:52.511479 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.bronze.weathersil__dbt_backup
[0m23:39:52.559387 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:39:52.566408 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 23:39:50.728047 => 23:39:52.566408
[0m23:39:52.566408 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m23:39:52.566408 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m23:39:52.574109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3924d70-e7b2-49b6-98e7-e033335b2b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B80E56C0>]}
[0m23:39:52.576221 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bronze.weathersil ............................ [[32mSUCCESS[0m in 1.86s]
[0m23:39:52.580160 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m23:39:52.583870 [debug] [MainThread]: On master: COMMIT
[0m23:39:52.586179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:52.586179 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m23:39:52.586179 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m23:39:52.586179 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m23:39:52.591202 [info ] [MainThread]: 
[0m23:39:52.594113 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m23:39:52.595730 [debug] [MainThread]: Command end result
[0m23:39:52.607051 [info ] [MainThread]: 
[0m23:39:52.607051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:52.607051 [info ] [MainThread]: 
[0m23:39:52.621588 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:39:52.624242 [debug] [MainThread]: Command `dbt run` succeeded at 23:39:52.624242 after 7.11 seconds
[0m23:39:52.625503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B523A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B10E4E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B7DAB8E0>]}
[0m23:39:52.625503 [debug] [MainThread]: Flushing usage events
[0m23:40:21.439396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF2B6A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF22DA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF22DA260>]}


============================== 23:40:21.439396 | 6c4ba56c-73d4-421f-a604-1494e105212a ==============================
[0m23:40:21.439396 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:40:21.439396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:40:21.572012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c4ba56c-73d4-421f-a604-1494e105212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF22DA590>]}
[0m23:40:21.582070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c4ba56c-73d4-421f-a604-1494e105212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF56EAF20>]}
[0m23:40:21.582070 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m23:40:21.633043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:40:21.633043 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://macros\generate_schema_name.sql
[0m23:40:21.645051 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m23:40:22.149914 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m23:40:22.168103 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m23:40:22.176122 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m23:40:22.244456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c4ba56c-73d4-421f-a604-1494e105212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF59F9F60>]}
[0m23:40:22.250142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c4ba56c-73d4-421f-a604-1494e105212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF5A37C70>]}
[0m23:40:22.250142 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:40:22.250142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4ba56c-73d4-421f-a604-1494e105212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF5A354B0>]}
[0m23:40:22.255904 [info ] [MainThread]: 
[0m23:40:22.255904 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:40:22.255904 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m23:40:22.268703 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:40:22.268703 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:40:22.268703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:22.373028 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:22.373028 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:40:22.377543 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m23:40:22.377543 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m23:40:22.377543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:22.481870 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:22.481870 [debug] [ThreadPool]: On list_lakehouse: Close
[0m23:40:22.487513 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m23:40:22.497564 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m23:40:22.497564 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m23:40:22.497564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:22.821618 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:22.821618 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m23:40:22.821618 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m23:40:22.831173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m23:40:22.834814 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m23:40:22.834814 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m23:40:22.834814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:23.189357 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:23.189357 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m23:40:23.194871 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m23:40:23.195542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m23:40:23.204624 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m23:40:23.204624 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m23:40:23.204624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:23.527891 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:23.527891 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m23:40:23.527891 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m23:40:23.527891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4ba56c-73d4-421f-a604-1494e105212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF58E5A80>]}
[0m23:40:23.527891 [debug] [MainThread]: On master: COMMIT
[0m23:40:23.527891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:23.540404 [info ] [MainThread]: 
[0m23:40:23.545097 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m23:40:23.545097 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m23:40:23.559041 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m23:40:23.560061 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m23:40:23.565579 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m23:40:23.565579 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 23:40:23.560061 => 23:40:23.565579
[0m23:40:23.565579 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m23:40:23.678856 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m23:40:23.686910 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:40:23.686910 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:40:23.686910 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:40:24.878471 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m23:40:24.897594 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:40:24.900687 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:40:25.169808 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:25.173879 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:40:25.179959 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m23:40:25.402505 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:25.408027 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m23:40:25.408027 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m23:40:25.884708 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:25.916759 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 23:40:23.565579 => 23:40:25.916759
[0m23:40:25.916759 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m23:40:25.916759 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m23:40:25.927006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4ba56c-73d4-421f-a604-1494e105212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF5876500>]}
[0m23:40:25.927006 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.38s]
[0m23:40:25.927006 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m23:40:25.932524 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m23:40:25.932524 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m23:40:25.932524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m23:40:25.932524 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m23:40:25.943882 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m23:40:25.943882 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 23:40:25.932524 => 23:40:25.943882
[0m23:40:25.948400 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m23:40:25.953404 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m23:40:25.970194 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:40:25.970194 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
--   json_extract_scalar(_airbyte_data, '$.main.sea_level') AS sea_level,
--   json_extract_scalar(_airbyte_data, '$.main.grnd_level') AS grnd_level,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
--   json_extract_scalar(_airbyte_data, '$.wind.gust') AS wind_gust,
--   json_extract_scalar(_airbyte_data, '$.rain.1h') AS rain_1h,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
  format('%sT%sZ', date(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))), from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))) AS dt,
  json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS sunrise,
  json_extract_scalar(_airbyte_data, '$.sys.sunset') AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m23:40:25.970194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:27.488793 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m23:40:27.502679 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:40:27.504844 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m23:40:27.796788 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:27.808986 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m23:40:27.808986 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m23:40:27.855888 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:40:27.871634 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 23:40:25.948400 => 23:40:27.871634
[0m23:40:27.875182 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m23:40:27.875182 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m23:40:27.880884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4ba56c-73d4-421f-a604-1494e105212a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF5778D60>]}
[0m23:40:27.884204 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.95s]
[0m23:40:27.887797 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m23:40:27.891694 [debug] [MainThread]: On master: COMMIT
[0m23:40:27.894563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:27.897607 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m23:40:27.898311 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m23:40:27.898311 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m23:40:27.898311 [info ] [MainThread]: 
[0m23:40:27.905704 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m23:40:27.911453 [debug] [MainThread]: Command end result
[0m23:40:27.929348 [info ] [MainThread]: 
[0m23:40:27.935873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:27.938263 [info ] [MainThread]: 
[0m23:40:27.938263 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:40:27.943519 [debug] [MainThread]: Command `dbt run` succeeded at 23:40:27.942652 after 6.51 seconds
[0m23:40:27.944315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF2B6A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF56CFFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF59AEAA0>]}
[0m23:40:27.944315 [debug] [MainThread]: Flushing usage events
[0m23:51:09.074863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76BF3A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76B6AA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76B6AA260>]}


============================== 23:51:09.074863 | b9283025-6d7b-41a7-8705-3cff714096e2 ==============================
[0m23:51:09.074863 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:51:09.074863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:51:09.199940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9283025-6d7b-41a7-8705-3cff714096e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76B6AA590>]}
[0m23:51:09.215559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9283025-6d7b-41a7-8705-3cff714096e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76EB16F20>]}
[0m23:51:09.231099 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m23:51:09.247375 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:51:09.247375 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m23:51:09.247375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9283025-6d7b-41a7-8705-3cff714096e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76EB6B1C0>]}
[0m23:51:10.639236 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m23:51:10.701725 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m23:51:10.701725 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m23:51:10.811604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9283025-6d7b-41a7-8705-3cff714096e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76EB680D0>]}
[0m23:51:10.842859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9283025-6d7b-41a7-8705-3cff714096e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76EB683A0>]}
[0m23:51:10.842859 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:51:10.842859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9283025-6d7b-41a7-8705-3cff714096e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76ED1B490>]}
[0m23:51:10.858488 [info ] [MainThread]: 
[0m23:51:10.858488 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:51:10.875232 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m23:51:10.889605 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m23:51:10.889605 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m23:51:10.889605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:11.080118 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:51:11.082273 [debug] [ThreadPool]: On list_clickhouse: Close
[0m23:51:11.082273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse, now create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m23:51:11.082273 [debug] [ThreadPool]: Creating schema "database: "clickhouse"
schema: "-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. \n    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. \n    -- Si custom_schema_name est none (c\'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles \n        -- au début et à la fin du nom.\n        gold\n    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
"
[0m23:51:11.093780 [debug] [ThreadPool]: Using trino connection "create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:51:11.093780 [debug] [ThreadPool]: On create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: create schema if not exists clickhouse.-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.
[0m23:51:11.093780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:11.125437 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:51:11.125437 [debug] [ThreadPool]: On create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: COMMIT
[0m23:51:11.129452 [debug] [ThreadPool]: On create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:51:11.130973 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.'
[0m23:51:11.141486 [debug] [ThreadPool]: Using trino connection "list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:51:11.141486 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m23:51:11.141486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:11.157502 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_215111_00028_sbwib
[0m23:51:11.157502 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215111_00028_sbwib)
[0m23:51:11.157502 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m23:51:11.157502 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:51:11.167009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro., now list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m23:51:11.173516 [debug] [ThreadPool]: Using trino connection "list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:51:11.175338 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m23:51:11.175338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:11.189389 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_215111_00029_sbwib
[0m23:51:11.189389 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215111_00029_sbwib)
[0m23:51:11.189389 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m23:51:11.193596 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:51:11.193596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro., now list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m23:51:11.193596 [debug] [ThreadPool]: Using trino connection "list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:51:11.205130 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m23:51:11.205130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:11.205130 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_215111_00030_sbwib
[0m23:51:11.205130 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215111_00030_sbwib)
[0m23:51:11.221282 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m23:51:11.221282 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:51:11.221282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:11.221282 [debug] [MainThread]: Connection 'create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.' was properly closed.
[0m23:51:11.221282 [debug] [MainThread]: Connection 'list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.' was properly closed.
[0m23:51:11.221282 [info ] [MainThread]: 
[0m23:51:11.221282 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m23:51:11.221282 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215111_00028_sbwib)
[0m23:51:11.221282 [debug] [MainThread]: Command `dbt run` failed at 23:51:11.221282 after 2.30 seconds
[0m23:51:11.221282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76BF3A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76ED42F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76EE43400>]}
[0m23:51:11.221282 [debug] [MainThread]: Flushing usage events
[0m23:54:44.924734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B42AFA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B4226A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B4226A2C0>]}


============================== 23:54:44.924734 | c2ca2794-2209-49f9-84d9-b2f760364d8d ==============================
[0m23:54:44.924734 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:54:44.924734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:54:45.034120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2ca2794-2209-49f9-84d9-b2f760364d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B4226A5F0>]}
[0m23:54:45.034120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2ca2794-2209-49f9-84d9-b2f760364d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B45603520>]}
[0m23:54:45.049744 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m23:54:45.096595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:45.096595 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:45.112798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2ca2794-2209-49f9-84d9-b2f760364d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B45825A50>]}
[0m23:54:45.112798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2ca2794-2209-49f9-84d9-b2f760364d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B457560B0>]}
[0m23:54:45.112798 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:54:45.112798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2ca2794-2209-49f9-84d9-b2f760364d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B457562F0>]}
[0m23:54:45.112798 [info ] [MainThread]: 
[0m23:54:45.112798 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:54:45.112798 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m23:54:45.128872 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m23:54:45.128872 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m23:54:45.128872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:45.214568 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:54:45.214568 [debug] [ThreadPool]: On list_clickhouse: Close
[0m23:54:45.216809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse, now create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m23:54:45.216809 [debug] [ThreadPool]: Creating schema "database: "clickhouse"
schema: "-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. \n    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. \n    -- Si custom_schema_name est none (c\'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles \n        -- au début et à la fin du nom.\n        gold\n    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
"
[0m23:54:45.216809 [debug] [ThreadPool]: Using trino connection "create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:54:45.216809 [debug] [ThreadPool]: On create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: create schema if not exists clickhouse.-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.
[0m23:54:45.223817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:45.252347 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:54:45.252347 [debug] [ThreadPool]: On create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: COMMIT
[0m23:54:45.252347 [debug] [ThreadPool]: On create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:54:45.256490 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.'
[0m23:54:45.263000 [debug] [ThreadPool]: Using trino connection "list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:54:45.263000 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m23:54:45.263000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:45.287407 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_215445_00034_sbwib
[0m23:54:45.287407 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215445_00034_sbwib)
[0m23:54:45.287407 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m23:54:45.287407 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:54:45.298922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro., now list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m23:54:45.303430 [debug] [ThreadPool]: Using trino connection "list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:54:45.303430 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m23:54:45.303430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:45.306285 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_215445_00035_sbwib
[0m23:54:45.306285 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215445_00035_sbwib)
[0m23:54:45.317329 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m23:54:45.317329 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:54:45.319337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro., now list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m23:54:45.319337 [debug] [ThreadPool]: Using trino connection "list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:54:45.319337 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m23:54:45.319337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:45.336084 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_215445_00036_sbwib
[0m23:54:45.336084 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215445_00036_sbwib)
[0m23:54:45.336084 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m23:54:45.336084 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:54:45.336084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:45.336084 [debug] [MainThread]: Connection 'create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.' was properly closed.
[0m23:54:45.336084 [debug] [MainThread]: Connection 'list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.' was properly closed.
[0m23:54:45.336084 [info ] [MainThread]: 
[0m23:54:45.336084 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m23:54:45.336084 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215445_00034_sbwib)
[0m23:54:45.336084 [debug] [MainThread]: Command `dbt run` failed at 23:54:45.336084 after 0.44 seconds
[0m23:54:45.336084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B42AFA800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B45755FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B45755BD0>]}
[0m23:54:45.336084 [debug] [MainThread]: Flushing usage events
[0m23:55:53.867574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FBEC5A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FBE3CA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FBE3CA2C0>]}


============================== 23:55:53.871258 | 6cb6f3c4-987b-4160-831a-867134f5de6b ==============================
[0m23:55:53.871258 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:55:53.871768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:55:53.972411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cb6f3c4-987b-4160-831a-867134f5de6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FBE3CA5F0>]}
[0m23:55:53.988147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cb6f3c4-987b-4160-831a-867134f5de6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FC17DB520>]}
[0m23:55:54.003663 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m23:55:54.050714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:55:54.050714 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\gold\weathergold.sql
[0m23:55:54.066415 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m23:55:54.082042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cb6f3c4-987b-4160-831a-867134f5de6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FC1A480D0>]}
[0m23:55:54.082042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cb6f3c4-987b-4160-831a-867134f5de6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FC19FF940>]}
[0m23:55:54.082042 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:55:54.082042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb6f3c4-987b-4160-831a-867134f5de6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FC19FFD60>]}
[0m23:55:54.082042 [info ] [MainThread]: 
[0m23:55:54.082042 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:55:54.082042 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m23:55:54.097562 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m23:55:54.097562 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m23:55:54.097562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:54.201681 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:55:54.203696 [debug] [ThreadPool]: On list_clickhouse: Close
[0m23:55:54.203696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse, now create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m23:55:54.207714 [debug] [ThreadPool]: Creating schema "database: "clickhouse"
schema: "-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. \n    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. \n    -- Si custom_schema_name est none (c\'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles \n        -- au début et à la fin du nom.\n        gold\n    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
"
[0m23:55:54.213723 [debug] [ThreadPool]: Using trino connection "create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:55:54.213723 [debug] [ThreadPool]: On create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: create schema if not exists clickhouse.-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.
[0m23:55:54.213723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:54.253140 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:55:54.253140 [debug] [ThreadPool]: On create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: COMMIT
[0m23:55:54.253140 [debug] [ThreadPool]: On create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:55:54.255659 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.'
[0m23:55:54.255659 [debug] [ThreadPool]: Using trino connection "list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:55:54.255659 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m23:55:54.255659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:54.272309 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_215554_00039_sbwib
[0m23:55:54.272309 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215554_00039_sbwib)
[0m23:55:54.272309 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m23:55:54.272309 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:55:54.272309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro., now list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m23:55:54.287320 [debug] [ThreadPool]: Using trino connection "list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:55:54.287320 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m23:55:54.287320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:54.310876 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_215554_00040_sbwib
[0m23:55:54.310876 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215554_00040_sbwib)
[0m23:55:54.310876 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m23:55:54.310876 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:55:54.310876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro., now list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m23:55:54.321467 [debug] [ThreadPool]: Using trino connection "list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m23:55:54.321467 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m23:55:54.321467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:54.335488 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_215554_00041_sbwib
[0m23:55:54.335488 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215554_00041_sbwib)
[0m23:55:54.335488 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m23:55:54.335488 [debug] [ThreadPool]: On list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m23:55:54.335488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:54.335488 [debug] [MainThread]: Connection 'create_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.' was properly closed.
[0m23:55:54.335488 [debug] [MainThread]: Connection 'list_clickhouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.' was properly closed.
[0m23:55:54.335488 [info ] [MainThread]: 
[0m23:55:54.335488 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m23:55:54.335488 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_215554_00039_sbwib)
[0m23:55:54.335488 [debug] [MainThread]: Command `dbt run` failed at 23:55:54.335488 after 0.49 seconds
[0m23:55:54.335488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FBEC5A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FC19EC520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FC19EDE40>]}
[0m23:55:54.335488 [debug] [MainThread]: Flushing usage events
[0m00:02:44.513469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B41BA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B392A560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B392A230>]}


============================== 00:02:44.529088 | 2b6230aa-03af-4126-8602-b73a433d742d ==============================
[0m00:02:44.529088 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:02:44.529088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:02:44.639386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b6230aa-03af-4126-8602-b73a433d742d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B392A500>]}
[0m00:02:44.639386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b6230aa-03af-4126-8602-b73a433d742d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B6CF78E0>]}
[0m00:02:44.656203 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m00:02:44.656203 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:02:44.656203 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m00:02:44.656203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b6230aa-03af-4126-8602-b73a433d742d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B6D69D20>]}
[0m00:02:45.160446 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m00:02:45.191697 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m00:02:45.191697 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m00:02:45.270388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b6230aa-03af-4126-8602-b73a433d742d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B6D680A0>]}
[0m00:02:45.270388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b6230aa-03af-4126-8602-b73a433d742d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B6D68310>]}
[0m00:02:45.270388 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m00:02:45.270388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b6230aa-03af-4126-8602-b73a433d742d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B6F19450>]}
[0m00:02:45.270388 [info ] [MainThread]: 
[0m00:02:45.270388 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:02:45.270388 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:02:45.285963 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:02:45.285963 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m00:02:45.285963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:54.581864 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:02:54.584552 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:02:54.584552 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m00:02:54.584552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:03.306353 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:03:03.306353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:03.306353 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m00:03:03.306353 [info ] [MainThread]: 
[0m00:03:03.306353 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 18.04 seconds (18.04s).
[0m00:03:03.306353 [error] [MainThread]: Encountered an error:
Runtime Error
  HTTPConnectionPool(host='trino', port=8080): Max retries exceeded with url: /v1/statement (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002F4B6D06B00>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed'))
[0m00:03:03.306353 [debug] [MainThread]: Command `dbt run` failed at 00:03:03.306353 after 18.81 seconds
[0m00:03:03.316071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B41BA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B6F33640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4B6F33CA0>]}
[0m00:03:03.317467 [debug] [MainThread]: Flushing usage events
[0m00:03:21.244075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C851DFA830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85156A4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85156A260>]}


============================== 00:03:21.244075 | 4c61fab2-ddd9-4722-b365-920f4f6c292a ==============================
[0m00:03:21.244075 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:03:21.244075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:03:21.369767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c61fab2-ddd9-4722-b365-920f4f6c292a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85156A590>]}
[0m00:03:21.384799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c61fab2-ddd9-4722-b365-920f4f6c292a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C854906F20>]}
[0m00:03:21.384799 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m00:03:21.400442 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:03:21.400442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c61fab2-ddd9-4722-b365-920f4f6c292a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85495B550>]}
[0m00:03:21.903646 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m00:03:21.939406 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m00:03:21.939406 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m00:03:21.998345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c61fab2-ddd9-4722-b365-920f4f6c292a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8549580A0>]}
[0m00:03:22.013963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c61fab2-ddd9-4722-b365-920f4f6c292a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C854958310>]}
[0m00:03:22.013963 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m00:03:22.013963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c61fab2-ddd9-4722-b365-920f4f6c292a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C854B050C0>]}
[0m00:03:22.013963 [info ] [MainThread]: 
[0m00:03:22.013963 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:03:22.013963 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:03:22.030136 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:03:22.030136 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m00:03:22.030136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:22.119660 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:03:22.121309 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:03:22.125030 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:03:22.125559 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m00:03:22.126078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:22.205265 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:03:22.206366 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:03:22.208497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m00:03:22.209540 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. \n    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. \n    -- Si custom_schema_name est none (c\'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles \n        -- au début et à la fin du nom.\n        bronze\n    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
"
[0m00:03:22.212722 [debug] [ThreadPool]: Using trino connection "create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m00:03:22.212722 [debug] [ThreadPool]: On create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: create schema if not exists lakehouse.-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.
[0m00:03:22.212722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:22.237997 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:03:22.239030 [debug] [ThreadPool]: On create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: COMMIT
[0m00:03:22.239551 [debug] [ThreadPool]: On create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m00:03:22.241647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro., now create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m00:03:22.242713 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. \n    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. \n    -- Si custom_schema_name est none (c\'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles \n        -- au début et à la fin du nom.\n        silver\n    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
"
[0m00:03:22.245824 [debug] [ThreadPool]: Using trino connection "create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m00:03:22.246346 [debug] [ThreadPool]: On create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: create schema if not exists lakehouse.-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.
[0m00:03:22.246860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:22.267059 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:03:22.268119 [debug] [ThreadPool]: On create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: COMMIT
[0m00:03:22.268663 [debug] [ThreadPool]: On create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m00:03:22.270788 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.'
[0m00:03:22.278149 [debug] [ThreadPool]: Using trino connection "list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m00:03:22.278149 [debug] [ThreadPool]: On list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m00:03:22.278149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:22.307187 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_220322_00070_sbwib
[0m00:03:22.307715 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_220322_00070_sbwib)
[0m00:03:22.308311 [debug] [ThreadPool]: On list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m00:03:22.308311 [debug] [ThreadPool]: On list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m00:03:22.310034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        gold
    -- On ferme la structure de contrôle if-else.-- On ferme la macro., now list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m00:03:22.317576 [debug] [ThreadPool]: Using trino connection "list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m00:03:22.317576 [debug] [ThreadPool]: On list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m00:03:22.317576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:22.339695 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_220322_00071_sbwib
[0m00:03:22.340205 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_220322_00071_sbwib)
[0m00:03:22.341291 [debug] [ThreadPool]: On list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m00:03:22.341841 [debug] [ThreadPool]: On list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m00:03:22.343967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        bronze
    -- On ferme la structure de contrôle if-else.-- On ferme la macro., now list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.)
[0m00:03:22.351748 [debug] [ThreadPool]: Using trino connection "list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro."
[0m00:03:22.351748 [debug] [ThreadPool]: On list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  '-- on crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- en gros, on se prépare un nom de schéma par défaut.-- on vérifie si un nom de schéma personnalisé a été donné. 
    -- si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- on renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- on ferme la structure de contrôle if-else.-- on ferme la macro.')
[0m00:03:22.351748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:22.366292 [debug] [ThreadPool]: Trino adapter: Trino query id: 20230618_220322_00072_sbwib
[0m00:03:22.366292 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_220322_00072_sbwib)
[0m00:03:22.366292 [debug] [ThreadPool]: On list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: ROLLBACK
[0m00:03:22.366292 [debug] [ThreadPool]: On list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.: Close
[0m00:03:22.371430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:22.371430 [debug] [MainThread]: Connection 'create_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.' was properly closed.
[0m00:03:22.371430 [debug] [MainThread]: Connection 'list_lakehouse_-- On crée une variable locale, default_schema, qui récupère la valeur de target.schema. 
    -- En gros, on se prépare un nom de schéma par défaut.-- On vérifie si un nom de schéma personnalisé a été donné. 
    -- Si custom_schema_name est none (c'est-à-dire non défini), on va utiliser le nom de schéma par défaut.-- On renvoie le nom de schéma personnalisé, mais avant on utilise trim pour enlever les espaces inutiles 
        -- au début et à la fin du nom.
        silver
    -- On ferme la structure de contrôle if-else.-- On ferme la macro.' was properly closed.
[0m00:03:22.371430 [info ] [MainThread]: 
[0m00:03:22.371430 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m00:03:22.371430 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 15:42: mismatched input 'est'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'EXCEPT', 'FETCH', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WINDOW', '[', '||', <EOF>", query_id=20230618_220322_00070_sbwib)
[0m00:03:22.375938 [debug] [MainThread]: Command `dbt run` failed at 00:03:22.375938 after 1.14 seconds
[0m00:03:22.375938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C851DFA830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C854C03EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C854BC6560>]}
[0m00:03:22.375938 [debug] [MainThread]: Flushing usage events
[0m00:07:20.127771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E1EC9A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E1E40A5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E1E40A290>]}


============================== 00:07:20.127771 | 9be253c0-fdde-42f9-ae02-fddea555bdd6 ==============================
[0m00:07:20.127771 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:07:20.143401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:07:20.268854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9be253c0-fdde-42f9-ae02-fddea555bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E1E40A560>]}
[0m00:07:20.268854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9be253c0-fdde-42f9-ae02-fddea555bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E217C3550>]}
[0m00:07:20.284494 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m00:07:21.004398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:21.004398 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://macros\generate_schema_name.sql
[0m00:07:21.020017 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m00:07:21.505371 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m00:07:21.505371 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m00:07:21.520973 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m00:07:21.583474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9be253c0-fdde-42f9-ae02-fddea555bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E21A9DE10>]}
[0m00:07:21.583474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9be253c0-fdde-42f9-ae02-fddea555bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E21ADBCA0>]}
[0m00:07:21.583474 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m00:07:21.583474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9be253c0-fdde-42f9-ae02-fddea555bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E21AD9480>]}
[0m00:07:21.583474 [info ] [MainThread]: 
[0m00:07:21.583474 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:07:21.583474 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m00:07:21.599127 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:07:21.599127 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m00:07:21.599127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:21.685226 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:21.686251 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:07:21.687772 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m00:07:21.687772 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m00:07:21.693292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:21.775074 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:21.776707 [debug] [ThreadPool]: On list_lakehouse: Close
[0m00:07:21.779474 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_gold'
[0m00:07:21.788889 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m00:07:21.788889 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m00:07:21.788889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:21.932831 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:21.934545 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m00:07:21.935622 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m00:07:21.937852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_gold, now list_lakehouse_bronze)
[0m00:07:21.942574 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m00:07:21.942574 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m00:07:21.942574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:22.079798 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:22.081343 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m00:07:22.082390 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m00:07:22.084082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_silver)
[0m00:07:22.087770 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m00:07:22.090287 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m00:07:22.090287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:22.223194 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:22.225327 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m00:07:22.225853 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m00:07:22.227963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9be253c0-fdde-42f9-ae02-fddea555bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E21985CC0>]}
[0m00:07:22.229019 [debug] [MainThread]: On master: COMMIT
[0m00:07:22.230068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:22.231604 [info ] [MainThread]: 
[0m00:07:22.232665 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m00:07:22.241705 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m00:07:22.241705 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m00:07:22.241705 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m00:07:22.241705 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m00:07:22.248725 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 00:07:22.241705 => 00:07:22.248725
[0m00:07:22.248725 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m00:07:22.304942 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m00:07:22.308622 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m00:07:22.308622 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m00:07:22.308622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:07:22.951390 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m00:07:22.962477 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m00:07:22.962477 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m00:07:23.114066 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:23.121572 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m00:07:23.123738 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m00:07:23.261006 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:23.264572 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m00:07:23.278081 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m00:07:23.490143 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:23.530270 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 00:07:22.248725 => 00:07:23.530270
[0m00:07:23.530270 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m00:07:23.530270 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m00:07:23.530270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9be253c0-fdde-42f9-ae02-fddea555bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E21916350>]}
[0m00:07:23.530270 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 1.29s]
[0m00:07:23.545931 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m00:07:23.545931 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m00:07:23.545931 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m00:07:23.545931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m00:07:23.545931 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m00:07:23.561530 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m00:07:23.561530 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 00:07:23.545931 => 00:07:23.561530
[0m00:07:23.561530 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m00:07:23.583820 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m00:07:23.609002 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m00:07:23.611783 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
--   json_extract_scalar(_airbyte_data, '$.main.sea_level') AS sea_level,
--   json_extract_scalar(_airbyte_data, '$.main.grnd_level') AS grnd_level,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg,
--   json_extract_scalar(_airbyte_data, '$.wind.gust') AS wind_gust,
--   json_extract_scalar(_airbyte_data, '$.rain.1h') AS rain_1h,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
  format('%sT%sZ', date(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))), from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE))) AS dt,
  json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS sunrise,
  json_extract_scalar(_airbyte_data, '$.sys.sunset') AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m00:07:23.614450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:24.914359 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m00:07:24.921447 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m00:07:24.921447 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table "lakehouse"."silver"."weathersil" rename to lakehouse.silver.weathersil__dbt_backup
[0m00:07:25.081995 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:25.091521 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m00:07:25.092057 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m00:07:25.230874 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:25.239890 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m00:07:25.240417 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m00:07:25.470329 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:25.474446 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 00:07:23.561530 => 00:07:25.473402
[0m00:07:25.475571 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m00:07:25.478188 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m00:07:25.480855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9be253c0-fdde-42f9-ae02-fddea555bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E21B4D720>]}
[0m00:07:25.480855 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 1.93s]
[0m00:07:25.480855 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m00:07:25.490896 [debug] [MainThread]: On master: COMMIT
[0m00:07:25.490896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:25.490896 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m00:07:25.490896 [debug] [MainThread]: Connection 'list_lakehouse_silver' was properly closed.
[0m00:07:25.490896 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m00:07:25.490896 [info ] [MainThread]: 
[0m00:07:25.506651 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m00:07:25.506651 [debug] [MainThread]: Command end result
[0m00:07:25.537851 [info ] [MainThread]: 
[0m00:07:25.537851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:25.537851 [info ] [MainThread]: 
[0m00:07:25.537851 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:07:25.537851 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:25.537851 after 5.50 seconds
[0m00:07:25.537851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E1EC9A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E2176EB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E1EF03850>]}
[0m00:07:25.553429 [debug] [MainThread]: Flushing usage events
[0m00:07:36.998962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028354D4A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283544B6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283544B6290>]}


============================== 00:07:37.014629 | dad58f4f-80b1-4845-a0dc-e25029bf00b5 ==============================
[0m00:07:37.014629 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:07:37.014629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:07:37.124446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dad58f4f-80b1-4845-a0dc-e25029bf00b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283544B65C0>]}
[0m00:07:37.140713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dad58f4f-80b1-4845-a0dc-e25029bf00b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283578634F0>]}
[0m00:07:37.155772 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m00:07:37.155772 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:07:37.171469 [debug] [MainThread]: previous checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, current checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428
[0m00:07:37.171469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dad58f4f-80b1-4845-a0dc-e25029bf00b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283578BB610>]}
[0m00:07:37.641595 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m00:07:37.687976 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m00:07:37.687976 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m00:07:37.750554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dad58f4f-80b1-4845-a0dc-e25029bf00b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283578B80A0>]}
[0m00:07:37.766043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dad58f4f-80b1-4845-a0dc-e25029bf00b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283578B8040>]}
[0m00:07:37.766043 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m00:07:37.766043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad58f4f-80b1-4845-a0dc-e25029bf00b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028357A6B7F0>]}
[0m00:07:37.766043 [info ] [MainThread]: 
[0m00:07:37.766043 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:07:37.766043 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m00:07:37.781670 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m00:07:37.781670 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m00:07:37.781670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:37.859497 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:37.861030 [debug] [ThreadPool]: On list_clickhouse: Close
[0m00:07:37.861030 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_bronze'
[0m00:07:37.861030 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m00:07:37.861030 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m00:07:37.861030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:38.015947 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:38.017880 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m00:07:38.019049 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m00:07:38.021190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_silver)
[0m00:07:38.028071 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m00:07:38.028071 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m00:07:38.028071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:38.182208 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:38.184322 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m00:07:38.185370 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m00:07:38.186996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_gold)
[0m00:07:38.192286 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m00:07:38.192286 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m00:07:38.192286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:38.378795 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:38.381489 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m00:07:38.382542 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m00:07:38.385292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad58f4f-80b1-4845-a0dc-e25029bf00b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283578B8640>]}
[0m00:07:38.386357 [debug] [MainThread]: On master: COMMIT
[0m00:07:38.387456 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m00:07:38.387456 [info ] [MainThread]: 
[0m00:07:38.398609 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m00:07:38.398609 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m00:07:38.402137 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m00:07:38.402137 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m00:07:38.404973 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m00:07:38.404973 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 00:07:38.402137 => 00:07:38.404973
[0m00:07:38.404973 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m00:07:38.481337 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m00:07:38.493415 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m00:07:38.493415 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      dt,
      main_temp,
      main_humidity,
      wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    dt,
    main_temp,
    main_humidity,
    wind_speed
from silver_data
    )
[0m00:07:38.497900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:07:38.860800 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:38.874156 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m00:07:38.874156 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: alter table clickhouse.gold.weathergold__dbt_tmp rename to clickhouse.gold.weathergold
[0m00:07:38.957811 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:38.969408 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m00:07:38.970528 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: drop table if exists clickhouse.gold.weathergold__dbt_backup
[0m00:07:39.023363 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:07:39.053294 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 00:07:38.404973 => 00:07:39.053294
[0m00:07:39.063854 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m00:07:39.064999 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m00:07:39.067493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad58f4f-80b1-4845-a0dc-e25029bf00b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283578B81F0>]}
[0m00:07:39.067493 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weathergold ............................. [[32mSUCCESS[0m in 0.67s]
[0m00:07:39.071343 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m00:07:39.074204 [debug] [MainThread]: On master: COMMIT
[0m00:07:39.074204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:39.078127 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m00:07:39.078127 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m00:07:39.079640 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m00:07:39.080801 [info ] [MainThread]: 
[0m00:07:39.080801 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m00:07:39.080801 [debug] [MainThread]: Command end result
[0m00:07:39.095316 [info ] [MainThread]: 
[0m00:07:39.095316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:39.095316 [info ] [MainThread]: 
[0m00:07:39.095316 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:07:39.095316 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:39.095316 after 2.11 seconds
[0m00:07:39.095316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028354D4A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028357A3EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028357A27880>]}
[0m00:07:39.095316 [debug] [MainThread]: Flushing usage events
[0m10:29:21.840485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEF3BA830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEEB264A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEEB26170>]}


============================== 10:29:21.864807 | aa163ce3-d039-4c43-8c69-607da8409884 ==============================
[0m10:29:21.864807 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:29:21.864807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:29:21.873910 [info ] [MainThread]: dbt version: 1.5.1
[0m10:29:21.877620 [info ] [MainThread]: python version: 3.10.9
[0m10:29:21.881201 [info ] [MainThread]: python path: C:\Users\eho.mbengue\AppData\Local\anaconda3\python.exe
[0m10:29:21.884453 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m10:29:21.884453 [info ] [MainThread]: Using profiles.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\profiles.yml
[0m10:29:21.890744 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\eho.mbengue\OneDrive - ONEPOINT\Documents\MODERNEDATAPLATFORM\Modern Data platform dev git\trino-iceberg-minio\dbt_project.yml
[0m10:29:21.895767 [info ] [MainThread]: Configuration:
[0m10:29:22.744998 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:29:22.851625 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:29:22.851625 [info ] [MainThread]: Required dependencies:
[0m10:29:22.856946 [debug] [MainThread]: Executing "git --help"
[0m10:29:22.976319 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:29:22.982410 [debug] [MainThread]: STDERR: "b''"
[0m10:29:22.982953 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:29:22.986985 [info ] [MainThread]: Connection:
[0m10:29:22.990338 [info ] [MainThread]:   host: trino
[0m10:29:22.993401 [info ] [MainThread]:   port: 8080
[0m10:29:22.995975 [info ] [MainThread]:   user: Trino
[0m10:29:23.000067 [info ] [MainThread]:   database: lakehouse
[0m10:29:23.000605 [info ] [MainThread]:   schema: bronze
[0m10:29:23.005717 [info ] [MainThread]:   cert: None
[0m10:29:23.009004 [info ] [MainThread]:   prepared_statements_enabled: True
[0m10:29:23.015289 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m10:29:23.017876 [debug] [MainThread]: Using trino connection "debug"
[0m10:29:23.018918 [debug] [MainThread]: On debug: select 1 as id
[0m10:29:23.024571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:32.134712 [debug] [MainThread]: On debug: Close
[0m10:29:32.137716 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:29:32.144794 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:29:32.148379 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  HTTPConnectionPool(host='trino', port=8080): Max retries exceeded with url: /v1/statement (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002AAF1F39F30>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:29:32.154365 [debug] [MainThread]: Command `dbt debug` failed at 10:29:32.152811 after 11.04 seconds
[0m10:29:32.157387 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:29:32.159904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAEF3BA830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAF1F39330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AAF1F38F70>]}
[0m10:29:32.164474 [debug] [MainThread]: Flushing usage events
[0m11:53:52.346261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C75FA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C6D6A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C6D6A200>]}


============================== 11:53:52.359801 | 1abf9d5a-3a41-45ed-9acb-7a0f0863d013 ==============================
[0m11:53:52.359801 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:53:52.361800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:53:52.813612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1abf9d5a-3a41-45ed-9acb-7a0f0863d013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C6D6A4D0>]}
[0m11:53:52.854187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1abf9d5a-3a41-45ed-9acb-7a0f0863d013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA12F4C0>]}
[0m11:53:52.896451 [debug] [MainThread]: checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, vars: {}, profile: , target: dev, version: 1.5.1
[0m11:53:52.930743 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:53:52.932716 [debug] [MainThread]: previous checksum: 7c72c19e20044af580a3af263f31a79e51001c9cb775ec446193990a9604b428, current checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478
[0m11:53:52.933706 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:53:52.936245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1abf9d5a-3a41-45ed-9acb-7a0f0863d013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA18B640>]}
[0m11:53:55.765478 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m11:53:55.842200 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m11:53:55.851197 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m11:53:55.993600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1abf9d5a-3a41-45ed-9acb-7a0f0863d013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA105540>]}
[0m11:53:56.006193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1abf9d5a-3a41-45ed-9acb-7a0f0863d013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA106EC0>]}
[0m11:53:56.007721 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:53:56.008729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1abf9d5a-3a41-45ed-9acb-7a0f0863d013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA338A90>]}
[0m11:53:56.011241 [info ] [MainThread]: 
[0m11:53:56.013253 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m11:53:56.015253 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m11:53:56.038512 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:53:56.039509 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:53:56.040483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:56.154502 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:53:56.156870 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:53:56.164473 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m11:53:56.165561 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m11:53:56.167896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:56.271557 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:53:56.274451 [debug] [ThreadPool]: On list_lakehouse: Close
[0m11:53:56.280028 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_silver'
[0m11:53:56.302313 [debug] [ThreadPool]: Using trino connection "list_lakehouse_silver"
[0m11:53:56.304559 [debug] [ThreadPool]: On list_lakehouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m11:53:56.306068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:56.494010 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:53:56.497601 [debug] [ThreadPool]: On list_lakehouse_silver: ROLLBACK
[0m11:53:56.499327 [debug] [ThreadPool]: On list_lakehouse_silver: Close
[0m11:53:56.503480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_silver, now list_lakehouse_bronze)
[0m11:53:56.520517 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m11:53:56.522888 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m11:53:56.524535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:56.765816 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:53:56.770238 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m11:53:56.772328 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m11:53:56.776381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse_bronze, now list_lakehouse_gold)
[0m11:53:56.797361 [debug] [ThreadPool]: Using trino connection "list_lakehouse_gold"
[0m11:53:56.799364 [debug] [ThreadPool]: On list_lakehouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m11:53:56.800371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:57.023014 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:53:57.027791 [debug] [ThreadPool]: On list_lakehouse_gold: ROLLBACK
[0m11:53:57.030088 [debug] [ThreadPool]: On list_lakehouse_gold: Close
[0m11:53:57.036318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1abf9d5a-3a41-45ed-9acb-7a0f0863d013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA2C83A0>]}
[0m11:53:57.038339 [debug] [MainThread]: On master: COMMIT
[0m11:53:57.041873 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:57.044418 [info ] [MainThread]: 
[0m11:53:57.068973 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m11:53:57.072019 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m11:53:57.076147 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m11:53:57.078702 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m11:53:57.097686 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m11:53:57.103275 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 11:53:57.081259 => 11:53:57.101249
[0m11:53:57.106374 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m11:53:57.230020 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:53:57.232564 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists "lakehouse"."bronze"."weatheronepoint__dbt_tmp"
[0m11:53:57.235087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:53:57.678317 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:53:57.728677 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m11:53:57.738649 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:53:57.742186 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
    *
    FROM  source.weather.weather
    WHERE
    json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
    AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:53:58.742286 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m11:53:58.757874 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:53:58.759857 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:53:58.899921 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:53:58.909300 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:53:58.909908 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m11:53:59.047795 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:53:59.056527 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m11:53:59.057629 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m11:53:59.285624 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:53:59.334949 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 11:53:57.108937 => 11:53:59.333950
[0m11:53:59.335953 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m11:53:59.338427 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m11:53:59.341877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1abf9d5a-3a41-45ed-9acb-7a0f0863d013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA23A350>]}
[0m11:53:59.344894 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.27s]
[0m11:53:59.349415 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m11:53:59.353414 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathersil
[0m11:53:59.356415 [info ] [Thread-1 (]: 2 of 2 START sql table model silver.weathersil ................................. [RUN]
[0m11:53:59.360527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.projet_dbt.weatheronepoint, now model.projet_dbt.weathersil)
[0m11:53:59.363535 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathersil
[0m11:53:59.372074 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathersil"
[0m11:53:59.375075 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (compile): 11:53:59.366060 => 11:53:59.374073
[0m11:53:59.376077 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathersil
[0m11:53:59.393215 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathersil"
[0m11:53:59.414654 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:53:59.416167 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: create table lakehouse.silver.weathersil__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with bronze_data  as (

    SELECT
  json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
  json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
  json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
  json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
  CAST(json_extract_scalar(_airbyte_data, '$.main.temp') AS DOUBLE) - 273.15 AS main_temp,
  json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
  json_extract_scalar(_airbyte_data, '$.main.pressure') AS main_pressure,
  json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
  json_extract_scalar(_airbyte_data, '$.clouds.all') AS clouds,
  json_extract_scalar(_airbyte_data, '$.visibility') AS visibility,
  CAST(from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE)) AS TIMESTAMP(6) WITH TIME ZONE) AS dt,
  json_extract_scalar(_airbyte_data, '$.sys.sunrise') AS sunrise,
  json_extract_scalar(_airbyte_data, '$.sys.sunset') AS sunset,
  json_extract_scalar(_airbyte_data, '$.sys.type') AS sys_type,
  json_extract_scalar(_airbyte_data, '$.sys.id') AS sys_id,
  json_extract_scalar(_airbyte_data, '$.sys.country') AS sys_country,
  json_extract_scalar(_airbyte_data, '$.timezone') AS timezone,
  json_extract_scalar(_airbyte_data, '$.id') AS city_id,
  json_extract_scalar(_airbyte_data, '$.name') AS city_name,
  json_extract_scalar(_airbyte_data, '$.cod') AS response_code
   FROM  lakehouse.bronze.weatheronepoint
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from bronze_data 

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m11:53:59.418183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:01.497087 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m11:54:01.506214 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:54:01.507067 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: alter table lakehouse.silver.weathersil__dbt_tmp rename to lakehouse.silver.weathersil
[0m11:54:01.712588 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:54:01.721662 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathersil"
[0m11:54:01.723660 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: drop table if exists lakehouse.silver.weathersil__dbt_backup
[0m11:54:01.763264 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:54:01.771836 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathersil (execute): 11:53:59.378164 => 11:54:01.770634
[0m11:54:01.772907 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: ROLLBACK
[0m11:54:01.774919 [debug] [Thread-1 (]: On model.projet_dbt.weathersil: Close
[0m11:54:01.779443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1abf9d5a-3a41-45ed-9acb-7a0f0863d013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA47C430>]}
[0m11:54:01.783454 [info ] [Thread-1 (]: 2 of 2 OK created sql table model silver.weathersil ............................ [[32mSUCCESS[0m in 2.42s]
[0m11:54:01.790968 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathersil
[0m11:54:01.795971 [debug] [MainThread]: On master: COMMIT
[0m11:54:01.798093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:01.800087 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m11:54:01.802088 [debug] [MainThread]: Connection 'list_lakehouse_gold' was properly closed.
[0m11:54:01.805085 [debug] [MainThread]: Connection 'model.projet_dbt.weathersil' was properly closed.
[0m11:54:01.807285 [info ] [MainThread]: 
[0m11:54:01.809284 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m11:54:01.814805 [debug] [MainThread]: Command end result
[0m11:54:01.841057 [info ] [MainThread]: 
[0m11:54:01.845053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:01.847149 [info ] [MainThread]: 
[0m11:54:01.850154 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:54:01.853152 [debug] [MainThread]: Command `dbt run` succeeded at 11:54:01.853152 after 9.75 seconds
[0m11:54:01.855153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C75FA860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA2C83A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CA2F77C0>]}
[0m11:54:01.858239 [debug] [MainThread]: Flushing usage events
[0m14:34:47.427162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCC24A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCB9B65F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCB9B62C0>]}


============================== 14:34:47.447001 | a86c9426-9876-4dfa-b476-09eec0117987 ==============================
[0m14:34:47.447001 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:34:47.449518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:34:48.225211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a86c9426-9876-4dfa-b476-09eec0117987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCB9B6590>]}
[0m14:34:48.311160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a86c9426-9876-4dfa-b476-09eec0117987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCED17520>]}
[0m14:34:48.398480 [debug] [MainThread]: checksum: 30a2aa5c6561254d27aa1b1fe0dd3959d8f05abacdac4a7da6dd23f525d3e478, vars: {}, profile: , target: gold, version: 1.5.1
[0m14:34:48.448377 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:34:48.452410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a86c9426-9876-4dfa-b476-09eec0117987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCEDAAEC0>]}
[0m14:34:54.857848 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m14:34:55.031137 [debug] [MainThread]: 1699: static parser successfully parsed gold\weathergold.sql
[0m14:34:55.059055 [debug] [MainThread]: 1699: static parser successfully parsed silver\weathersil.sql
[0m14:34:55.528889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a86c9426-9876-4dfa-b476-09eec0117987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCEDA80D0>]}
[0m14:34:55.560074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a86c9426-9876-4dfa-b476-09eec0117987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCEDA83A0>]}
[0m14:34:55.560074 [info ] [MainThread]: Found 3 models, 3 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:34:55.569593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86c9426-9876-4dfa-b476-09eec0117987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCEF5B820>]}
[0m14:34:55.576979 [info ] [MainThread]: 
[0m14:34:55.581512 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m14:34:55.588316 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse'
[0m14:34:55.683015 [debug] [ThreadPool]: Using trino connection "list_clickhouse"
[0m14:34:55.685596 [debug] [ThreadPool]: On list_clickhouse: select distinct schema_name
    from clickhouse.INFORMATION_SCHEMA.schemata
[0m14:34:55.687598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:55.971922 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:34:55.979031 [debug] [ThreadPool]: On list_clickhouse: Close
[0m14:34:55.989808 [debug] [ThreadPool]: Acquiring new trino connection 'list_clickhouse_silver'
[0m14:34:56.038758 [debug] [ThreadPool]: Using trino connection "list_clickhouse_silver"
[0m14:34:56.040964 [debug] [ThreadPool]: On list_clickhouse_silver: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'silver'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'silver')
[0m14:34:56.040964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:56.631474 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:34:56.638327 [debug] [ThreadPool]: On list_clickhouse_silver: ROLLBACK
[0m14:34:56.641390 [debug] [ThreadPool]: On list_clickhouse_silver: Close
[0m14:34:56.650369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_silver, now list_clickhouse_bronze)
[0m14:34:56.678288 [debug] [ThreadPool]: Using trino connection "list_clickhouse_bronze"
[0m14:34:56.681939 [debug] [ThreadPool]: On list_clickhouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m14:34:56.684503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:57.306694 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:34:57.314351 [debug] [ThreadPool]: On list_clickhouse_bronze: ROLLBACK
[0m14:34:57.318172 [debug] [ThreadPool]: On list_clickhouse_bronze: Close
[0m14:34:57.327491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_clickhouse_bronze, now list_clickhouse_gold)
[0m14:34:57.362503 [debug] [ThreadPool]: Using trino connection "list_clickhouse_gold"
[0m14:34:57.365216 [debug] [ThreadPool]: On list_clickhouse_gold: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from clickhouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
          and (mv.catalog_name is null or mv.catalog_name =  'clickhouse')
          and (mv.schema_name is null or mv.schema_name =  'gold')
[0m14:34:57.369816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:57.785611 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:34:57.791548 [debug] [ThreadPool]: On list_clickhouse_gold: ROLLBACK
[0m14:34:57.794643 [debug] [ThreadPool]: On list_clickhouse_gold: Close
[0m14:34:57.800782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86c9426-9876-4dfa-b476-09eec0117987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCEF32DD0>]}
[0m14:34:57.800782 [debug] [MainThread]: On master: COMMIT
[0m14:34:57.807846 [info ] [MainThread]: Concurrency: 1 threads (target='gold')
[0m14:34:57.811963 [info ] [MainThread]: 
[0m14:34:57.843109 [debug] [Thread-1 (]: Began running node model.projet_dbt.weathergold
[0m14:34:57.849727 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weathergold .................................. [RUN]
[0m14:34:57.857690 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weathergold'
[0m14:34:57.861800 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weathergold
[0m14:34:57.879679 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weathergold"
[0m14:34:57.894772 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (compile): 14:34:57.864396 => 14:34:57.893141
[0m14:34:57.901338 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weathergold
[0m14:34:58.153333 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weathergold"
[0m14:34:58.173176 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weathergold"
[0m14:34:58.181329 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: create table clickhouse.gold.weathergold__dbt_tmp
      
    as (
      /*
    Welcome to your gold dbt model!
    Temperature, humidity, and wind speed.
*/



with silver_data as (

    SELECT
      dt,
      main_temp,
      main_humidity,
      wind_speed
    FROM  lakehouse.silver.weathersil

)

select 
    from_unixtime(CAST(json_extract_scalar(_airbyte_data, '$.dt') AS DOUBLE)),
    main_temp,
    main_humidity,
    wind_speed
from silver_data
    )
[0m14:34:58.186857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:58.412597 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20230619_123458_00252_ik89n
[0m14:34:58.412597 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 23:44: Column '_airbyte_data' cannot be resolved", query_id=20230619_123458_00252_ik89n)
[0m14:34:58.412597 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weathergold (execute): 14:34:57.904356 => 14:34:58.412597
[0m14:34:58.424330 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: ROLLBACK
[0m14:34:58.428491 [debug] [Thread-1 (]: On model.projet_dbt.weathergold: Close
[0m14:34:58.886175 [debug] [Thread-1 (]: Database Error in model weathergold (models\gold\weathergold.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 23:44: Column '_airbyte_data' cannot be resolved", query_id=20230619_123458_00252_ik89n)
  compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m14:34:58.889646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a86c9426-9876-4dfa-b476-09eec0117987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCED36B90>]}
[0m14:34:58.896970 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.weathergold ......................... [[31mERROR[0m in 1.03s]
[0m14:34:58.899341 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weathergold
[0m14:34:58.909050 [debug] [MainThread]: On master: COMMIT
[0m14:34:58.914266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:58.914795 [debug] [MainThread]: Connection 'list_clickhouse' was properly closed.
[0m14:34:58.919304 [debug] [MainThread]: Connection 'list_clickhouse_gold' was properly closed.
[0m14:34:58.923082 [debug] [MainThread]: Connection 'model.projet_dbt.weathergold' was properly closed.
[0m14:34:58.925131 [info ] [MainThread]: 
[0m14:34:58.927714 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m14:34:58.935429 [debug] [MainThread]: Command end result
[0m14:34:58.981610 [info ] [MainThread]: 
[0m14:34:58.987151 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:34:58.991602 [info ] [MainThread]: 
[0m14:34:58.995287 [error] [MainThread]: [33mDatabase Error in model weathergold (models\gold\weathergold.sql)[0m
[0m14:34:58.999055 [error] [MainThread]:   TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 23:44: Column '_airbyte_data' cannot be resolved", query_id=20230619_123458_00252_ik89n)
[0m14:34:59.002925 [error] [MainThread]:   compiled Code at target\run\projet_dbt\models\gold\weathergold.sql
[0m14:34:59.005833 [info ] [MainThread]: 
[0m14:34:59.011478 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:34:59.015869 [debug] [MainThread]: Command `dbt run` failed at 14:34:59.015318 after 11.97 seconds
[0m14:34:59.018711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCC24A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCEE51030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCCEE531F0>]}
[0m14:34:59.020193 [debug] [MainThread]: Flushing usage events
