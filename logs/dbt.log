[0m17:31:00.266643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B4E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B76A21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B76A1F30>]}


============================== 17:31:00.273879 | f5fc16fd-027b-4268-8b40-000850bbf8d2 ==============================
[0m17:31:00.273879 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:31:00.274874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:31:00.781216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B76A2170>]}
[0m17:31:00.822419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46D74F0>]}
[0m17:31:00.877512 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:31:00.898678 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:31:00.901219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46C9180>]}
[0m17:31:03.593215 [debug] [MainThread]: 1699: static parser successfully parsed bronze\weatheronepoint.sql
[0m17:31:03.699660 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'weather' in the 'models' section of file 'models\bronze\schema.yml'
[0m17:31:03.783173 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_coord_lon.111d5fc247' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.784683 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_coord_lat.73580ceedf' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.786698 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_weather_main.e550921c88' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.788697 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_weather_description.4881254a38' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.790206 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_main_temp.46cf30c876' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.792220 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_main_humidity.4df0aafc92' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.795746 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_wind_speed.9983f1ae3d' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.797744 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.projet_dbt.not_null_weather_wind_deg.d7b4c06687' (models\bronze\schema.yml) depends on a node named 'weather' in package '' which was not found
[0m17:31:03.905050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7AE9150>]}
[0m17:31:03.923680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46CA590>]}
[0m17:31:03.926681 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:31:03.929679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B469EE00>]}
[0m17:31:03.933206 [info ] [MainThread]: 
[0m17:31:03.936733 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:31:03.942262 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:31:03.998768 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:31:04.001128 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:31:04.003125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:04.186266 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:04.191800 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:31:04.203058 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:31:04.237794 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:31:04.239923 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:31:04.242843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:04.635780 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:04.640824 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:31:04.642824 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:31:04.651100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7BA4160>]}
[0m17:31:04.652633 [debug] [MainThread]: On master: COMMIT
[0m17:31:04.655163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:04.657702 [info ] [MainThread]: 
[0m17:31:04.679581 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:31:04.682544 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:31:04.687086 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:31:04.689606 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:31:04.703317 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:31:04.714564 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:31:04.691627 => 17:31:04.712497
[0m17:31:04.717492 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:31:04.870686 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:31:04.883220 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:04.886774 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:31:04.888768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:06.797466 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m17:31:06.830196 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:06.833210 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:31:07.076760 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:07.087867 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:07.090373 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:31:07.374921 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:07.401661 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:31:07.405033 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:31:07.755933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:07.810481 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:31:04.719494 => 17:31:07.809919
[0m17:31:07.812496 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:31:07.815547 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:31:07.819494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5fc16fd-027b-4268-8b40-000850bbf8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7C60100>]}
[0m17:31:07.824597 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 3.13s]
[0m17:31:07.830384 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:31:07.835438 [debug] [MainThread]: On master: COMMIT
[0m17:31:07.837405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:07.838466 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:31:07.842209 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:31:07.845778 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m17:31:07.847780 [info ] [MainThread]: 
[0m17:31:07.850298 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m17:31:07.859875 [debug] [MainThread]: Command end result
[0m17:31:07.882917 [info ] [MainThread]: 
[0m17:31:07.887007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:07.891563 [info ] [MainThread]: 
[0m17:31:07.895794 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:31:07.900311 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:07.899795 after 7.67 seconds
[0m17:31:07.902332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B4E375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B46D74F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267B7AE9FC0>]}
[0m17:31:07.906020 [debug] [MainThread]: Flushing usage events
[0m17:32:03.553655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D38C75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D6182170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D6181F60>]}


============================== 17:32:03.561417 | 74d28918-0352-4436-a90b-3d8c97b1ab5e ==============================
[0m17:32:03.561417 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:32:03.563431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio', 'log_path': 'C:\\Users\\eho.mbengue\\OneDrive - ONEPOINT\\Documents\\MODERNEDATAPLATFORM\\Modern Data platform dev git\\trino-iceberg-minio\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:32:03.884090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D6182200>]}
[0m17:32:03.914054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D3166BC0>]}
[0m17:32:03.938091 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m17:32:04.073548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:04.075495 [debug] [MainThread]: Partial parsing: updated file: projet_dbt://models\bronze\schema.yml
[0m17:32:04.204660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D66F54B0>]}
[0m17:32:04.219294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D66BB6A0>]}
[0m17:32:04.220845 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 332 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:32:04.222859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D669B820>]}
[0m17:32:04.226856 [info ] [MainThread]: 
[0m17:32:04.230401 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:32:04.233299 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:32:04.260469 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:32:04.261484 [debug] [ThreadPool]: On list_lakehouse: select distinct schema_name
    from lakehouse.INFORMATION_SCHEMA.schemata
[0m17:32:04.262682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:04.366604 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:04.369174 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:32:04.372904 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse_bronze'
[0m17:32:04.389555 [debug] [ThreadPool]: Using trino connection "list_lakehouse_bronze"
[0m17:32:04.390564 [debug] [ThreadPool]: On list_lakehouse_bronze: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materializedview'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from lakehouse.INFORMATION_SCHEMA.tables t
    left join system.metadata.materialized_views mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'bronze'
          and (mv.catalog_name is null or mv.catalog_name =  'lakehouse')
          and (mv.schema_name is null or mv.schema_name =  'bronze')
[0m17:32:04.392568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:04.627844 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:04.632386 [debug] [ThreadPool]: On list_lakehouse_bronze: ROLLBACK
[0m17:32:04.634416 [debug] [ThreadPool]: On list_lakehouse_bronze: Close
[0m17:32:04.638957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D66B86D0>]}
[0m17:32:04.640518 [debug] [MainThread]: On master: COMMIT
[0m17:32:04.643513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:04.645519 [info ] [MainThread]: 
[0m17:32:04.659225 [debug] [Thread-1 (]: Began running node model.projet_dbt.weatheronepoint
[0m17:32:04.662363 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze.weatheronepoint ............................ [RUN]
[0m17:32:04.666931 [debug] [Thread-1 (]: Acquiring new trino connection 'model.projet_dbt.weatheronepoint'
[0m17:32:04.667925 [debug] [Thread-1 (]: Began compiling node model.projet_dbt.weatheronepoint
[0m17:32:04.680084 [debug] [Thread-1 (]: Writing injected SQL for node "model.projet_dbt.weatheronepoint"
[0m17:32:04.687800 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (compile): 17:32:04.670455 => 17:32:04.685762
[0m17:32:04.690351 [debug] [Thread-1 (]: Began executing node model.projet_dbt.weatheronepoint
[0m17:32:04.837064 [debug] [Thread-1 (]: Writing runtime sql for node "model.projet_dbt.weatheronepoint"
[0m17:32:04.846592 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:04.848588 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: create table lakehouse.bronze.weatheronepoint__dbt_tmp
      
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below 
*/



with source_data as (

    SELECT
--   json_extract_scalar(_airbyte_data, '$.coord.lon') AS coord_lon,
--   json_extract_scalar(_airbyte_data, '$.coord.lat') AS coord_lat,
--   json_extract_scalar(_airbyte_data, '$.weather[0].main') AS weather_main,
--   json_extract_scalar(_airbyte_data, '$.weather[0].description') AS weather_description,
--   json_extract_scalar(_airbyte_data, '$.main.temp') AS main_temp,
--   json_extract_scalar(_airbyte_data, '$.main.humidity') AS main_humidity,
--   json_extract_scalar(_airbyte_data, '$.wind.speed') AS wind_speed,
--   json_extract_scalar(_airbyte_data, '$.wind.deg') AS wind_deg
  *
  FROM  source.weather.weather
  WHERE
  json_extract_scalar(_airbyte_data, '$.coord.lon') IS NOT NULL
  AND json_extract_scalar(_airbyte_data, '$.coord.lat') IS NOT NULL

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
[0m17:32:04.850723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:06.025640 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:32:06.047544 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:06.050059 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table "lakehouse"."bronze"."weatheronepoint" rename to lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:32:06.231037 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.240090 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:06.241099 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: alter table lakehouse.bronze.weatheronepoint__dbt_tmp rename to lakehouse.bronze.weatheronepoint
[0m17:32:06.421004 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.440896 [debug] [Thread-1 (]: Using trino connection "model.projet_dbt.weatheronepoint"
[0m17:32:06.442847 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: drop table if exists lakehouse.bronze.weatheronepoint__dbt_backup
[0m17:32:06.694538 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.755325 [debug] [Thread-1 (]: Timing info for model.projet_dbt.weatheronepoint (execute): 17:32:04.691340 => 17:32:06.754328
[0m17:32:06.757326 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: ROLLBACK
[0m17:32:06.759325 [debug] [Thread-1 (]: On model.projet_dbt.weatheronepoint: Close
[0m17:32:06.763851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d28918-0352-4436-a90b-3d8c97b1ab5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D67C3E20>]}
[0m17:32:06.765854 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze.weatheronepoint ....................... [[32mSUCCESS[0m in 2.10s]
[0m17:32:06.769450 [debug] [Thread-1 (]: Finished running node model.projet_dbt.weatheronepoint
[0m17:32:06.774399 [debug] [MainThread]: On master: COMMIT
[0m17:32:06.776867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:06.777891 [debug] [MainThread]: Connection 'list_lakehouse' was properly closed.
[0m17:32:06.780430 [debug] [MainThread]: Connection 'list_lakehouse_bronze' was properly closed.
[0m17:32:06.781424 [debug] [MainThread]: Connection 'model.projet_dbt.weatheronepoint' was properly closed.
[0m17:32:06.783427 [info ] [MainThread]: 
[0m17:32:06.785433 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m17:32:06.789428 [debug] [MainThread]: Command end result
[0m17:32:06.810900 [info ] [MainThread]: 
[0m17:32:06.812902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:06.817438 [info ] [MainThread]: 
[0m17:32:06.819441 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:32:06.822047 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:06.821529 after 3.48 seconds
[0m17:32:06.824179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D38C75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D3166BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D67C3E20>]}
[0m17:32:06.826175 [debug] [MainThread]: Flushing usage events
